OBJECT Table 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 5:45:37 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=ENU=Primary Key }
    { 9   ;   ;Localization        ;Option        ;OnValidate=BEGIN
                                                                IF Localization = Localization::"North America" THEN
                                                                  "VAT Amount Specification" := "VAT Amount Specification"::"N/A. (Sales Tax)";
                                                              END;

                                                   CaptionML=ENU=Localization;
                                                   OptionString=World Wide,North America,Other }
    { 10  ;   ;VAT Amount Specification;Option    ;CaptionML=ENU=VAT Amount Specification;
                                                   OptionString=Multiple Lines,Always,Never,N/A. (Sales Tax) }
    { 14  ;   ;Use ForNAV Languages;Boolean       ;InitValue=Yes;
                                                   CaptionML=ENU=Use ForNAV Languages }
    { 15  ;   ;Use Preprinted Paper;Boolean       ;CaptionML=ENU=Use Preprinted Paper }
    { 20  ;   ;Logo                ;BLOB          ;CaptionML=ENU=Logo }
    { 21  ;   ;Logo File Name      ;Text250       ;InitValue=Click to import...;
                                                   CaptionML=ENU=Logo File Name;
                                                   Editable=No }
    { 50  ;   ;Document Watermark File Name;Text250;
                                                   InitValue=Click to import...;
                                                   CaptionML=ENU=Document Watermark File Name;
                                                   Editable=No }
    { 51  ;   ;List Report Watermark File N.;Text250;
                                                   InitValue=Click to import...;
                                                   CaptionML=ENU=List Report Watermark File Name;
                                                   Editable=No }
    { 60  ;   ;Document Watermark  ;BLOB          ;CaptionML=ENU=Document Watermark }
    { 61  ;   ;List Report Watermark;BLOB         ;CaptionML=ENU=List Report Watermark }
    { 70  ;   ;Payment Note        ;Text250       ;CaptionML=ENU=Payment Note }
    { 80  ;   ;Legal Conditions    ;Text250       ;CaptionML=ENU=Legal Conditions }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE InitSetup@1000000000();
    BEGIN
      IF GET THEN
        EXIT;

      INIT;
      INSERT;
    END;

    PROCEDURE ReplaceReportSelection@1(HideDialog@1000 : Boolean);
    VAR
      DoYouWantToQst@1001 : TextConst 'ENU=Do you want to replace the current reports with the ForNAV reports?';
      ReplaceReportSel@1002 : Codeunit 70029;
    BEGIN
      IF NOT HideDialog THEN
        IF NOT CONFIRM(DoYouWantToQst, TRUE) THEN
          EXIT;

      ReplaceReportSel.RUN;
    END;

    PROCEDURE RunTest@2();
    BEGIN
      CODEUNIT.RUN(CODEUNIT::Codeunit70998);
    END;

    PROCEDURE DesignTemplatePortrait@1000000003();
    VAR
      Template@1000 : Report 70527;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignTemplateLandscape@9();
    VAR
      Template@1000 : Report 70526;
    BEGIN
      Template.RUNMODAL;
    END;

    PROCEDURE DesignSalesTemplate@3();
    VAR
      SalesTemplateVAT@1000 : Report 70529;
      SalesTemplSalesTax@1001 : Report 70519;
    BEGIN
      IF Localization = Localization::"North America" THEN
        SalesTemplSalesTax.RUNMODAL
      ELSE
        SalesTemplateVAT.RUNMODAL;
    END;

    PROCEDURE DesignPurchaseTemplate@1000000001();
    VAR
      PurchaseTemplVAT@1000 : Report 70528;
      PurchaseTemplTax@1001 : Report 70518;
    BEGIN
      IF Localization = Localization::"North America" THEN
        PurchaseTemplTax.RUNMODAL
      ELSE
        PurchaseTemplVAT.RUNMODAL;
    END;

    PROCEDURE ImportWatermarkFromClientFile@21(Which@1000 : Integer) : Boolean;
    VAR
      ForNAVReadWatermarks@1002 : Codeunit 70006;
    BEGIN
      EXIT(ForNAVReadWatermarks.ReadFromFile(Rec, Which));
    END;

    PROCEDURE GetLegalConditions@1000000002(LanguageCode@1000000001 : Code[10]) : Text;
    VAR
      LegalCondTranslation@1000000000 : Record 70001;
    BEGIN
      IF LegalCondTranslation.GET(LanguageCode) THEN
        EXIT(LegalCondTranslation."Legal Conditions");

      EXIT("Legal Conditions");
    END;

    PROCEDURE CheckLocalizationBasedOnTables@5();
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      DetectLocalization.CheckLocalizationBasedOnTables(Rec);
    END;

    PROCEDURE ValidateCurrentLocalization@4() : Boolean;
    VAR
      DetectLocalization@1001 : Codeunit 70005;
    BEGIN
      EXIT(DetectLocalization.ValidateCurrentLocalization(Rec));
    END;

    PROCEDURE DownloadWatermarks@6();
    BEGIN
      HYPERLINK('http://www.fornav.com/report-watermarks/');
    END;

    PROCEDURE CreateWebService@7();
    VAR
      WebService@1000 : Record 2000000076;
    BEGIN
      WebService."Object Type" := WebService."Object Type"::Page;
      WebService."Object ID" := PAGE::Fields;
      WebService."Service Name" := 'FIELDS';
      WebService.VALIDATE("Service Name", 'Fields');
      IF NOT WebService.INSERT THEN
        EXIT;

      WebService.Published := TRUE;
      WebService.MODIFY;
    END;

    PROCEDURE GetCompanyLogo@8();
    VAR
      CompanyInformation@1000 : Record 79;
    BEGIN
      CompanyInformation.GET;
      CompanyInformation.CALCFIELDS(Picture);
      Logo := CompanyInformation.Picture;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=07/14/17;
    Time=10:55:28 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 2   ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=ENU=Language Code }
    { 80  ;   ;Legal Conditions    ;Text250        }
  }
  KEYS
  {
    {    ;Language Code                           ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70219 ForNAV Aged Accounts Args.
{
  OBJECT-PROPERTIES
  {
    Date=11/29/17;
    Time=12:17:59 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Print Amount In Cust. Curr.;Boolean }
    { 2   ;   ;Ending Date         ;Date          ;CaptionML=ENU=Aged As Of }
    { 3   ;   ;Aging By            ;Option        ;CaptionML=ENU=Aging By;
                                                   OptionCaptionML=ENU=Due Date,Posting Date,Document Date;
                                                   OptionString=Due Date,Posting Date,Document Date }
    { 4   ;   ;Period Length       ;DateFormula   ;CaptionML=ENU=Period Length }
    { 5   ;   ;Print Details       ;Boolean        }
    { 6   ;   ;Heading Type        ;Option        ;OptionString=Date Interval,Number of Days }
    { 7   ;   ;New Page Per Customer;Boolean       }
    { 8   ;   ;Show Cust. Contact Info;Boolean     }
    { 9   ;   ;Period Start Date   ;Date           }
    { 10  ;   ;Period End Date     ;Date           }
    { 11  ;   ;Header Text         ;Text30         }
    { 12  ;   ;Currency Code       ;Code10         }
    { 13  ;   ;No. of Columns      ;Integer       ;MinValue=1;
                                                   MaxValue=31 }
  }
  KEYS
  {
    {    ;Print Amount In Cust. Curr.             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      PeriodStartDate@1000000001 : ARRAY [31] OF Date;
      PeriodEndDate@1000000000 : ARRAY [31] OF Date;
      HeaderText@1000000002 : ARRAY [31] OF Text;

    PROCEDURE CalcDates@5();
    VAR
      i@1000 : Integer;
      PeriodLength2@1001 : DateFormula;
      Text010@1000000001 : TextConst 'ENU=The Date Formula %1 cannot be used. Try to restate it. E.g. 1M+CM instead of CM+1M.';
      Text032@1000000000 : TextConst '@@@=Negating the period length: %1 is the period length;ENU=-%1';
    BEGIN
      EVALUATE(PeriodLength2,STRSUBSTNO(Text032, "Period Length"));

      IF "Aging By" = "Aging By"::"Due Date" THEN BEGIN
        PeriodEndDate[1] := DMY2DATE(31,12,9999);
        PeriodStartDate[1] := "Ending Date" + 1;
      END ELSE BEGIN
        PeriodEndDate[1] := "Ending Date";
        PeriodStartDate[1] := CALCDATE(PeriodLength2, "Ending Date" + 1);
      END;

      FOR i := 2 TO "No. of Columns" DO BEGIN
        PeriodEndDate[i] := PeriodStartDate[i - 1] - 1;
        PeriodStartDate[i] := CALCDATE(PeriodLength2,PeriodEndDate[i] + 1);
      END;

      PeriodStartDate[i] := 0D;
      FOR i := 1 TO "No. of Columns" DO
        IF PeriodEndDate[i] < PeriodStartDate[i] THEN
          ERROR(Text010, "Period Length");

      CreateHeadings;
    END;

    PROCEDURE GetPeriodIndex@8(Date@1040000 : Date) : Integer;
    VAR
      i@1000 : Integer;
    BEGIN
      FOR i := 1 TO "No. of Columns" DO
        IF Date IN [PeriodStartDate[i]..PeriodEndDate[i]] THEN
          EXIT(i);
    END;

    PROCEDURE GetCaption@1000000000(i@1000000000 : Integer) : Text;
    BEGIN
      EXIT(HeaderText[i]);
    END;

    LOCAL PROCEDURE CreateHeadings@10();
    VAR
      i@1000 : Integer;
      NotDueTxt@1000000015 : TextConst 'ENU=Not Due';
      BeforeTxt@1000000014 : TextConst 'ENU=Before';
      DaysTxt@1000000013 : TextConst 'ENU=days';
      MoreThanTxt@1000000012 : TextConst 'ENU=More than';
    BEGIN
      IF "Aging By" = "Aging By"::"Due Date" THEN BEGIN
        HeaderText[1] := NotDueTxt;
        i := 2;
      END ELSE
        i := 1;

      WHILE i < "No. of Columns" DO BEGIN
        IF "Heading Type" = "Heading Type"::"Date Interval" THEN
          HeaderText[i] := STRSUBSTNO('%1\..%2',PeriodStartDate[i],PeriodEndDate[i])
        ELSE
          HeaderText[i] :=
            STRSUBSTNO('%1 - %2 %3', "Ending Date" - PeriodEndDate[i] + 1, "Ending Date" - PeriodStartDate[i] + 1, DaysTxt);
        i := i + 1;
      END;

      IF "Heading Type" = "Heading Type"::"Date Interval" THEN
        HeaderText["No. of Columns"] := STRSUBSTNO('%1 \%2', BeforeTxt, PeriodStartDate[i - 1])
      ELSE
        HeaderText["No. of Columns"] := STRSUBSTNO('%1 \%2 %3', MoreThanTxt, "Ending Date" - PeriodStartDate[i - 1] + 1, DaysTxt);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Table 70220 ForNAV Aging Buffer
{
  OBJECT-PROPERTIES
  {
    Date=12/06/17;
    Time=[ 9:28:25 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 20  ;   ;Account Type        ;Option        ;CaptionML=ENU=Account Type;
                                                   OptionString=Customer,Vendor }
    { 30  ;   ;Account No.         ;Code20        ;TableRelation=Customer;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Account No. }
    { 35  ;   ;Credit Limit (LCY)  ;Decimal       ;CaptionML=ENU=Credit Limit (LCY) }
    { 40  ;   ;Currency Code       ;Code10        ;CaptionML=ENU=Currency Code }
    { 50  ;   ;Document Type       ;Option        ;CaptionML=ENU=Document Type;
                                                   OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 60  ;   ;Document No.        ;Code20        ;CaptionML=ENU=Document No. }
    { 61  ;   ;External Document No.;Code35       ;CaptionML=ENU=External Document No. }
    { 65  ;   ;Document Date       ;Date          ;CaptionML=ENU=Document Date }
    { 70  ;   ;Posting Date        ;Date          ;CaptionML=ENU=Posting Date }
    { 80  ;   ;Due Date            ;Date          ;CaptionML=ENU=Due Date }
    { 90  ;   ;Amount              ;Decimal       ;CaptionML=ENU=Amount }
    { 95  ;   ;Amount (LCY)        ;Decimal       ;CaptionML=ENU=Amount (LCY) }
    { 100 ;   ;Balance             ;Decimal       ;CaptionML=ENU=Balance }
    { 105 ;   ;Balance (LCY)       ;Decimal       ;CaptionML=ENU=Balance (LCY) }
    { 110 ;   ;Amount 1            ;Decimal       ;CaptionClass=GetCaptionClass(1) }
    { 115 ;   ;Amount 1 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(1) }
    { 120 ;   ;Amount 2            ;Decimal       ;CaptionClass=GetCaptionClass(2) }
    { 125 ;   ;Amount 2 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(2) }
    { 130 ;   ;Amount 3            ;Decimal       ;CaptionClass=GetCaptionClass(3) }
    { 135 ;   ;Amount 3 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(3) }
    { 140 ;   ;Amount 4            ;Decimal       ;CaptionClass=GetCaptionClass(4) }
    { 145 ;   ;Amount 4 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(4) }
    { 150 ;   ;Amount 5            ;Decimal       ;CaptionClass=GetCaptionClass(5) }
    { 155 ;   ;Amount 5 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(5) }
    { 160 ;   ;Amount 6            ;Decimal       ;CaptionClass=GetCaptionClass(6) }
    { 165 ;   ;Amount 6 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(6) }
    { 167 ;   ;Amount 7            ;Decimal       ;CaptionClass=GetCaptionClass(7) }
    { 170 ;   ;Amount 7 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(7) }
    { 175 ;   ;Amount 8            ;Decimal       ;CaptionClass=GetCaptionClass(8) }
    { 180 ;   ;Amount 8 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(8) }
    { 182 ;   ;Amount 9            ;Decimal       ;CaptionClass=GetCaptionClass(9) }
    { 185 ;   ;Amount 9 (LCY)      ;Decimal       ;CaptionClass=GetCaptionClass(9) }
    { 190 ;   ;Amount 10           ;Decimal       ;CaptionClass=GetCaptionClass(10) }
    { 195 ;   ;Amount 10 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(10) }
    { 200 ;   ;Amount 11           ;Decimal       ;CaptionClass=GetCaptionClass(11) }
    { 205 ;   ;Amount 11 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(11) }
    { 210 ;   ;Amount 12           ;Decimal       ;CaptionClass=GetCaptionClass(12) }
    { 215 ;   ;Amount 12 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(12) }
    { 220 ;   ;Amount 13           ;Decimal       ;CaptionClass=GetCaptionClass(13) }
    { 225 ;   ;Amount 13 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(13) }
    { 230 ;   ;Amount 14           ;Decimal       ;CaptionClass=GetCaptionClass(14) }
    { 235 ;   ;Amount 14 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(14) }
    { 240 ;   ;Amount 15           ;Decimal       ;CaptionClass=GetCaptionClass(15) }
    { 245 ;   ;Amount 15 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(15) }
    { 250 ;   ;Amount 16           ;Decimal       ;CaptionClass=GetCaptionClass(16) }
    { 255 ;   ;Amount 16 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(16) }
    { 260 ;   ;Amount 17           ;Decimal       ;CaptionClass=GetCaptionClass(17) }
    { 265 ;   ;Amount 17 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(17) }
    { 270 ;   ;Amount 18           ;Decimal       ;CaptionClass=GetCaptionClass(18) }
    { 275 ;   ;Amount 18 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(18) }
    { 280 ;   ;Amount 19           ;Decimal       ;CaptionClass=GetCaptionClass(19) }
    { 285 ;   ;Amount 19 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(19) }
    { 290 ;   ;Amount 20           ;Decimal       ;CaptionClass=GetCaptionClass(20) }
    { 295 ;   ;Amount 20 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(20) }
    { 300 ;   ;Amount 21           ;Decimal       ;CaptionClass=GetCaptionClass(21) }
    { 305 ;   ;Amount 21 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(21) }
    { 310 ;   ;Amount 22           ;Decimal       ;CaptionClass=GetCaptionClass(22) }
    { 315 ;   ;Amount 22 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(22) }
    { 320 ;   ;Amount 23           ;Decimal       ;CaptionClass=GetCaptionClass(23) }
    { 325 ;   ;Amount 23 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(23) }
    { 330 ;   ;Amount 24           ;Decimal       ;CaptionClass=GetCaptionClass(24) }
    { 335 ;   ;Amount 24 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(24) }
    { 340 ;   ;Amount 25           ;Decimal       ;CaptionClass=GetCaptionClass(25) }
    { 345 ;   ;Amount 25 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(25) }
    { 350 ;   ;Amount 26           ;Decimal       ;CaptionClass=GetCaptionClass(26) }
    { 355 ;   ;Amount 26 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(26) }
    { 360 ;   ;Amount 27           ;Decimal       ;CaptionClass=GetCaptionClass(27) }
    { 365 ;   ;Amount 27 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(27) }
    { 370 ;   ;Amount 28           ;Decimal       ;CaptionClass=GetCaptionClass(28) }
    { 375 ;   ;Amount 28 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(28) }
    { 380 ;   ;Amount 29           ;Decimal       ;CaptionClass=GetCaptionClass(29) }
    { 385 ;   ;Amount 29 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(29) }
    { 390 ;   ;Amount 30           ;Decimal       ;CaptionClass=GetCaptionClass(30) }
    { 395 ;   ;Amount 30 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(30) }
    { 400 ;   ;Amount 31           ;Decimal       ;CaptionClass=GetCaptionClass(31) }
    { 405 ;   ;Amount 31 (LCY)     ;Decimal       ;CaptionClass=GetCaptionClass(31) }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      HeaderText@1000000000 : ARRAY [31] OF Text;

    PROCEDURE GetCaptionClass@1000000000(FieldNo@1000000000 : Integer) : Text;
    BEGIN
      EXIT('3,' + HeaderText[FieldNo]);
    END;

    PROCEDURE SetCaptions@1000000001(VAR Args@1000000000 : Record 70219);
    VAR
      i@1000000001 : Integer;
    BEGIN
      FOR i := 1 TO ARRAYLEN(HeaderText) DO
        HeaderText[i] := Args.GetCaption(i);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70250 ForNAV Statement Arguments
{
  OBJECT-PROPERTIES
  {
    Date=11/28/17;
    Time=[ 3:35:25 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Start Date          ;Date           }
    { 2   ;   ;Ending Date         ;Date           }
    { 3   ;   ;Document Date       ;Date           }
    { 4   ;   ;Print All Having Balance;Boolean    }
    { 5   ;   ;Print All Having Entries;Boolean    }
    { 6   ;   ;Print Entries Due   ;Boolean        }
    { 7   ;   ;Print Unapplied Entries;Boolean     }
    { 8   ;   ;Print Reversed Entries;Boolean      }
    { 9   ;   ;Include Aging Band  ;Boolean        }
    { 10  ;   ;Date Choice         ;Option        ;OptionCaptionML=ENU=Due Date,Posting Date;
                                                   OptionString=Due Date,Posting Date }
    { 11  ;   ;Period Length       ;DateFormula    }
  }
  KEYS
  {
    {    ;Start Date                              ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70900 ForNAV Captions
{
  OBJECT-PROPERTIES
  {
    Date=09/01/17;
    Time=[ 6:00:00 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    DataPerCompany=No;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 2   ;   ;Unit Price          ;Boolean       ;CaptionML=[ENU=Unit Price;
                                                              ESM=Precio unitario;
                                                              FRC=Prix unitaire;
                                                              ENC=Unit Price] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70998 ForNAV Sales Tax Buffer
{
  OBJECT-PROPERTIES
  {
    Date=07/17/17;
    Time=[ 3:23:01 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 2   ;   ;Exempt Amount       ;Decimal        }
    { 3   ;   ;Taxable Amount      ;Decimal        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70999 ForNAV Document Line Buffer
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;VAT %               ;Decimal       ;CaptionML=[ENU=VAT %;
                                                              NLD=Btw %];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 2   ;   ;VAT Base            ;Decimal       ;CaptionML=[ENU=VAT Base;
                                                              NLD=Basisbedrag btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 3   ;   ;VAT Amount          ;Decimal       ;CaptionML=[ENU=VAT Amount;
                                                              NLD=Btw-bedrag];
                                                   AutoFormatType=1 }
    { 4   ;   ;Amount Including VAT;Decimal       ;CaptionML=[ENU=Amount Including VAT;
                                                              NLD=Bedrag incl. btw];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5   ;   ;VAT Identifier      ;Code10        ;CaptionML=[ENU=VAT Identifier;
                                                              NLD=Btw-identificatie];
                                                   Editable=No }
    { 6   ;   ;Line Amount         ;Decimal       ;CaptionML=[ENU=Line Amount;
                                                              NLD=Regelbedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 7   ;   ;Inv. Disc. Base Amount;Decimal     ;CaptionML=[ENU=Inv. Disc. Base Amount;
                                                              NLD=Basisbedrag factuurkorting];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 8   ;   ;Invoice Discount Amount;Decimal    ;CaptionML=[ENU=Invoice Discount Amount;
                                                              NLD=Bedrag factuurkorting];
                                                   AutoFormatType=1 }
    { 9   ;   ;VAT Calculation Type;Option        ;CaptionML=[ENU=VAT Calculation Type;
                                                              NLD=Btw-berekening];
                                                   OptionCaptionML=[ENU=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                                    NLD=Normaal,Verlegging,Volledig,Sales tax];
                                                   OptionString=Normal VAT,Reverse Charge VAT,Full VAT,Sales Tax;
                                                   Editable=No }
    { 10  ;   ;Tax Group Code      ;Code10        ;TableRelation="Tax Group";
                                                   CaptionML=[ENU=Tax Group Code;
                                                              NLD=Tax Group Code];
                                                   Editable=No }
    { 11  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              NLD=Aantal];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 12  ;   ;Modified            ;Boolean       ;CaptionML=[ENU=Modified;
                                                              NLD=Gewijzigd] }
    { 13  ;   ;Use Tax             ;Boolean       ;CaptionML=[ENU=Use Tax;
                                                              NLD=Use Tax] }
    { 14  ;   ;Calculated VAT Amount;Decimal      ;CaptionML=[ENU=Calculated VAT Amount;
                                                              NLD=Berekend btw-bedrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 15  ;   ;VAT Difference      ;Decimal       ;CaptionML=[ENU=VAT Difference;
                                                              NLD=Btw-verschil];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Positive            ;Boolean       ;CaptionML=[ENU=Positive;
                                                              NLD=Positief] }
    { 17  ;   ;Includes Prepayment ;Boolean       ;CaptionML=[ENU=Includes Prepayment;
                                                              NLD=Inclusief vooruitbetaling] }
    { 18  ;   ;VAT Clause Code     ;Code10        ;TableRelation="VAT Clause";
                                                   CaptionML=[ENU=VAT Clause Code;
                                                              NLD=Code btw-clausule] }
    { 19  ;   ;Tax Category        ;Code10        ;CaptionML=[ENU=Tax Category;
                                                              NLD=Belastingcategorie] }
    { 70000;  ;Line No.            ;Integer        }
    { 70001;  ;Amount              ;Decimal        }
    { 70002;  ;Allow Invoice Disc. ;Boolean        }
    { 70003;  ;Inv. Discount Amount;Decimal        }
  }
  KEYS
  {
    {    ;Line No.                                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE CreateForRecRef@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      Fld@1000000002 : Record 2000000041;
    BEGIN
      FindAndSetField(RecRef, 'Line No.', 70000);

      Fld.SETRANGE(TableNo, DATABASE::"ForNAV Document Line Buffer");
      Fld.SETFILTER("No.", '<>70000');
      Fld.FINDSET;
      REPEAT
        FindAndSetField(RecRef, Fld.FieldName, Fld."No.");
      UNTIL Fld.NEXT = 0;
    END;

    LOCAL PROCEDURE FindAndSetField@1000000004(VAR RecRef@1000000003 : RecordRef;FieldName@1000000002 : Text;FieldNo@1000000004 : Integer);
    VAR
      FldRef@1000000001 : FieldRef;
      Fld@1000000000 : Record 2000000041;
      ThisRecRef@1000000006 : RecordRef;
      ThisFld@1000000005 : FieldRef;
    BEGIN
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, FieldName);
      IF NOT Fld.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Fld."No.");

      ThisRecRef.GETTABLE(Rec);
      ThisFld := ThisRecRef.FIELD(FieldNo);
      ThisFld.VALUE := FldRef.VALUE;

      ThisRecRef.SETTABLE(Rec);
      IF FieldNo = 70000 THEN
        INSERT
      ELSE
        MODIFY;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Report 70000 ForNAV VAT Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:38 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=P”ntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70001 ForNAV VAT Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  Name=NoOfCopies;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE GetNoOfCopies@1000000006() : Integer;
    VAR
      GetNoofCopies@1000000000 : Codeunit 70007;
    BEGIN
      EXIT(NoOfCopies + GetNoofCopies.GetNoOfCopies(Header));
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70002 ForNAV VAT Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de cr‚dito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de cr‚dit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70003 ForNAV Sales Shipment
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Prodejn¡ dod vka;
               DAN=Salgsleverance;
               DEU=Verkaufslieferung;
               ENU=Sales Shipment;
               FIN=Myyntitoimitus;
               FRA=Exp‚dition vente;
               ISL=S”luafhending;
               ITA=Spedizione vendita;
               NLD=Verkoopverzending;
               NOR=Fûlgeseddel;
               SVE=Utleverans;
               DES=Verkaufslieferung;
               ENG=Sales Shipment;
               ESM=Remisi¢n de venta;
               FRB=Exp‚dition vente;
               ITS=Spedizione vendita;
               NLB=Verkoopverzending;
               DEA=Verkaufslieferung;
               ENA=Sales Shipment;
               ESN=Albar n de venta;
               FRC=Livraison de vente;
               ENC=Sales Shipment;
               FRS=Exp‚dition vente;
               ENZ=Sales Shipment];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table110;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table111;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70004 ForNAV VAT Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>fJ0AAO1de3PbOJL//6ruO/B0VWe7VqMQIB7kTLRTfiQT1yW213YyU3t15aJI0OaGFrUUlcS7e1X3ae6D3Sc5gC/xAUqgSD/mZpKKY1EE0OhfA+huNBqvf/x2H2hfWLT0w/l0BCb6SGNzJ3T9+e10tIq978zRj3/85396/Usc2ZdsEUbx8r39EK7iKxb5duD/jUXa+tdPRUVoAidY1FZ5NNLO7Hs2HWU1vQ2jM/vLSDsO53EUBtcPC/7dCfvy5tsiYsvlpNTo5ONp6SMcay2vfRHNjPNWtamWUzLWjldBvIoYfzZnK14kGGsXq1ngO//OHq7Dz0y87VLHNpkJdeohhnRO/4m/XAT2Q0q3IPjwk/bp8Fq7sgO21P60CmM20ir9KXpsTHT+FyCd9/t89hfmxGfhdER1XUcj7a3PAvdnNuPM++I77GMUTEd3cbz4/tUrly0/x+HiO/vu/osf699THZmvTh7m9r3vLHn7AOivzk/s2B5pF/Yte8f827t4OoIW1dMnP/tufMcfANGBD3Z068+XnBydMwGIHzD7wangnJ+ODgV+Y81axGPNubOjKxZPRdcXPq8Eo7x/H+c+f/mazeO75bl3+MEPAv+exSzi3ZtfRCx964O95I+unMhfxAXHUm5ds3vOS84wLlGa9vrInrvL5Ff+4TRm9yATj3fMdkWtFblImSu6LV4VZbk0sa+ivxcsumROGLnTURytOB7HduAkDObdPrwPV/NYO507wUqItUBvnD4caddhbAf5m0QfEzDSforC1aLyhcF5kbX7yY6qNOZfXNuzgD9O/jNI7fknn32djq7OL69Pz37aPwsnB9rP795cvtk/CZ3VPWeolvTx+Pzs6no/kamDA8H1v771A87MnA5ecHwRLmPRixPBR86hhc/4N4DDdcq7D0WpJYsFV85W9zMW5SxJEMqJytEZZdyvgVEC5JJ5Sf8lUKQcyIBIeJL3puBNIUBHtvP5OAxCTs4RF9cEovnVXeTPP09Hnh0s+ZML/olLz7fzuSMQFV2ofnc+f8Nnqof0i7RXmbDxoZWMOKm0jetkHQZB+DVlwZsoCqNlXtuVfzu3xRwxHTkmcugMMc9ymEsNj3oAUuRh/tyDFBjMtolFHVEobVzOgXRsvp2OTIPPBboORiUWcyZnbF1WnlaZj6TMv2bf4qPw26gyYm5OViyViys+G/NWDTNpFSI0xtbE4n94be9DxxYUvw1Cm8sAMEDylWmONULTX/OJ4Yrdhkz7eDrWzEUsHkYsRzHgiJYRFgQdBpyBovvT0QffdQN2KXrPuRBGf0u+4zN/+kS8PR3973//T0GxEE0+7ySiXu7TJH+jxiLOpKv4IWBcMsLIjx9SZuGR9nHJUuIz0Uk+F3SvH9YIzr54VUfiVQKFDB+YNklU8DleRVE6Pd5cxXzE2JF7bC8ECssbPoYfCsT4mjMmegMkPl9jorfAUgUhYWtaZ5OnazomdTomSRklLtMml+V8gzK+GWklZge5TnrwPgw/rxbLmwv7QUB2zaL75QlbJuOYd6As9JyFyWiDEEjkHXJuUiORdIrJ08l6K+Gtsl/u96StuBJk1uMMDEMGMEqbFGtSf4Qz8VyjCxNodQIykHXShFjX1xBbUoDH2lIwaXoUBu52sBvwFVR1hy4vqgQbAIq4yeFBMnhwVjXsCk8xYzWWmTImLWhsXFp2QGP7wlGhudsyAoxebMcytpOs6i7reY3tmXJR5/0GpqdLu2UMNgiqNKjyvlxIDQDVhVwOAJEBQLOqlRZsKQDnEX92Fm7j/SPMPUXLihzP31djtmQ978BsKmO2mVXdeZUvmM3NtEt26y+5pZ7o1ypsH3qSkdCgCECzpBoUquu0HApTBoWVVg13Xo6PV8s4vGeRZCluw2HweadBg9rCWy+mBALst+haUmNOz+refdUtjYAWKwFODINbc2CstZkK23ktleazUPuDtve9tsf/y17oMBbkpdWg6LcQA12KRWZZw85LceIaWt4c+UFwE4eHriv8jxVUYKIKGdBsGh7C+5ZY4YSY8nHRyeq4DhfvmRcnHtY4szj4s4oFkr7QBDbtx6Tej814ygupwfhYdrnUMAeZZQ7VTPPwfmHPH07nXhjdJ3hVsO4IMjD0zPQcHO3MnNwAd93g3ABss9cVkLuhq6o/dEVX6j4Amf8AKqkWJcdLffna4GrR5fNnt3Wr4SFIR2PL8BRrXPvaVvLbdFvKHsnuB1LDH2SWvyFXNS58RzhXN4+97KUWg6ayK5HhSPkX+VDD5u7embxhXm2y+/XnMLw/vbdvpXaOZPzkFSgBY4DuPJda8yAz5w0lxaI0HC6SnmU8hPKxALC+YTg8kpOsheHrEZC8osZlVfWhKxRSCx9kJr7RRa/IltNcUS0reViKSeK+3KJgD49MpghIqG1VGprvqmH2WLqC1CkAMq+A0dkrINUFURm9DT6xFMQn323pYs/uaMEaj6UMSN0MIPMzGJ39DFL4zDV8KB1g7U7mzOkJTGOsUZSD/XRYbncJdXICGY+lKUh9EiBzSqAuTgm5/7PDFicGzzBzqjtNu7tJkaqnoitoVR/G61eSfermzmh5VxTJ1ZG3YRhXYwbSJ5tjBS44Dux0fhTGfCXJN+vbQgI2hRE0gw6UAghyGkvxAdh1AMO2bTr8L7Ys29JnBsAzXcc2hJQAYlB3BpxafEBeUxEXALG+Q0iAPCCj62xHikEEEh0aSY0htV3nxqg45r8nPV0Pi/zRh1UQ++/9eQFZOlD+49/+9dvJD/zH4Q8y7founLOzUNP+Zart7Wk/am0WbOF2ykv8QdvTUufTpmq/1+arIBhrG4l4c/PB9gN1ErL3N1KQvZO1v7H5d1yPEvLcgQlFkY00FG8pcaGhGaiT0yya0yUnrPm+EoWnR4dn6kQlb2/kT/KGUstXP5++vT4O3S4YrctsJGL9WkrJmo7/nKx/95KIsX1vNU+mHW3/ix0caH+PGJ+35hr/8MN/HUz+Evrz/T3tH9regWw9+n0k/j4Sfx+JTz4S1VQ+JFX5hopmQ3g4nzms6hdyXyuwJAoGWftaT2M78J0+6kaqXfzE4vfs1g5451w/QXv/4AfZ5Cd/UQ0b0hsbqKp4w7ribWTYCMVKIXQ6/3RhR5wqETucx6xWQp+FA7kR+5w2IY18phsjn4twZxHJLGoRvxysi/BHnzknGSfJkcRYv08093Il07enb96fJBHVY60aTJ1+U3l2oKVR0kZN5a7HPjf0bbl34Sh0H8qmjOjQUjzcYs0Mb6CUWi7ZKK4OTQg9BwBim7rpUeoBwjyICXCACSxizVzgubOajVKqrDBTiC4ZAS2WSoN7VoVBiVjU+PnLZfZ0y3yRbnBTTEh1K0BCAafhMvwqo61OH7fAyvTxUnLqki/WwP6cHbvQJ5hQSwfQQNkvcnJSlrFAyi8pXUBOh6ijTHESGLCmS2qsFa4I8W6JcouYkCJKdAgtA5pYNiGKNpLt/i6bWlyQ+WLwtRDjq7vw6/kqXqzirEI+zZ4nq+4nO1ix/T3Rxb0DbTrVNvAvYZEs7Bv2mHgrlUsXyAZC2WKJ63Z4G0LVaF9FqCqFcszgBJsEYmjwQW1aFJFWxCrFa3B0Z7BE69jOx/r+bYOP2VYurisdbXz808qex5wodSauSzSlHhmI8GmQ8nF2FNjzz39mUZi7JFqYuq6umyuwN//7aBZNYOq7tw1gso1cTBWBEUfDQu8Ds5fJFqoqOrVidYiwbhD+C6AiaLYFkVoVTwyLOSgs9Q3eBizZXi+2FGERP078pSMOu104sTowjYLN0WMQ08QYiZ0X1dHTqLUXWpU1pTgemeq5vPHJO3uZNzadJnR1xleoIAPiW981buCbbSAT1ZVfCD+n2Ok45LIiTUwp1S2ALdoB01J9Tzv2yLBrfn13uIFNtlFMVNf8/IipKjD5+zkqYAIsg2CsmxBBXefqujooxfHWp0Wkj2uiiUh9w7f8/SY9epMO9/pVi1HQVkhqgWdfJfsY3LZb3c8zBuCdDhDKQw+ax2sT82T4s7XqFmbedsnGpMwxba6GziAwHIu4kJtutkcM23Bm1LJM6lHTYIzIbMzGIVlxXn1nM5NQCZ+Ujc3kqLx086vE6FBsqC85m5ONyH5WJzEl5A5ge2qHqzh8Kw7qb17yOpmiRFXhqEes37TJbI2V26MtpRYsmZg6gpZOLUwMw0Iiiqexu9gyR9Zj1BuzZUpaI8Y6p3ibydt5+qRyZaNg1dPZtVRV/6idT1tbnG24q8Mst36tCTIxxKZJkGFBXRwP2A3vSvXPDbxckxkQeFVDnKoqN1Xgc6u4P+pNcz0f4oYF+BwNjZ0RbzXdU1yb0fUSvNeKUr6+5vlGekqAXHMaUAJULX6q6oqpSoCwAs5zK7y/GLT4BXJZIADzf1AXp+V2E4bNXoOXIBFyh8+AEqHqbKCqPqCqRNRs/XaZqEfbqUtJq5MilxNsAgiQgUQw2m5yss1jsZOkPLETg8qdVNIgwQHlS9XZQXfTLQu/w2NIlsRJUsiUjgiiFKOdVc12j8kLmHdMuRL62MKi6n0xd9NMU39IWVJ6rlESWLM8YyJwZL900rV2HDkSW9sPeYjJwV7J32NMiG7yKYv/MSGA5s4CtislQ89t3YXv0RXhJ/UptXQyPZNU8tq091TWoc6eKoVUTC0HliJ7vmy6oUqPnzzQodJ2yQ1lYACR4yEdmYbJgOtZNjJcCpHHiO6ymQGoDnUX19xQlerWbqg+0Q5iD71R+ct1Q4lZpkHuS3VDmbupomfhTYvM9vM6Ad1ABFOAdzZDXoDXyZRrh8/gdTJ3UwTLXqfeMG/0OhFqUtOkhjh18+v3OlmP7m5U9TpZuyl1hdepN+q/Gq9TP8AfXbtSdTJZu7kZK06b/qirOplekI+pH/6P7mRUdSlZuzkZ6y6lVgl4ApcS/i17lCy5c/KleJSs3dTEtUfpEQTrt+tRsp7H/ajqUbJUtc6zUH9ZjiLD5PJjoSQw6DfmKErM5P/3niKgg8dxFVXtLqCrpQ7ib/jzFXNvMg9qHmSWpxCy0mwm1JRmEkKlvGhb0mspHvnannehCMHbGCXXAQ95OiF1EWu3i8r2ENCVEgg1AKknOAPyBEIAYn07CGISG2tyKLIU81nz3fPM5wU7cF6SFKidwU07ZItzdHMa85bUQEJJaOazKD1+Hu+oJFmFNZtRR0fuTHe4poGZbgqTduYR13WJBx2KPMswZ0zmHW1krLD4OCYI0t1dpECvK2g9DpkiNXH/VQm7RGPqM73XNZwe3DbWeXdaMsYhfSu3X+z8DvqG+7fN71umn41p+kHdO9aWSSfZ0XymmafSdnlfRkczl1EwIzM8AzPbhJCxGRcS4EFiQ8NkNkAzG8rCg5u5cnScZNmyJCcElecetWsPso94PbkAPb9VBAKjmQ1MrKgIZQqQ7F6tTaJfvl7iLJTniEr5zp+tFpPyqx2kW6K99JhWxJmslLSrO3vB5GxNvqpucWEp76qJPUWptBox+tPj5lkewuLzVRyx2LnLDZ7D+a04hW5Jtu5Sjog6c9Jx1kb5OHsPfU3tSoFmKlqiqjwb6deUjDWYCJkFRaDeVhtUImbtc2Zm/XWfNRWuA1ozU+YjrqhbalcGNJlpbl2aSlw006EKFW9UqrCmuEnu0+H1d1WmbePqhqId+C3J1NfOb5lPtnoNjFIKvia/6VZ+p3cN9pTXq9UsSUjRVfEqyqkzVpb3v52xMm9k5aIXtVT/TcZaaowFKF0NDXnOySpjG+ct6pzexMqEj929RN3w2q2RDuDKbXd1N4rMoVi5V0btOgE1PVvvMpkNKwnFGlGerDrNbF1QkSf7VUdF5qarXEAz5CUAoIxKnnW0dYB2XGM436/tb+0LycbBUxTswPpOy3Y9i+tWm6Y6Pb5+1bhftKENZFpA2lsuRmmPhk1nBMZkbIyhJKdRrUFZciMoQiY2ZDcS1wKfurx53/NZNBYfxUW0qyCRjSQD0ZgjlV4wq4lZbMwB0PgjcaurH/tf2EGaoEgku0/+gFFiY4WRHT3IQqm2pi4CUG7913MXcWKfJXNR0W7JaGQzREwITBNYCHsucogOsM3/zjwym808jxJqe8StGY1FVYNkLQJGkRYoFlC3bFmrpDgbLFMREDN8iSZerIWsp85VBBrXD7Rvo2H1M/Ec0vWAKncDUbH7hS2qA2RBbEgTF1WG9KRWV+8tKNndAsMFw4HGJQLtDCWdGFpL57EbJ5NK+rNQ0atfZaFqWBlo5PRvZyHtlhqlnqthJzaWK+rPSsXVvMpK1YAt0Miv385Ks5M0DsLJUj39GaloXVcZqRr5BBoJ79sZaXVi5JG9ZP3ZmNbSm4myvPR94nteasIPIE4Wds/4AVoSuDfPWnBIninhR6nl8k6iSRhlM9sltmm7pjOzjBnl/3QbM2balmsjiL0ZbapmjVMWtI9yhlBFEWqZ6JXyzw6nnSFc185a6Hpy7QyproSlAPWNZ046RL4NqcM1UlgPqtEh+dU1Ks6Iot5uSl4jsawCLmA4XPqrgg1AhlEMkfwymu5IKOuKWHVdLiEBB0JiMI2yGWk8mFqE5TfNdEdEWeXEqhZlCRFjuLHxCIAMqabi3d3ZVTyUNVesapCW8EDD4TGAfttAYyBtF+/uxK5i8bIV4O3niAGWO9ubsSqc+c8UqVJquaTXivg33TAMLkmY29IeQI5NKGbiNm3ThsjFlushsVzX9dpGlEovpyOmFRWy5SDD0zodsVlXa1vIenK1ViUPbpw/kOtNyRXKUuN6Tb6FCDYIsSjSsQ5RkhCn75zRkln2GY7dAuVss6WJnbYxc6xtmN1VdB5ITMM0MEIQEAyf2IvWklP2EfVO5XSyJeabfZnfpt6UeS/PLP94freW5LGPqGAS1VOIJdZbA7Beosl0FfrhdBeilmesjx75cnSXqmi07UmXe5JpwAUGx4G9Wvbbj5btPOfVynadMdm86yz2kevbxrD3tjFRu/KmoP25No/LrZevvoGGY1mO5REMHGpQmxgeX7kNbjMwCJjj2TNqGyLjal2fK1c4jE7XSJ67222dQFHr6x94v/UurYJN5YQWSeyWCN2Sfts2qXWvRz3CpSWhbtdw/r57BCKbrsoeQdt8tLYK62+8TttZ1icsoKXhWCwzdtdHw8NV5LA33xZRPqSO75jzubh4ODsXXj4jvp8KZn2G0aURYeti5S4LdpXpLHe+3KXXl8zh607xWnkQifDRszDNFtgWsrVus6LfilSaSdGU7EY4fa1YrpkJNT8vBqrFivvhkhNSQaVxvmYVvXj96pc4stOgreV7+yFcxVdMnAng4zj64/8B</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70010 ForNAV Warehouse Shipment
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                                                                                                                              ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table7320 }

    { 1000000001;1;DataItem;                 ;
               DataItemTable=Table7321;
               CalcFields=Pick Qty. }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'WarehouseShipmentLine': WITH "Warehouse Shipment Line" DO CASE Operation OF
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70050 ForNAV Tax Order Confirmation
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Objedn vka;
               DAN=Ordre;
               DEU=Auftrag;
               ENU=Order;
               FIN=Tilaus;
               FRA=Commande;
               ISL=P”ntun;
               ITA=Ordine;
               NLD=Order;
               NOR=Ordre;
               SVE=Order;
               DES=Auftrag;
               ENG=Order;
               ESM=Pedido;
               FRB=Commande;
               ITS=Ordine;
               NLB=Order;
               DEA=Auftrag;
               ENA=Order;
               ESN=Pedido;
               FRC=Commande;
               ENC=Order;
               FRS=Commande;
               ENZ=Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70051 ForNAV Tax Sales Invoice
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Faktura;
               DAN=Faktura;
               DEU=Rechnung;
               ENU=Invoice;
               FIN=Lasku;
               FRA=Facture;
               ISL=Reikningur;
               ITA=Fattura;
               NLD=Factuur;
               NOR=Faktura;
               SVE=Faktura;
               DES=Rechnung;
               ENG=Invoice;
               ESM=Factura;
               FRB=Facture;
               ITS=Fattura;
               NLB=Factuur;
               DEA=Rechnung;
               ENA=Invoice;
               ESN=Factura;
               FRC=Facture;
               ENC=Invoice;
               FRS=Facture;
               ENZ=Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70052 ForNAV Tax Credit Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dobropis;
               DAN=Kreditnota;
               DEU=Gutschrift;
               ENU=Credit Memo;
               FIN=Hyvityslasku;
               FRA=Avoir;
               ISL=Kreditreikningur;
               ITA=Nota credito;
               NLD=Creditnota;
               NOR=Kreditnota;
               SVE=Kreditnota;
               DES=Gutschrift;
               ENG=Credit Memo;
               ESM=Nota de cr‚dito;
               FRB=Avoir;
               ITS=Nota credito;
               NLB=Creditnota;
               DEA=Gutschrift;
               ENA=CR/Adj Note;
               ESN=Abono;
               FRC=Note de cr‚dit;
               ENC=Credit Memo;
               FRS=Avoir;
               ENZ=Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table114;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table115;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70054 ForNAV Tax Sales Quote
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:39 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=Quote;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table36;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70100 ForNAV VAT Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ objedn vka;
               DAN=Kûbsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupap”ntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Ink”psorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70101 ForNAV VAT Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ faktura;
               DAN=Kûbsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kjûpsfaktura;
               SVE=Ink”psfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>5psAAO1de3PbuHb/vzP9Dqw60yRztQpeBMlNdHf8SHY9N3Hc2Mnu3E4nA5GQzRtaVCkqife2M/00/WD9JAX4Eh+gCEqU7e1udjaxSQI4OL8D4JyDg4OXP3y7DYwvPFr54WI6ghMwMvjCDT1/cT0dreP5d/bohz//4z+8/CWO2Hu+DKN49Ybdhev4kkc+C/xfeWRsfvxYVEQmaGLK2iqPRsY5u+XTUVbT6zA6Z19Gxkm4iKMwuLpbinen/Murb8uIr1aTUqOTD2elX9HYaPnsi2xmnLdqTI2ckrFxsg7idcTFswVfiyLB2LhYzwLf/Qu/uwo/c/m1Z7nM5jYC1pxwAgT9p/5qGbC7lG5J8NFH4+PRlSgauTdsxY2zxZfQd/nIqHSq6DaeAPEfJEB0/t3sb9yNz8PpyAIQwJHx2ueB9zOfCQ5+EXV8iILp6CaOl98/f+7x1ec4XH7Hbm6/+DH43gLEfn56t2C3vrsSREAInr87ZTEbGRfsmv/E/eubeDpCjgXSJz/7XnwjHkDZi7csuvYXK0EOEJyA8i+U/SWoEOyfjo4kiGPDWcZjQ/QsuuTxVPZ/6YtKTJL378PCFx9f8UV8s3o3P3rrB4F/y2Meie4tLiKefvWWrcSjSzfyl3HBtoJlV/xW8DTmIyFZhvHymC28VfKj+OUs5rcwE5OfOPNkxRX5SPkrey4/lWWFVPGvsssXPHrP3TDypqM4WgtITljgJjwWPT+6DdeLWMDlBmsp3hLFcfpwZFyFMQvyLykYUwHOj1G4XlZeYMGOrN2PLKrSmL+4YrNAPE7+gQjVXnz0+dfp6PLd+6uz8x+fnoeTZ5Kv//HaDwS78mbE4/FFuIolkaeSTYIBS5+LN1AAciZ6h2SpFY9lp8/XtzMe5T1OMMibzPk/yphb43WJ3+/5POmegtNpBzM+J10+Dd31rRCAouuFiBwz9/NJGISCnGMhkAkCi8ubyF98no7mLFiJJxfiNyEf394tXAmY7EL13bvFKzEh3aUv0l5l4iQGTzKm2uRpXKfsKAjCrykXXkVRGK3yCi/96wWTs8F05DDXdQHAkM/mAJiu41DXI4zMuAPQfE4QdKkFKBWF0vbVTEgH4OvpyMZiwAMxuktcFnzOOLuqPK3ynyj5f8W/xcfht1FlTHw6XfNUNC7FvCtaxXbSKiJkbDoTR/wRtb0JXSYpfh2ETIgBxDB5Zdtjg1rpj2X00nngkl+H3PhwNjbsZSwfRjyHNBDwirEiCDoKBANl96ejt77nBfy97L3gQhj9mrwTc3z6RH49Hf3vf/9PQbGUTjG5JNJe7tMk/6LGIsGky/gu4EI4wsiP71JmmSPjw4qnJGfSk/xeULt5WCM4e/G8jsTzBAoVPihtkurgc7KOonQO/HQZi0HDIu+ELSUKq09iGN8ViInVZUxBAyQxKZsUdMJSsDWts8nTDR2TOh2TpIwWl60ml9V8Qyq+4bQSu4dcJz14E4af18vVpwt2JyG74tHt6pSvknEsOlAWesHCZLQhBBXyjgQ3LZxIumXS+5P1VsJbZb/c70lbcS3InMMMDKwCmKRNymVpf4Qz8dygixJoAYUZyIA2IQZgA7HTAfDYWEl2TY/DwGsDuwFfQVV/6PKiWrBBqImbGh6igsfMqkZ94SlmrMYyU8akBQ3NpUUbje6Fo0Jzv2UE4r3YbqrYTrOq+6znNbZnykWd91uYni7tDh5sEFRp0OV9uZAeALoLuRoAqgLAyqrWWrCVALyLxLPzsIv3B5h7ipY1OZ5/r8dsxXreg9mWitl2VnXvVb5gtjDE3vNrfyVs8kS/1mH70JOMggZNAJol9aDQXafVUNgqKJy0arTzcvyRL7wwUizEbSgMO+so+StW1E9xmFLWA5ZaMS1M0H5rsKO07UBW9+6LcGlAtBgNaIKxMO7g2Oi2HHox/zw0/mQ8+d54Iv7JPuiBgbq0HhT7rcsQKLHIDG3Ue2VOfEGJuiqE6sjzpN+xAgpKFCOM7KYZIh1uiU1Oqd01TjRskKtw+YbP48SzGmf2h3hWsUfSD5q4pt2Y1LqxHU1lGT0MD2WjK410mFnpSM9MD2+XbHF3tpiH0W2CVgXonhBDDDIzdHCsM9NyC9h143MLrs1eVzDuh66uLtEXXaUrAWa+BKSlZpScMPXFbIvbBXRNnjqrWMNbkI7FlsEpHTjtBmbJh9PLlkQH8gFApRMAZl4ArFY7LnxXOlq3j73soxbjpoJLhqMlXuRDzbR399TkDYtqkz2vv4bh7dktu1baPIrxk1egBQyG/XmutOxhZtpjLa2iNBwukp5lPETqsQBNoDUcBnWYtTB8MwKST/S4rKs79IVCae3DzNzHfZSKulKbT06mEpDEj6mtaw8FS6YEaOvfu2jc+FAqgtIvADPHAO7tGFDpf6QM2xavWIreve+39LFod7Rh8aFUAKWjAWaeBtzb06BCz96gR9KB1e5lzrye0MZjwyI51vcHZbdPqJcXCB9KPVA6JWDmlSB9vBJqB2iPPU4TPsCMqe817e8nJbq+ib6gVb0WL58rNqqbW6PlbVGi1kFeh2FcjRtIn2yPF7gQ3Odni+MwjsPbfLe+LSxgWyhBM/BAN4ggJ7McIwDwzMNz10PYs4ntugx4dG56Lpy7c4BMaNmOmBjcWoxAXlMRG4BMsENYgDouo+d8R4thBBPVmShtIL2N58a4OBE/Jx3dDIz80dt1EPtv/EUBWjpU/k2lSt+EC34eGsY/TY0nT4wfjDZzdePky0r8yXhipG6mbdV+byzWQTA2/uWfv52+EH8dvVB8/erTW+YH+iRk32+lIPsma39r8z+Ft1zKcQ8mFEW20lB8pcWFhkKgT06zaE6XmrDm91oUnh0fnesTlXy9lT/JF1otX/589vrqJPT6YLQps5WIzWcpJf8+2VAyT2LEns7Xi2SGMZ5+YcEz4+8RF1PUwhC/vPivZ5O/hf7i6RPjP40nz1Srzx+j7o9R98eoO+io01PmiFKZGypQjZjDucBRVW9Qu06hs1VxoBvX6VnMAt/tr0akWsOPPH7Dr1kgOuf5CcZPn71QTXTqD/WwoXtjg3RValRXqXGGjVSYNOKe898uWCSokpHBeThqJW5Z+oMbgctpE+qwZTzaFracGy+GDFSW1RhpIHNeRDz6LFjJBU2uIkL6TaKUlyuZvj579eY0C4eWvcA1LbketdxQkdUugePQuysbIJLWlXzYYYMcxKwoNV6yLAAHzJ0j14XMBgy7LsdsNseW6dmmA4mJLMdkkIOaZVGqrDAuKFAIeIt90WCgU+FRAnqNpb+8z552TAfpXrRlUlo1JxQUCBreh19VtNXpE3ZTmT5RSk1d8mKD7c/ZqQgwManlACHYJPtBTU7KMh4o+aWkC6rpkHWUKU728HVDeuW3JcodaiOLWBQg5GBkm6r5TraR7Mxv2YK6vAm/vlvHy7V4XhwkSWcUUdlEViH7YEynBnqRSLpYCb4Wcl7fwdrCoZaIbbTHxFqpXLkANiDKFkOzbj63QVQN1NXEqlIoBw1NTJsiE2EIqXQM0FbIKsVrHO/PYIVW0c3H+nZrg4/ZzqtZVyra+Piva7aIBVH6TNyUaIo9wYTa0LHEQDsO2OLzX3kU5q6EFqZuqtvmxNsi3+kX/fm/j+bQBKa+2doAJtt3NS1NYOTRrXD+lrNVsuOpi06tWB0iE2AqfoCWjHdtQaRWxT3DYg8KS30/tgFLtjVrOpqwyL9O/ZUrT6JduLE+MI2CzdGDqW2bJpFbJrqjp1HrNrQ61pSf2CqvajrNj+QNja/UQQbEt77J28A32++luku/FP6TcNUD2E2JJqKWBRxoOlYPRDfV3e/Ao8Mu+PUt3QYw2e4u1V3w88OfurDk3+egwAl0MDVNYCOCAIAO1cekOHh6v4js43doIlLfpi2/36ZFb1PgXj5vMQnaCinN6+xVsvkgjLv17SJjgLnTwT91vEDzZGxinAx/LLaXiZk3XzIyyXzmQdcjtu0wZlrUxjYC0GOMIuLhmYuBxZnNsMrIbJxvlefJd7YzqaVglba1mRxl79i0Og7lVvhKcDrZQtzP7KS2glxd4/NoHYev5WH5dCI4uC1KdRWOenT5pxax7YyArPNabcLSiQ0IcoDlmBRjh8jom8auYMs0WY8nb0yYacuNgOicoMGNWEutbBScuD+71tLVP2pHyzYW5864d1i/zoTYJjJtmxLsICC9ibvhXan+oYFXKzMDAq9riFu6+k0V+Nwq3h/1prmeD3HsQDFHI7wz4q2me4prMxi+De/SAps2v7/yZKmVpwElQNfit3RdMVUJkHbAu9wK318MWvwCuSxQaIr/hZ7h7CoM270Gj0Ei1A6fASVC19lg6fqAqhJRs/V3loktBytbnRS5nJg2RJBgIsPIdpOTLo9Fl6Q8BieGpXZSKcP7BpQvXWeHtZtumXseDiFYTSdJIVGAUGJZJtlZ0Wz1mDyCScdWa6CHlhRd74u9m1qa+kPKcrLnAqVANcsAJmNBnpaOpFbyd8gDJ3zh3uVRI8+elPw9eEKBLeYr8cdGENk7y9eulOwpjQMI38G14Hv1KbV0Mj0/VPLatPdU1aHeniqNFEoth4sitlg13VClxw8R6VBpvuSGMhGxZxh7HgTUpS5yIJ0LBRFg6nGAbW/mOSY253bNDVWpbuOG2ifcQW6iNyp/vG4oOdE0yH2sbih7N1X0PPzUIrb6FonK6wQBJtS0oLmzGfIIvE62Wjt8AK+TvZsiWPY67Q3zVq8TtWzLti0sz8v89r1OzsHdjbpeJ2c3va7wOu2N+m/B67S/guUcXMHSdTI5u7kZK06b/VHXdTI9Dh/TAPgf3Mmo61JydnMy1l1Ku0rAEC4l8/fsUXLUzsnH4lFydlMTC4/SAeTq9+pRch7G96jrUXJ0Vc7zsF8Cn4M7irAtxMchSWDQ78xRlNjI/+89RcklDodwFVWNLgj00vyIL/zFmnufMg9qHmSWp/tx0hwklq3M+kNKOcy0U2FtPc/VnS6hCMHbGiXXAw916h99EWs3isrGEARayX4agNSTkUF1vh+ITNAHBDmdjY0yFFlq+Kz5/vnh84I9OK/I5NPO4KYR0uEc3Z5+vCWfj1QRmmkoSo8fzDuqyDHhkRn03BnDyDOZ5c1mNnVmHkGIQGARjzHugRmSYShN72gj0YQjhjIlyNrdRSoaHe4QKdGT+N+UvCuUpn1m+LqSswe38SZjTkuCN9LIqvfbmeLhvuH+bVN8xwy0NcM+rHvH2nLgJJuaDzf5VJqvbM1QQsDcdRgEM8ubU+lGxczGLoEeoDOXUzK3nfrkU6luk+UGmEmKLAz3mH5gcVnY5Q1bcrUClLyqbs6YyvPp1QySslRajZTb9CB0lvOu+P0yjnjs3uTa+tHiWp6PdhSbTqmkyjpz0nHWRvmg9R5zg95FAs2cp1RX88Ppa4uODUSSlFlIhpjt4q9rH+2Z6dJ/vPdSLDo1N71LAZrMtDsn1RIX7YSLcrNc62xJhTXFBWUfj66+qzKti6tbivbgt8adPxt+q7zJFd1M716AJr+tTn6nt9jtKa+X61mSKqGvylCU68FYRdq9dsaq3LTVS1208uk1GevoMRaSYhIf4EjANlYmfOzv4uiH126N6IPbcnWAvg9A5Tet3Cajd4GAnoYI+kxmw0pCsUaUJ6teM1sfVNTuAH1UVD7KyhUzelcJ6KECy6jkmS5bB2jPNUbw/Yp9a19Itg6eomAP1vdatpu+vA5tvDpcXj5v3GvZWJ2yVSntrRCjtEfDJtqBYzrG49Kln0W2nVqDqrQ7KEmi1J52R946e+aJ5v25z6Ox/FXeb7oOEtkwJPFjgVR6b6khZ7HxB6n7s2/yNlE/9r/wLL2OzKqe/IGjxDQIIxbdZZpula9diXcgUnsJ6pl3BLEPlXenaLpk7jAwY3hmQ4tSalqejeaMQHsG5sCFyLZciiCD88adn0VVg+Tcgag4XRhLtFv2W3Xybw2WZwcip0KTKNZC1n1n2oGN6wXat4G6dMFqluzNmCp3g1hy98Z0LACJg0ysTLtTGdWTWl37pnOBWKFTDBfJBRt3B7QztPvqzDJDa7koduNkUsn+LFQoAMPFRMFGzv92Flr98nrUcw3sxMZyRfuzUnNBr7JSN9oINnLyt7OyO4l+WRoH4WSpnv0ZqWlgVxmpG7YDG+nx2xnZnRe9zMhjtuL7szGtZX8mahrTVSa2B6c81oQVSZ7u/hkrIFE7pJtnBQQkD5ewotR4STtDjNjY8VwO5ubccqDtEoqY0M88CxHIGMa2gyhjTe2scUrA2kc/I6iiC7VMUFr5UYdT0GQ2+KqC1kLXvStoRHcxLAVY9wvYaXcpDKnGNRIrD6rUEfWNNzouiaLefnoe0V1ZS7gM5eoZRBtsADKMbkjUt9f0R0JbXWykqdVAosu/o4vEYEplM1J2MM2IqC+m6Y+IttZp6hqVJUTwcGPjAIAMqamauzu1q3hoK6+mrk1awoMMh8cAKm4DjYEUXnN3V3YVi8etA3cfhYWm2uXejLUQzH+4SItS4yXVdo45FSq96dkcIgpcFyKTuth0Xc45onQ+Y9CyWD3dd6myYVyPplnRIlti8e/X9WjSumbbQta9a7Y6GXbj/EH3vXDFmE1u8t2Q7xBqYkrlTVImQCTJ6bL3tPFoTo5C7YS4pbm922tWZubY0Fd7kMyCiE1CEKQmumdfWkvK2gOqntrZakvM7/azdTC/TcMp816dHP1w3reWpLQH1DG189GWWN/tmetmvUKZ6Sv0w6kvLZlnh1QlH4/6UhWNts3pck8yJbjA4CRg69V+G9OqLei8WtX2s0m3bz/LDeX6/jHae/+4JbWuYv84pf0Bd5HLBJTj9sHM8Szbxsz2LAQQhNgjaG4DyKljCiWPuibwLIW3slzhMGod1YrZ77oqEvbV+3aOHu+88KngUjkrQxLGJaO4lG/bprX+9egHu9B9rxgYZq9AZgDW2Stom5E2pmH9i5dpO6v6lAWNNDKLZxZv0cnLUAwh/urbMsoH1ckNdz8X995mx5/LR6GfpnJZn2OAMjhsU6zcZcmuMp3lzpe79PI9d8XKU3xWHkMyvep5mKa8a4ve2rRZ0XBlhtCkaEp2WjrtvSB/vawVy3UzGbuaF4PVYsUlZskxn6DSuFi1il68fP5LHLE0fmv1ht2F6/iSR74Yer/y6M//Bw==</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70102 ForNAV VAT Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ dobropis;
               DAN=Kûbskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kjûpskreditnota;
               SVE=Ink”pskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota cr‚dito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de cr‚dit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70104 ForNAV VAT Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ popt vka;
               DAN=Kûbsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei÷ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Forespûrsel;
               SVE=Ink”psoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70150 ForNAV Tax Purchase Order
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ objedn vka;
               DAN=Kûbsordre;
               DEU=Einkaufsbestellung;
               ENU=Purchase Order;
               FIN=Ostotilaus;
               FRA=Commande achat;
               ISL=Innkaupap”ntun;
               ITA=Ordine acquisto;
               NLD=Inkooporder;
               NOR=Bestilling;
               SVE=Ink”psorder;
               DES=Einkaufsbestellung;
               ENG=Purchase Order;
               ESM=Pedido compra;
               FRB=Commande achat;
               ITS=Ordine acquisto;
               NLB=Inkooporder;
               DEA=Einkaufsbestellung;
               ENA=Purchase Order;
               ESN=Pedido compra;
               FRC=Bon de commande;
               ENC=Purchase Order;
               FRS=Commande achat;
               ENZ=Purchase Order];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(Document Type,No.)
                                 WHERE(Document Type=CONST(Order));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70151 ForNAV Tax Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ faktura;
               DAN=Kûbsfaktura;
               DEU=Einkaufsrechnung;
               ENU=Purchase Invoice;
               FIN=Ostolasku;
               FRA=Facture achat;
               ISL=Innkaupareikningur;
               ITA=Fattura acquisto;
               NLD=Inkoopfactuur;
               NOR=Kjûpsfaktura;
               SVE=Ink”psfaktura;
               DES=Einkaufsrechnung;
               ENG=Purchase Invoice;
               ESM=Factura compra;
               FRB=Facture achat;
               ITS=Fattura acquisto;
               NLB=Inkoopfactuur;
               DEA=Einkaufsrechnung;
               ENA=Purchase Invoice;
               ESN=Factura compra;
               FRC=Facture achat;
               ENC=Purchase Invoice;
               FRS=Facture achat;
               ENZ=Purchase Invoice];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70152 ForNAV Tax Purchase Cr. Memo
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ dobropis;
               DAN=Kûbskreditnota;
               DEU=Einkaufsgutschrift;
               ENU=Purchase Credit Memo;
               FIN=Ostohyvityslasku;
               FRA=Avoir achat;
               ISL=Innkaupakreditreikningur;
               ITA=Nota credito acquisto;
               NLD=Inkoopcreditnota;
               NOR=Kjûpskreditnota;
               SVE=Ink”pskreditnota;
               DES=Einkaufsgutschrift;
               ENG=Purchase Credit Memo;
               ESM=Nota cr‚dito compra;
               FRB=Avoir achat;
               ITS=Nota credito acquisto;
               NLB=Inkoopcreditnota;
               DEA=Einkaufsgutschrift;
               ENA=Purchase CR/Adj Note;
               ESN=Abono compra;
               FRC=Note de cr‚dit d'achat;
               ENC=Purchase Credit Memo;
               FRS=Avoir achat;
               ENZ=Purchase Credit Memo];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table124;
               DataItemTableView=SORTING(No.);
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table125;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>1nkAAO1d627cuBX+X6DvoE6BOkFnxyR1I3c9XfgS7xpNbDd2skWLwtBoOLY2Gmmq0SRxL0Cfpg/WJylJURpdqBlqLo4Xu1lsYksidXi+Q/Kcj+TR0befp6HxkSbzII6GPTgAPYNGfjwOovthb5FOvsK9b//w618d/TlNvLd0Fifp/LX3GC/SG5oEXhj8gybG8sf3RUXWAA1sXlvlUs+49KZ02JM1ncfJpfexZ5zGUZrE4e3jjN07ox9ffZ4ldD4flF46eHdR+hX1jZbHPvLX9PO3GkMjl6RvnC7CdJFQdi2iC1Yk7BvXi1EY+H+kj7fxB8qfHru+hylGwJ1Y1AJM/rNgPgu9x0xuLvDxe+PW+8yKJv6DN6fGaTIw3tBp3DMqrSrabQ4A+w9agLX+avQj9dPLeNhzAbTZhfOAhuMf6Iip8GPg03dJOOw9pOns68PDMZ1/SOPZV97D9GOQgq9dYOHDs8fImwb+nEkBITi8OvNSr2dce/f0exrcP6TDHiIuyK78EIzTB3YB8ma88ZL7IJozcQBTBeR/IfkXk4Lpf9g75ij2DTJL+wZrWnJD0yFXwCxgldhW3r53UcAevqVR+jC/mhy/CcIwmNKUJqx50XVCs6feeHN26cZPglmq1tstnc7CQY8Zl2EcnXjReC5+ZL9cpHQKpaV8T70xr7piIpmGedv5o7wsMyz6iTf6miZvqR8n42EvTRaUFfRCX2iZtf14Gi+i1LiI/HDBLdx4f3zbzy72jNs49cL8SQf0Hdgzvkvixaxyw2QKke997yVVGfMbt94oZJfFPxBZtRvvA/pp2Lu5ent7cfndi8t48JJr9u/nQcgUlr+GXe5fx/OUC8lK83bEs4CyO5BBcsFah3ipOU15oy8X0xFN8hYLFPJX5gj0pHJrui7p+y2diOYpNJ01UOpZNPks9hdTZgJF0wsjOfH8D6dxGDNxTphJCgSim4ckiD4MexMvnLMr1+w3ZiGfryKfA8abUL13Fb1iY9JjdiNrlTQo1n1Er2q3qH5dtuMwjD9leniVJHEyz6u8Ce4jjw8Jw94IQuRMrDExbUodCKjl+74HoeeNfQSQO/aJh6wxU4+UQK2GrBOeD3vYZJ0eANgr6ZlpWup2XrlaRcBSInBLP6cn8edepVfcnS1oZhw3bPBlbzWxeCuyrL5NBoT9YbW9jn2PS3wexh4zBGhCcQvjvuG42Y/5CHBD72NqvLvoG3iW8osJzaEMGaxlmLlAxyFTIG/+sPcmGI9D+pa3nmkhTv4h7rGBPrvCnx72/vef/xYSc/tkA4yw93KbBvkTNRUxJd2kjyFl5hEnQfqYKcvuGe/mNBNe2o/4vZB7ebEmsLxxWEfiUEChwgdlr3R08DldJEk2Dt7dpKzbeMn41JtxFOZ3rCM/FoixKabvgAZIbGC2HdACSxUEodaszqZOl3IM6nIMRBktLbtNLav1hlR6M7NKcAe7Fi14HccfFrP53bX3yCG7pcl0fkbnoh+zBpSNnqlQ9DaEoMLeEdOmawpLd23n6Wy9VfBW2y+3e9BWXAsysp+OYaoAtrJX8olpe4SleS7RRQJa4EAJMnCaEAOwhJgoAe4bc66k4UkcjteD3YCvkKo7dHlRLdgg1MRNDY+lgseWVaOu8BQjVmOaKWPSgsbKqWUDNNZPHBWZu00j0NxK7bZK7Y6sust8XlO7dC7qul+h9GxqJ+bOOkFVBl3dlwvpAaA7kasBcFQAuLJqrQlbCcBVwq5dxut0v4exp3izpsbz5/WUrZjPOyjbVSkby6o7z/KFslko9pbeB3MWmAv/Wkftux5kFDJoAtAsqQeF7jythgKroCBZ1Wjj6fg9jcZxopiI21DY7aij1C+bUe/SOJOsAyy1YlqYoO3mYKKM7YCsu/MkLBgI4SKxhhyPx5zwqkQPSEzGJsJN15cTPSIOdBysxqaT33sbz17TSSoovVT6vOxaxQfOHmgCmTVjUGvGahSVZfQg1J3Pu8aFQAmujNyR1lR/Gk9nXvR4EU3iZCrQqgDdEWJoAhn67BxrGc6sALse8KzAtdnqCsbd0N1X1K8M+6GM+1HXwL8+gAoXrSXWB+pYv9vQ2QhRs87Y0jtL1ICU1Pi9cfC1ccD+kb1QPdDqFdRDUtcT6YqkkoiAkolAaiflOvA5F7i6q8qHWvzvClsuYXfZjbxn2nhzMiF/MatWrM38JY6nF1PvXumWK7pbXoEeMKS7zpXcAJTkgKnljZR6z7VomdQhUvccaIMVnWdPnE6LwpedQjyipWVT19PoCoWSB4CSCDC7+CB1vyuflWwlIIJqW+MO7h4WOehou4ibOIXmvjwKJXcAJXlgdiYPVO6iVYZtBXGToffkSwJdgq4NwyxzXx6DkniAknkwOzMPKvTwEj0r61jtRKgk5iA2+4Zr5Vg/HZTraYtORIW5L/dASWFAyWGYXTgMNUfXYRnOhl9gxNQn9rpTeeaelh5glew4OlSspTZX78ord5baBzmP47S6uJ1dWb2ofc1woBfRSZym8TRfUG5bu1613t1cHddf6c4FLS1kO96YAA97jumPTTAikxGABDimR/yRO6GuCTBg8aRTW8jOayoWsJENNli7hrsY8ZxlyCScZ0sZM+mtjjZ6xin7WTR02TXyS28WYRq8DqICtqyz/FXlTD/EEb2MDeM3Q+PgwPjWaItvl0yULMFCJSOLlVZV+7URLcKwb/zut5/PvmF/HX+jePrV3RsvCPVFkM+vlEA+I9+/8vXfx1PKLbmDEooiK2UontLSQsMl0BenWTSXSy1Y83ktCS9Oji/1hRJPr9SPeELrzTc/XJzfnsbjLhgty6wUYvlYJsnfBktJJmIr04vJIhIjjPHioxe+NP6ZUDZERQb75Zt/vxz8GAfRiwPjX8bBS9X880uv+6XX/dLr9trrtNw5CynduV3tprLUGw434sxR1W9QU63MGWo6Ds6Sar1IvTDwt3EjMq/hO5q+pvdeyBo3DgTGL15+oxro1A/qYWNtjQ3SdapR3ak2JTbcYdLYnpv/du0lTCq+gTXfM1nZXsuJx8b+2uwV6t219srdtXn4YvD9tLwaI9tvmxdhlz4wVVImk6/YyPtauOXlSobnF69en8ldu7wVZs1Lrm+ubbjIalLgJB4/lkMQLuucX1wThewpsCi9vhRbQOqOEKS+OZrYEwJ9H5rWxMM+QN4Ij8Zj4k+cCfLqsUWpsiK8cIDCxFsijIYK3YqWBOw1pf75rby6ZkBAA9M0oWs7TpW8V0jAZHgbf1LJ1pAPV+RjpdTSiRtLdH+QG/jBwHZcAiAyLfmDWpxMZTRU6kspF1HLwesoS3wnGJxCLmWUVfAI/NmS5MTByLVch8WYxETYVo14/B1ibanLohWzZjbafyps+eYh/nS1SGeLVFbIxtErMZm+98IFfXHAm3jw0hgOjRX6EypS7SsGW4yslcqVM2ADITkb2vX4uQ2h6nZSTagqhXLM0MDGDrKRCaGDicuHpxbEKsVrcHRXsMKtWK/H+rJeQ49yhc+uexVtevzTwotSJpS+EpclmlZvmZaDIXEZiiehF334C03inEtoUeqyum483tb638Z1aAJTX/trACOXAW1bExh+yCievKHeXCx66qJTK1aHyAamw36ALrRaEalV8cSwODuFpb4O2IBFLgnariYs/K+zYO7zE1PXfqoPTKNgs/eYDsa2bXH6Xbf3NGrdCq3KnFIctMscWfbywffePH/ZcCjk6o4v3im+9cXDBr5yHdHWnfm58Z/G8w7ALks0EXVdQKBN3A6ILqt72o7n7HbCr68LNoCRS4SO7oSfH1LUhSV/PgcFDiAxHdsGGFkIAEgcfUyKA5JPi8g2xEMTkfqSX/n+Kid6lQN3dNgSEbQVUsbX8pZYfWDR3WIaSQWYGx1PU28ZaJ7gFLHJ7o9vdowxcwFKUaY/8ghBYEQRtCYEEM8HFHs+tiw0cYkHJ747nqCxq4oyG+cw+dnnjQNNx1YoSzvcFMeuletWJW3HfD18znQt1hG3izsdRyHuDqJP43iRxuf80PfqSa9TMOrouhzVUwKX8V2b4dZUuX4/pTKGdQYYWIgAl9iOaRKLb+JoLAy2DJRVSlcR4WaiNTZR5xKvC3q7j6Fqd6NQ1dNFto6uB1I7ArWMOdtw14dZHf+SgYVtZGPsWCYbdvjW8c3wrlT/hYF31e7MDoHXDcVdXQ+nCnweF2+PejNgz7u4SSAbo5G5MeKtwXuGa3MDvQLvpbeUT7J52ootLUDtPu3QAnRjfleXjKlaAI8ErvI4fHszaGEGcltwoM3+R4AfyNrMGFbzBs/BItSUzw4tQpducHVZoKpF1KL9dpuob5bTt5JWmiK3ExtD5paaFl8W3cxO1nEWG1nKE9MYrpqmUu7x26F96dId7ma+Zc497MOwmjRJYVHAcizXta2NHc1WzuQ5DDpqD3TflqLLv7ibuaUZI1K2ky0nKAWqMlcV3w7yonS0qpJngp86oZH/mG8ceXlQYnzMgQMwG6/YH4wgwhvb16aS7Hpg62x8eO9e8JOySi2NzA4RlXib9paqGtSZq9JI9dNywijxonmTiCpd/jKbHSoClIgoDxKH2GSCKIE28swJINh2TTTyEDaJhSzLdRw6JjUiqlLdkojaZscDNhXKer5EFLYU4j5XIgpv5oxexncthrsd7wSBaTm2C+2NA5FnwDthtX/4BXgnvJkrWOadtoZ5Je/kuNjF2DX50YmfPu+E90446vJOeDPPruCdtkb9J8M7bQU42buLpUszkc2Ixgptsz3qujTTM2KZtsN/7zSjLqlENqMZ66RSqwU8Aalk/5w5JaKmJ58Lp0Q2cxMLTmkPdvVz5ZTIl2EfdTkloutyXsbgeVFFJmbmQyyxOehnRhWRvTuuz4AqImQ/VFE15BJ0g86ZLubDRgs6vpMMar7NLM/5Q7JEJC5Wpv6xSnnP1mTP0jzStT5nQrEJb+U+OW04IFDn/9G3sPaQqBwKQaCV8acBSCOBmTrpD0Q2WA8CH8L6hhoKmcJcvr57HvO8YAfNK9L5tCu4GYKsIUdXp8luSerDHYRmLorS5S/IjioSTYwotC0EHR+PTUrpCGObQBdgSC3XoSaFGBOLukp2tJFtgrDO7FjI3ZwihaDuoG1xktTSs/mflMUrnKZtxvi6k7OFts1l4pyWPG8WWKvt5zvIb7vlv22QXzMGrcwFD+rsWFsqHLGs+SWHn4oApeEHAzB27DFBjk0oYUMHha5pOiMMHMf0KEHWaGTbzki1S7iZ7AbYIleWCbcYgPj3D7KX3Dx4M6qec8Wt6vKMrTymXk0lyUtl1XDLzc5Dy+R3xe83aUJT/yH314+je35MmiiWnTJb5XXmokP5jvJ56y1GB71vDTRzpTq63p+Z3XadvoEskTsL8U1Fa0MoxSjc3t9l8NK5x6u+JrCF96b3BYGmMvHaYbWkRSy0yBdutT45U1FN8Tmt98e3X1WVtk6rK4p20Lciu18XZ67mn+l9MKCpb3etvrOvrm1przeLkciY0NVpKMp1UKzGh3+WilURtZVJR+/jAE3FEj3FQqsYxNcrtnFaoK7pVaoUeuxOcnTDa7OXdABXnadPnwdQMaeVL5/ofYFAz0cEXQaz3VpCMUeUB6tOI1sHVFo+PqCPioqlrHwORe8TBHqowDIqecrL1g7acY5hemcOYftEsrLzFAU7qL7TtN2k89b449XucnTY+ApjY3aSs5L0Kb2Qpzr5fLKYTLS+h9mecKeRX6detyrTjgtEUuAVuXaYOqde8mj8kT7K3DiwJ7z4OGGXVXt21ibLEel9NLLlVBvw5dLmFHLUM+dc0k+1QEQlcin5piIFTfOEKOTfJNA5Itpmbcspu/7EUfYexWdCs4GNyq62XCCMmS4o/yJvrqHTB+p/KPLHytXB8krhi8wgc2MB+R/l2LosVm4y73NlOcuNLzfpKPsmbO0Ls/LbXzxui7O9wG2D3/KdlTiHTzDZx3yF2HkqVd56Jv5iViuWe/Q8A3teDFaLFanABE8WVl5+dLhsxdHhig8y/+H/</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70154 ForNAV Tax Purchase Quote
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:40 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=N kupn¡ popt vka;
               DAN=Kûbsrekvisition;
               DEU=Einkaufsanfrage;
               ENU=Purchase Quote;
               FIN=Ostotarjous;
               FRA=Demande de prix;
               ISL=Innkaupabei÷ni;
               ITA=Offerta acquisto;
               NLD=Inkoopofferte;
               NOR=Forespûrsel;
               SVE=Ink”psoffert;
               DES=Einkaufsofferte;
               ENG=Purchase Quote;
               ESM=Cotizaci¢n compra;
               FRB=Demande de prix;
               ITS=Offerta acquisto;
               NLB=Inkoopofferte;
               DEA=Einkaufsanfrage;
               ENA=Purchase Quote;
               ESN=Oferta compra;
               FRC=Devis d'achat;
               ENC=Purchase Quote;
               FRS=Demande de prix;
               ENZ=Purchase Quote];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table38;
               DataItemTableView=SORTING(No.)
                                 WHERE(Document Type=CONST(Quote));
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                  UpdateNoPrinted;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.),
                            Document Type=FIELD(Document Type) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE UpdateNoPrinted@1000000005();
    VAR
      ForNAVUpdateNoPrinted@1000000000 : Codeunit 70003;
    BEGIN
      ForNAVUpdateNoPrinted.UpdateNoPrinted(Header, CurrReport.PREVIEW);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70201 ForNAV Customer Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 3:20:33 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=NejlepÊ¡ch 10 z kazn¡ku;
               DAN=Debitor - top 10-liste;
               DEU=Top 10 Liste (Debitoren);
               ENU=Customer Top 10 List;
               FIN=Asiakkaat - 10 p„„asiakasta;
               FRA=Clients - PalmarŠs;
               ISL=Vi÷skiptama÷ur - 10 efstu;
               ITA=Lista primi 10 clienti;
               NLD=Klanten - Top 10;
               NOR=Kunde - ti p† topp-liste;
               RUS=à‰Š†¡• - ‹†÷ƒ…˜ „†¤˜•ˆ…;
               SVE=Kunder, 10 i topp;
               DES=Top 10 Liste (Debitoren);
               ENG=Customer Top 10 List;
               FRB=Clients - PalmarŠs;
               ITS=Lista primi 10 clienti;
               NLB=Klanten - Top 10;
               DEA=Top 10 Liste (Debitoren);
               ENA=Customer Top 10 List;
               ESN=Los 10 mejores clientes;
               FRS=Clients - PalmarŠs;
               ENZ=Customer Top 10 List];
    OnInitReport=BEGIN
                                                                                                                              ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Customer Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Quantity;
                  ToolTipML=ENU=Specifies the number of customers that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70202 ForNAV Vendor Top 10 List
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 5:42:25 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Dodavatel - nejlepÊ¡ch 10;
               DAN=Kreditor - top 10-liste;
               DEU=H„ndler Top-10-Liste;
               ENU=Vendor Top 10 List;
               FIN=10 p„„toimittajaa;
               FRA=PalmarŠs fournisseurs;
               ISL=10 efstu l nardrottnar;
               ITA=Lista primi 10 fornitori;
               NLD=Lijst top 10 leveranciers;
               NOR=Leverandûr - topp 10-liste;
               RUS=çŒ¤•…ƒ—ŠˆŠ - ‹†÷ƒ…˜ „†¤˜•ˆ…;
               SVE=10 i topp leverant”rer;
               DES=H„ndler Top-10-Liste;
               ENG=Vendor Top 10 List;
               FRB=PalmarŠs fournisseurs;
               ITS=Lista primi 10 fornitori;
               NLB=Lijst top 10 leveranciers;
               DEA=H„ndler Top-10-Liste;
               ENA=Vendor Top 10 List;
               ESN=Listado 10 mejores proveedores;
               FRS=PalmarŠs fournisseurs;
               ENZ=Vendor Top 10 List];
    OnInitReport=BEGIN
                                                                                                                              ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table23;
               DataItemTableView=SORTING(Net Change (LCY))
                                 ORDER(Descending);
               OnAfterGetRecord=BEGIN
                                  i += 1;
                                  IF i = NoOfRecordsToPrint THEN
                                    CurrReport.BREAK;
                                END;

               ReqFilterFields=No.,Name,Vendor Posting Group,Country/Region Code,Date Filter;
               CalcFields=Balance (LCY),Net Change (LCY) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Quantity;
                  ToolTipML=ENU=Specifies the number of customers that will be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      NoOfRecordsToPrint@1000 : Integer;
      i@1001 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:41 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Predvaha;
               DAN=Balance;
               DEU=Rohbilanz;
               ENU=Trial Balance;
               FIN=Alustava saldo;
               FRA=Balance;
               ISL=Pr¢fj”fnu÷ur;
               ITA=Bilancio di verifica;
               NLD=Proefbalans;
               NOR=R†balanse;
               RUS=ç÷Œ ¡–‚  …‰…¡¤;
               SVE=R†balans;
               DES=Bilanz;
               ENG=Trial Balance;
               FRB=Balance;
               ITS=Bilancio di verifica;
               NLB=Proefbalans;
               DEA=Rohbilanz;
               ENA=Trial Balance;
               ESN=Balance comprobaci¢n;
               FRS=Balance;
               ENZ=Trial Balance];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  CASE NumColumns OF
                    0:
                      ERROR(Text000);
                    1,2:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"9-Point"
                      ELSE
                        LineType := LineType::"9-Point Rounded";
                    3:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"8-Point"
                      ELSE
                        LineType := LineType::"9-Point Rounded";
                    4:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"8-Point"
                      ELSE
                        LineType := LineType::"8-Point Rounded";
                    5,6:
                      IF RoundTo = RoundTo::Pennies THEN
                        LineType := LineType::"7-Point"
                      ELSE
                        LineType := LineType::"7-Point Rounded";
                    7,8:
                      IF (RoundTo = RoundTo::Pennies) THEN
                        ERROR(Text001)
                      ELSE
                        LineType := LineType::"7-Point Rounded";
                    ELSE
                      ERROR(Text002);
                  END;
                  CASE LineType OF
                    LineType::"9-Point",LineType::"9-Point Rounded":
                      BEGIN
                        MaxDescWidth := 67;
                        PointSize := 9;
                      END;
                    LineType::"8-Point",LineType::"8-Point Rounded":
                      BEGIN
                        MaxDescWidth := 52;
                        PointSize := 8;
                      END;
                    LineType::"7-Point",LineType::"7-Point Rounded":
                      BEGIN
                        MaxDescWidth := 33;
                        PointSize := 7;
                      END;
                    ELSE
                      ERROR(Text003);
                  END;
                  FromDate := "G/L Account".GETRANGEMIN("Date Filter");
                  ToDate := "G/L Account".GETRANGEMAX("Date Filter");
                  PriorFromDate := CALCDATE('<-1Y>',FromDate + 1) - 1;
                  PriorToDate := CALCDATE('<-1Y>',ToDate + 1) - 1;
                  "G/L Account".SETRANGE("Date Filter");
                  CLEAR(PeriodText);
                  CLEAR(ColumnHead);
                  IF ColumnFlags[7] THEN BEGIN
                    PeriodText := 'As of ' + FORMAT(ToDate,0,4);
                    IF ColumnFlags[9] THEN BEGIN
                      IF Show = Show::Budget THEN
                        PeriodText := 'Actual vs Budget a' + DELSTR(PeriodText,1,1)
                      ELSE
                        PeriodText := PeriodText + ' and ' + FORMAT(DATE2DMY(PriorToDate,3));
                    END;
                  END ELSE
                    IF ColumnFlags[9] THEN BEGIN
                      IF Show = Show::Budget THEN
                        PeriodText := 'Budget as of ' + FORMAT(ToDate,0,4)
                      ELSE
                        PeriodText := 'As of ' + FORMAT(PriorToDate,0,4);
                    END ELSE
                      IF ColumnFlags[1] THEN BEGIN
                        PeriodText := 'Changes ';
                        IF ColumnFlags[3] AND (Show = Show::Budget) THEN
                          PeriodText := PeriodText + 'and Budgeted Changes ';
                        PeriodText := PeriodText + 'from '
                          + FORMAT(FromDate,0,4)
                          + ' to '
                          + FORMAT(ToDate,0,4);
                        IF ColumnFlags[3] AND (Show = Show::"Last Year") THEN
                          PeriodText := PeriodText + ' and from '
                            + FORMAT(PriorFromDate,0,4)
                            + ' to '
                            + FORMAT(PriorToDate,0,4);
                      END ELSE
                        IF ColumnFlags[3] THEN BEGIN
                          IF Show = Show::Budget THEN
                            PeriodText := 'Budgeted '
                          ELSE
                            PeriodText := '';
                          PeriodText := PeriodText + 'Changes from ';
                          IF Show = Show::Budget THEN
                            PeriodText := PeriodText + FORMAT(FromDate,0,4)
                              + ' to '
                              + FORMAT(ToDate,0,4)
                          ELSE
                            PeriodText := PeriodText + FORMAT(PriorFromDate,0,4)
                              + ' to '
                              + FORMAT(PriorToDate,0,4);
                        END;
                  IF UseAddRptCurr THEN BEGIN
                    GLSetup.GET;
                    Currency.GET(GLSetup."Additional Reporting Currency");
                    SubTitle := STRSUBSTNO(Text004,Currency.Description);
                  END;
                  { Column Headings }
                  IF Show = Show::Budget THEN
                    ColumnHead[3] := Text005
                  ELSE
                    ColumnHead[3] := Text006;
                  ColumnHead[9] := ColumnHead[3];
                  ColumnHead[5] := Text007;
                  ColumnHead[6] := Text008;
                  ColumnHead[11] := Text009;
                  ColumnHead[12] := Text010;
                  ColumnHead[1] := Text011;
                  ColumnHead[7] := Text012;
                  ColumnHead[3] := ColumnHead[3] + Text011;
                  ColumnHead[9] := ColumnHead[9] + Text012;
                  IF RoundTo = RoundTo::Thousands THEN
                    FOR i := 1 TO 12 DO
                      IF i MOD 2 = 1 THEN
                        ColumnHead[i] := ColumnHead[i] + Text013;
                  CompressColumns(ColumnHead);
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 6710;    ;DataItem;                    ;
               DataItemTable=Table15;
               DataItemTableView=SORTING(No.);
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               IF ISEMPTY THEN
                                 ERROR(MissingGLAccountErr);
                             END;

               OnAfterGetRecord=BEGIN
                                  CLEAR(DescriptionLine2);
                                  CLEAR(DescriptionLine1);
                                  CLEAR(WorkAmount);
                                  IF ("Account Type" = "Account Type"::Posting) OR
                                     (Totaling <> '')
                                  THEN BEGIN
                                    SETRANGE("Date Filter",FromDate,ToDate);
                                    IF UseAddRptCurr THEN BEGIN
                                      CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
                                      WorkAmount[1] := "Additional-Currency Net Change";
                                      WorkAmount[7] := "Add.-Currency Balance at Date";
                                    END ELSE BEGIN
                                      CALCFIELDS("Net Change","Balance at Date");
                                      WorkAmount[1] := "Net Change";
                                      WorkAmount[7] := "Balance at Date";
                                    END;
                                    IF Show = Show::Budget THEN BEGIN
                                      CALCFIELDS("Budgeted Amount","Budget at Date");
                                      WorkAmount[3] := "Budgeted Amount";
                                      WorkAmount[9] := "Budget at Date";
                                    END ELSE BEGIN
                                      SETRANGE("Date Filter",PriorFromDate,PriorToDate);
                                      IF UseAddRptCurr THEN BEGIN
                                        CALCFIELDS("Additional-Currency Net Change","Add.-Currency Balance at Date");
                                        WorkAmount[3] := "Additional-Currency Net Change";
                                        WorkAmount[9] := "Add.-Currency Balance at Date";
                                      END ELSE BEGIN
                                        CALCFIELDS("Net Change","Balance at Date");
                                        WorkAmount[3] := "Net Change";
                                        WorkAmount[9] := "Balance at Date";
                                      END;
                                    END;
                                    IF ColumnFlags[5] OR ColumnFlags[6] THEN
                                      WorkAmount[5] := WorkAmount[1] - WorkAmount[3];
                                    IF ColumnFlags[6] AND (WorkAmount[3] <> 0.0) THEN
                                      WorkAmount[6] := WorkAmount[5] / WorkAmount[3] * 100.0;
                                    IF ColumnFlags[11] OR ColumnFlags[12] THEN
                                      WorkAmount[11] := WorkAmount[7] - WorkAmount[9];
                                    IF ColumnFlags[12] AND (WorkAmount[9] <> 0.0) THEN
                                      WorkAmount[12] := WorkAmount[11] / WorkAmount[9] * 100.0;
                                  END;
                                  DescriptionLine2 := PADSTR('',Indentation) + Name;
                                  ForNAVTrialBalanceParagrHandl.SplitPrintLine(DescriptionLine2,DescriptionLine1,MaxDescWidth,PointSize);
                                  IF NumbersToPrint THEN BEGIN
                                    FOR i := 1 TO 12 DO BEGIN
                                      IF RoundTo = RoundTo::Dollars THEN
                                        WorkAmount[i] := ROUND(WorkAmount[i],1)
                                      ELSE
                                        IF RoundTo = RoundTo::Thousands THEN BEGIN
                                          IF i MOD 2 = 0 THEN
                                            WorkAmount[i] := ROUND(WorkAmount[i],1)
                                          ELSE
                                            WorkAmount[i] := ROUND(WorkAmount[i] / 1000,1);
                                        END ELSE
                                          WorkAmount[i] := ROUND(WorkAmount[i],0.01);
                                    END;
                                    { now format the strings }
                                    FOR i := 1 TO 12 DO BEGIN
                                      PrintAmount[i] := FORMAT(WorkAmount[i]);
                                      IF RoundTo = RoundTo::Pennies THEN BEGIN
                                        j := STRPOS(PrintAmount[i],'.');
                                        IF j = 0 THEN
                                          PrintAmount[i] := PrintAmount[i] + '.00'
                                        ELSE
                                          IF j = STRLEN(PrintAmount[i]) - 1 THEN
                                            PrintAmount[i] := PrintAmount[i] + '0';
                                      END;
                                      IF i MOD 2 = 0 THEN
                                        PrintAmount[i] := PrintAmount[i] + '%';
                                    END;
                                    CompressColumns(PrintAmount);
                                  END;
                                END;

               ReqFilterFields=No.,Account Type,Date Filter,Global Dimension 1 Filter,Global Dimension 2 Filter,Budget Filter }

    { 1008;1   ;Column  ;PeriodText          ;
               IncludeCaption=No;
               SourceExpr=PeriodText }

    { 1020003;1;Column  ;UseAddRptCurr       ;
               IncludeCaption=No;
               SourceExpr=UseAddRptCurr }

    { 1020004;1;Column  ;PageGroupNo         ;
               IncludeCaption=No;
               SourceExpr=PageGroupNo }

    { 1   ;1   ;Column  ;AddCurrSubTitle     ;
               IncludeCaption=No;
               SourceExpr=SubTitle }

    { 1000000000;1;Column;LineType           ;
               IncludeCaption=No;
               SourceExpr=LineType }

    { 12  ;1   ;Column  ;ColumnHead1         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[1] }

    { 13  ;1   ;Column  ;ColumnHead2         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[2] }

    { 43  ;1   ;Column  ;ColumnHead3         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[3] }

    { 88  ;1   ;Column  ;ColumnHead4         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[4] }

    { 196 ;1   ;Column  ;ColumnHead5         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[5] }

    { 197 ;1   ;Column  ;ColumnHead6         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[6] }

    { 204 ;1   ;Column  ;ColumnHead7         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[7] }

    { 205 ;1   ;Column  ;ColumnHead8         ;
               IncludeCaption=No;
               SourceExpr=ColumnHead[8] }

    { 8412;1   ;DataItem;BlankLineCounter    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               SETRANGE(Number,1,"G/L Account"."No. of Blank Lines");
                             END;
                              }

    { 5444;1   ;DataItem;                    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnPostDataItem=BEGIN
                                IF "G/L Account"."New Page" THEN
                                  PageGroupNo := PageGroupNo + 1;
                              END;
                               }

    { 1000000001;2;Column;NumbersToPrint     ;
               IncludeCaption=No;
               SourceExpr=NumbersToPrint }

    { 14  ;2   ;Column  ;DescriptionLine1    ;
               IncludeCaption=No;
               SourceExpr=DescriptionLine1 }

    { 15  ;2   ;Column  ;DescriptionLine2    ;
               IncludeCaption=No;
               SourceExpr=DescriptionLine2 }

    { 8   ;2   ;Column  ;PrintAmt1           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[1] }

    { 9   ;2   ;Column  ;PrintAmt2           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[2] }

    { 28  ;2   ;Column  ;PrintAmt3           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[3] }

    { 55  ;2   ;Column  ;PrintAmt4           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[4] }

    { 105 ;2   ;Column  ;PrintAmt5           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[5] }

    { 106 ;2   ;Column  ;PrintAmt6           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[6] }

    { 114 ;2   ;Column  ;PrintAmt7           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[7] }

    { 115 ;2   ;Column  ;PrintAmt8           ;
               IncludeCaption=No;
               SourceExpr=PrintAmount[8] }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1020001;0;Container ;
                  ContainerType=ContentArea }

      { 1020000;1;Group     ;
                  CaptionML=ENU=Options }

      { 4   ;2   ;Field     ;
                  Name=ShowComaprison;
                  CaptionML=ENU=Show Comparison;
                  ToolTipML=ENU=Specifies if figures either from the prior year or for the defined budget are included.;
                  OptionCaptionML=ENU=Last Year,Budget;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Show }

      { 19  ;2   ;Group     ;
                  CaptionML=ENU=Select Report Columns }

      { 8   ;3   ;Field     ;
                  Name=ActualChange;
                  CaptionML=ENU=Actual Changes;
                  ToolTipML=ENU=Specifies that a column is added that shows the actual net change.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[1];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 9   ;3   ;Field     ;
                  Name=ComparisonChanges;
                  CaptionML=ENU=Comparison Changes;
                  ToolTipML=ENU=Specifies if you want to include the net changes from the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[3];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 10  ;3   ;Field     ;
                  CaptionML=ENU=Variance in Changes;
                  ToolTipML=ENU=Specifies if you want to include a column that shows the change variance. The variance is calculated by subtracting the budget or prior year amounts over the period defined from the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[5];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 14  ;3   ;Field     ;
                  CaptionML=ENU=% Variance in Changes;
                  ToolTipML=ENU=Specifies that a column is inserted that shows the percentage of variance in balances. The variance is calculated by dividing the variance by the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[6];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 16  ;3   ;Field     ;
                  Name=ActualBalances;
                  CaptionML=ENU=Actual Balances;
                  ToolTipML=ENU=Specifies that a column is added that shows the actual balance.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[7];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 17  ;3   ;Field     ;
                  Name=ComparisonBalances;
                  CaptionML=ENU=Comparison Balances;
                  ToolTipML=ENU=Specifies if you want to include the balance from the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[9];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 18  ;3   ;Field     ;
                  CaptionML=ENU=Variance in Balances;
                  ToolTipML=ENU=Specifies if you want to include a column that shows the balance variance. The variance is calculated by subtracting the budget or prior year amounts over the period defined from the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[11];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 22  ;3   ;Field     ;
                  CaptionML=ENU=% Variance in Balances;
                  ToolTipML=ENU=Specifies that a column is inserted that shows the percentage of variance in balances. The variance is calculated by dividing the variance by the actual amounts.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ColumnFlags[12];
                  OnValidate=BEGIN
                               TestNumColumns;
                             END;
                              }

      { 24  ;2   ;Field     ;
                  CaptionML=ENU=Round to;
                  ToolTipML=ENU=Specifies if you want the results in the report to be rounded to the nearest penny (hundredth of a unit), dollar (unit), or thousand dollars (units). The results are in US dollars, unless you use an additional reporting currency.;
                  OptionCaptionML=ENU=Pennies,Dollars,Thousands;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=RoundTo;
                  OnValidate=BEGIN
                               IF RoundTo = RoundTo::Thousands THEN
                                 ThousandsRoundToOnValidate;
                               IF RoundTo = RoundTo::Dollars THEN
                                 DollarsRoundToOnValidate;
                               IF RoundTo = RoundTo::Pennies THEN
                                 PenniesRoundToOnValidate;
                             END;
                              }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Skip Accounts with all zero Amounts;
                  ToolTipML=ENU=Specifies if you want the report to be generated with all of the accounts, including those with zero amounts. Otherwise, those accounts will be excluded.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=SkipZeros;
                  MultiLine=Yes }

      { 2   ;2   ;Field     ;
                  Name=UseAdditionalReportingCurrency;
                  CaptionML=ENU=Use Additional Reporting Currency;
                  ToolTipML=ENU=Specifies if you want all amounts to be printed by using the additional reporting currency. If you do not select the check box, then all amounts will be printed in US dollars.;
                  ApplicationArea=#Suite;
                  SourceExpr=UseAddRptCurr;
                  MultiLine=Yes }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      GLSetup@1001 : Record 98;
      Currency@1002 : Record 4;
      ForNAVTrialBalanceParagrHandl@1003 : Codeunit 70206;
      PeriodText@1004 : Text[120];
      SubTitle@1006 : Text[132];
      SkipZeros@1007 : Boolean;
      UseAddRptCurr@1008 : Boolean;
      Show@1009 : 'Last Year,Budget';
      RoundTo@1010 : 'Pennies,Dollars,Thousands';
      LineType@1011 : '9-Point,9-Point Rounded,8-Point,8-Point Rounded,7-Point,7-Point Rounded';
      ColumnFlags@1012 : ARRAY [12] OF Boolean;
      ColumnHead@1013 : ARRAY [12] OF Text[50];
      PrintAmount@1014 : ARRAY [12] OF Text[30];
      WorkAmount@1015 : ARRAY [12] OF Decimal;
      FromDate@1016 : Date;
      ToDate@1017 : Date;
      PriorFromDate@1018 : Date;
      PriorToDate@1019 : Date;
      DescriptionLine2@1020 : Text[80];
      DescriptionLine1@1021 : Text[80];
      MaxDescWidth@1023 : Integer;
      PointSize@1024 : Integer;
      j@1025 : Integer;
      i@1026 : Integer;
      Text000@1027 : TextConst 'ENU=You must select at least one Report Column.';
      Text001@1028 : TextConst 'ENU=If you want more than 6 Report Columns you must round to Dollars or Thousands.';
      Text002@1029 : TextConst 'ENU=You may select a maximum of 8 Report Columns.';
      Text003@1030 : TextConst 'ENU=Wrong columns layout. Contact you system administrator or contact support service for further assistance.';
      Text004@1031 : TextConst 'ENU=Amounts are in %1';
      Text005@1032 : TextConst 'ENU="Budgeted, "';
      Text006@1033 : TextConst 'ENU="Last Year, "';
      Text007@1034 : TextConst 'ENU=Change Variance';
      Text008@1035 : TextConst 'ENU=Change % Variance';
      Text009@1036 : TextConst 'ENU=Balance Variance';
      Text010@1037 : TextConst 'ENU=Balance % Variance';
      Text011@1038 : TextConst 'ENU=Net Change';
      Text012@1039 : TextConst 'ENU=Balance';
      Text013@1040 : TextConst 'ENU=" (Thousands)"';
      Text101@1480019 : TextConst 'ENU=Data';
      Text102@1480018 : TextConst 'ENU=Trial Balance';
      Text103@1480017 : TextConst 'ENU=Company Name';
      Text104@1480016 : TextConst 'ENU=Report No.';
      Text105@1480015 : TextConst 'ENU=Report Name';
      Text106@1480014 : TextConst 'ENU=User ID';
      Text107@1480013 : TextConst 'ENU=Date / Time';
      Text108@1480012 : TextConst 'ENU=G/L Account Filters';
      Text109@1480011 : TextConst 'ENU=Sub-Title';
      Text110@1480010 : TextConst 'ENU=Amounts are in';
      Text111@1480009 : TextConst 'ENU=our Functional Currency';
      PageGroupNo@1020001 : Integer;
      MissingGLAccountErr@1020000 : TextConst 'ENU=No G/L account exists within the specified filter.';
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    PROCEDURE NumColumns@7() NumCol@1000 : Integer;
    VAR
      i@1001 : Integer;
    BEGIN
      NumCol := 0;
      FOR i := 1 TO ARRAYLEN(ColumnFlags) DO
        IF ColumnFlags[i] THEN
          NumCol := NumCol + 1;
      EXIT(NumCol);
    END;

    PROCEDURE TestNumColumns@14();
    BEGIN
      IF NumColumns > 8 THEN
        ERROR(Text002);
      IF (NumColumns > 6) AND (RoundTo = RoundTo::Pennies) THEN
        ERROR(Text001);
    END;

    PROCEDURE NumbersToPrint@12() : Boolean;
    VAR
      i@1000 : Integer;
    BEGIN
      IF ("G/L Account"."Account Type" <> "G/L Account"."Account Type"::Posting) AND
         ("G/L Account".Totaling = '')
      THEN
        EXIT(FALSE);
      IF ("G/L Account"."Account Type" = "G/L Account"."Account Type"::Posting) AND SkipZeros THEN BEGIN
        FOR i := 1 TO ARRAYLEN(ColumnFlags) DO
          IF (WorkAmount[i] <> 0.0) AND ColumnFlags[i] THEN
            EXIT(TRUE);
        EXIT(FALSE);
      END;
      EXIT(TRUE);
    END;

    PROCEDURE CompressColumns@8(VAR StringArray@1000 : ARRAY [12] OF Text[30]);
    VAR
      i@1001 : Integer;
      j@1002 : Integer;
    BEGIN
      j := 0;
      FOR i := 1 TO ARRAYLEN(ColumnFlags) DO
        IF ColumnFlags[i] THEN BEGIN
          j := j + 1;
          StringArray[j] := StringArray[i];
        END;
      FOR i := j + 1 TO ARRAYLEN(ColumnFlags) DO
        StringArray[i] := '';
    END;

    LOCAL PROCEDURE PenniesRoundToOnValidate@19010648();
    BEGIN
      TestNumColumns;
    END;

    LOCAL PROCEDURE DollarsRoundToOnValidate@19009557();
    BEGIN
      TestNumColumns;
    END;

    LOCAL PROCEDURE ThousandsRoundToOnValidate@19005369();
    BEGIN
      TestNumColumns;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      This report is based on 10022 Trial Balance.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70210 ForNAV Cust. Payments Applied
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:41 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=Customer Payments Applied;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  SalespersonFilterString := CustLedgerEntry.GETFILTER("Salesperson Code");
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 8503;    ;DataItem;CustLedgerEntry     ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Document Type,Posting Date)
                                 WHERE(Document Type=FILTER(Payment|Credit Memo));
               OnPreDataItem=BEGIN
                               SETRANGE("Salesperson Code");
                             END;

               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Amount (LCY)");
                                  GetAppliedCustEntries(CustLedgerEntry,TRUE);
                                END;

               ReqFilterFields=Posting Date,Global Dimension 1 Code,Global Dimension 2 Code,Salesperson Code,Customer No.;
               CalcFields=Remaining Amt. (LCY),Amount (LCY) }

    { 1000000000;1;DataItem;TempAppliedCustLedgEntry;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               SETFILTER("Salesperson Code", SalespersonFilterString);
                             END;

               OnAfterGetRecord=BEGIN
                                  CALCFIELDS("Remaining Amt. (LCY)", "Amount (LCY)");
                                END;

               CalcFields=Original Amt. (LCY),Amount (LCY);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 1000000002;PaymentLbl    ;CaptionML=ENU=Payment }
    { 1000000003;AppliedToLbl  ;CaptionML=ENU=Applied-to Document }
    { 1000000004;DiscountDateLbl;
                                CaptionML=ENU=Discount Date }
    { 1000000005;PaymentAmtLbl ;CaptionML=ENU=Payment Amount }
    { 1000000006;DiscountTakenLbl;
                                CaptionML=ENU=Discount Taken }
    { 1000000007;AmtAppliedLbl ;CaptionML=ENU=Amount Applied }
    { 1000000008;AmtNotAppliedLbl;
                                CaptionML=ENU=Amount Not Yet Applied }
    { 1000000009;CustomerNameLbl;
                                CaptionML=ENU=Customer Name }
  }
  CODE
  {
    VAR
      SalespersonFilterString@1480002 : Text;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    PROCEDURE GetAppliedCustEntries@1020000(CustLedgEntry@1020001 : Record 21;UseLCY@1480000 : Boolean);
    VAR
      DtldCustLedgEntry@1020003 : Record 379;
      PmtDtldCustLedgEntry@1020004 : Record 379;
      PmtCustLedgEntry@1020015 : Record 21;
      ClosingCustLedgEntry@1020002 : Record 21;
      AmountToApply@1020005 : Decimal;
      AppliedDtldCustLedgEntry@1000000001 : Record 379;
    BEGIN
      TempAppliedCustLedgEntry.RESET;
      TempAppliedCustLedgEntry.DELETEALL;
      DtldCustLedgEntry.SETCURRENTKEY("Cust. Ledger Entry No.");
      DtldCustLedgEntry.SETRANGE("Cust. Ledger Entry No.",CustLedgEntry."Entry No.");
      DtldCustLedgEntry.SETRANGE(Unapplied,FALSE);
      IF DtldCustLedgEntry.FIND('-') THEN
        REPEAT
          IF DtldCustLedgEntry."Cust. Ledger Entry No." = DtldCustLedgEntry."Applied Cust. Ledger Entry No." THEN BEGIN
            AppliedDtldCustLedgEntry.INIT;
            AppliedDtldCustLedgEntry.SETCURRENTKEY("Applied Cust. Ledger Entry No.","Entry Type");
            AppliedDtldCustLedgEntry.SETRANGE("Applied Cust. Ledger Entry No.",DtldCustLedgEntry."Applied Cust. Ledger Entry No.");
            AppliedDtldCustLedgEntry.SETRANGE("Entry Type",AppliedDtldCustLedgEntry."Entry Type"::Application);
            AppliedDtldCustLedgEntry.SETRANGE(Unapplied,FALSE);
            IF AppliedDtldCustLedgEntry.FIND('-') THEN
              REPEAT
                IF AppliedDtldCustLedgEntry."Cust. Ledger Entry No." <> AppliedDtldCustLedgEntry."Applied Cust. Ledger Entry No."
                THEN BEGIN
                  IF ClosingCustLedgEntry.GET(AppliedDtldCustLedgEntry."Cust. Ledger Entry No.") THEN BEGIN
                    TempAppliedCustLedgEntry := ClosingCustLedgEntry;
                    IF UseLCY THEN
                      TempAppliedCustLedgEntry."Amount to Apply" := -AppliedDtldCustLedgEntry."Amount (LCY)"
                    ELSE
                      TempAppliedCustLedgEntry."Amount to Apply" := -AppliedDtldCustLedgEntry.Amount;
                    IF TempAppliedCustLedgEntry.INSERT THEN ;
                  END;
                END;
              UNTIL AppliedDtldCustLedgEntry.NEXT = 0;
          END ELSE BEGIN
            IF ClosingCustLedgEntry.GET(DtldCustLedgEntry."Applied Cust. Ledger Entry No.") THEN BEGIN
              TempAppliedCustLedgEntry := ClosingCustLedgEntry;
              IF UseLCY THEN
                TempAppliedCustLedgEntry."Amount to Apply" := DtldCustLedgEntry."Amount (LCY)"
              ELSE
                TempAppliedCustLedgEntry."Amount to Apply" := DtldCustLedgEntry.Amount;
              IF TempAppliedCustLedgEntry.INSERT THEN ;
            END;
          END;
        UNTIL DtldCustLedgEntry.NEXT = 0;
      IF CustLedgEntry."Closed by Entry No." <> 0 THEN BEGIN
        IF ClosingCustLedgEntry.GET(CustLedgEntry."Closed by Entry No.") THEN BEGIN
          TempAppliedCustLedgEntry := ClosingCustLedgEntry;
          IF UseLCY THEN
            TempAppliedCustLedgEntry."Amount to Apply" := -CustLedgEntry."Closed by Amount (LCY)"
          ELSE
            TempAppliedCustLedgEntry."Amount to Apply" := -CustLedgEntry."Closed by Amount";
          IF TempAppliedCustLedgEntry.INSERT THEN ;
        END;
      END;
      ClosingCustLedgEntry.RESET;
      ClosingCustLedgEntry.SETCURRENTKEY("Closed by Entry No.");
      ClosingCustLedgEntry.SETRANGE("Closed by Entry No.",CustLedgEntry."Entry No.");
      IF ClosingCustLedgEntry.FIND('-') THEN
        REPEAT
          TempAppliedCustLedgEntry := ClosingCustLedgEntry;
          IF UseLCY THEN
            TempAppliedCustLedgEntry."Amount to Apply" := ClosingCustLedgEntry."Closed by Amount (LCY)"
          ELSE
            TempAppliedCustLedgEntry."Amount to Apply" := ClosingCustLedgEntry."Closed by Amount";
          IF TempAppliedCustLedgEntry.INSERT THEN ;
        UNTIL ClosingCustLedgEntry.NEXT = 0;
      IF TempAppliedCustLedgEntry.ISEMPTY THEN BEGIN
        TempAppliedCustLedgEntry.INIT;
        TempAppliedCustLedgEntry."Entry No." := 0;
        TempAppliedCustLedgEntry."Salesperson Code" := CustLedgEntry."Salesperson Code";
        TempAppliedCustLedgEntry.INSERT;
      //  ApplicationExist := FALSE;
      END;
      // ELSE
      //  ApplicationExist := TRUE;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'CustLedgerEntry': WITH CustLedgerEntry DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Remaining Amt. (LCY)");
              END;
           'Restore': BEGIN
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Remaining Amt. (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70215 ForNAV Salesperson-Commission
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:41 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Provize prodejce;
               DAN=Salgsprovision;
               DEU=Verk„ufer - Provision;
               ENU=Salesperson Commission;
               FIN=Myyj„n provisio;
               FRA=Commission vendeurs;
               ISL=S”lumenn - S”lulaun;
               ITA=Commissioni agente;
               NLD=Verkoper - Provisie;
               NOR=Selgerprovisjon;
               RUS=àŒŠ¤¤ŠŒ¡¡–† †¡†„‘†÷… ‹Œ ‹÷Œ„…‘…;
               SVE=S„ljarprovision;
               DES=Verk„ufer - Provision;
               ENG=Salesperson Commission;
               ESM=Vendedor: comisi¢n;
               FRB=Commission vendeurs;
               ITS=Commissioni agente;
               NLB=Verkoper - Provisie;
               DEA=Verk„ufer - Provision;
               ENA=Salesperson Commission;
               ESN=Vendedor: comisi¢n;
               FRC=Commission du repr‚sentant;
               ENC=Salesperson Commission;
               FRS=Commission vendeurs;
               ENZ=Salesperson Commission];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 3065;    ;DataItem;                    ;
               DataItemTable=Table13;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('Salesperson_Purchaser').NewPagePerRecord := PrintOnlyOnePerPage;
                             END;

               ReqFilterFields=Code }

    { 25  ;1   ;Column  ;SalesCommissionAmt  ;
               IncludeCaption=No;
               SourceExpr=SalesCommissionAmt;
               AutoFormatType=1 }

    { 26  ;1   ;Column  ;ProfitCommissionAmt ;
               IncludeCaption=No;
               SourceExpr=ProfitCommissionAmt;
               AutoFormatType=1 }

    { 1   ;1   ;Column  ;PrintOnlyOnePerPage ;
               IncludeCaption=No;
               SourceExpr=PrintOnlyOnePerPage }

    { 8503;1   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Salesperson Code,Posting Date)
                                 WHERE(Document Type=FILTER(Invoice|Credit Memo));
               OnAfterGetRecord=VAR
                                  CostCalcMgt@1000 : Codeunit 5836;
                                BEGIN
                                  SalesCommissionAmt := ROUND("Sales (LCY)" * "Salesperson/Purchaser"."Commission %" / 100);
                                  ProfitCommissionAmt := ROUND("Profit (LCY)" * "Salesperson/Purchaser"."Commission %" / 100);
                                END;

               ReqFilterFields=Posting Date;
               DataItemLink=Salesperson Code=FIELD(Code) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=New Page per Person;
                  ToolTipML=ENU=Specifies if each person's information is printed on a new page if you have chosen two or more persons to be included in the report.;
                  ApplicationArea=#Suite;
                  SourceExpr=PrintOnlyOnePerPage }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ProfitCommissionAmt@1004 : Decimal;
      SalesCommissionAmt@1005 : Decimal;
      PrintOnlyOnePerPage@1006 : Boolean;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Salesperson_Purchaser': WITH "Salesperson/Purchaser" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Cust. Ledger Entry"."Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Cust. Ledger Entry"."Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,2,ProfitCommissionAmt);
                ReportForNav.AddTotal(DataItemId,3,SalesCommissionAmt);
              END;
           'Restore': BEGIN
                 "Cust. Ledger Entry"."Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Cust. Ledger Entry"."Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 ProfitCommissionAmt := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 SalesCommissionAmt := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;  'CustLedgerEntry': WITH "Cust. Ledger Entry" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,1,"Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,2,"Sales (LCY)");
                ReportForNav.AddTotal(DataItemId,3,"Profit (LCY)");
                ReportForNav.AddTotal(DataItemId,4,ProfitCommissionAmt);
                ReportForNav.AddTotal(DataItemId,5,SalesCommissionAmt);
              END;
           'Restore': BEGIN
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Sales (LCY)" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Profit (LCY)" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 ProfitCommissionAmt := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 SalesCommissionAmt := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70220 ForNAV Aged Accounts Receivbl.
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:41 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Splatn‚ pohled vky;
               DAN=Aldersfordelte tilgodehavender;
               DEU=Debitor - Saldenrckblick;
               ENU=Aged Accounts Receivables;
               FIN=Myyntisaatavien tilanne;
               FRA=Comptabilit‚ client ƒg‚e;
               ISL=Aldursgreindar kr”fur;
               ITA=Scadenziario clienti;
               NLD=Vervallen vorderingen;
               NOR=Aldersford. saldoliste - kunde;
               RUS=Ž† Š•Œ÷¤ˆ…˜ ‡…„Œ‰‘†¡¡Œ¤• ‹Œ ¤÷Œˆ… „…ƒ¡Œ¤•Š;
               SVE=Kundfordringar - †lder;
               DES=Debitor - Saldenrckblick;
               ENG=Aged Accounts Receivable;
               ESM=Antigedad cobros;
               FRB=Comptabilit‚ client ƒg‚e;
               ITS=Scadenziario clienti;
               NLB=Vervallen vorderingen;
               DEA=Debitor - Saldenrckblick;
               ENA=Aged Accounts Receivable;
               ESN=Antigedad cobros;
               FRC=Comptes clients class‚s chronologiquement;
               ENC=Aged Accounts Receivable;
               FRS=Comptabilit‚ client ƒg‚e;
               ENZ=Aged Accounts Receivable];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70219;
               DataItemTableView=SORTING(Print Amount In Cust. Curr.);
               OnPreDataItem=BEGIN
                               Args.INSERT;
                               Args.CalcDates;
                             END;

               Temporary=Yes }

    { 6836;1   ;DataItem;Account             ;
               DataItemTable=Table18;
               OnAfterGetRecord=BEGIN
                                  AgingCalculation.GetAgingWithCurrency(Account, AgingBuffer, CurrencyTotalsBuffer, Args, TempCurrency);
                                  IF AgingBuffer.ISEMPTY THEN
                                    CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 70220;2  ;DataItem;AgingBuffer         ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPage;
                 END;

    }
    CONTROLS
    {
      { 4   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=AgedAsOf;
                  CaptionML=ENU=Aged As Of;
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 3   ;2   ;Field     ;
                  Name=Agingby;
                  CaptionML=ENU=Aging by;
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  OptionCaptionML=ENU=Due Date,Posting Date,Document Date;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Aging By" }

      { 7   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=ENU=Period Length;
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 9   ;2   ;Field     ;
                  Name=AmountsinLCY;
                  CaptionML=ENU=Print Amounts in Customer's Currency;
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Amount In Cust. Curr." }

      { 11  ;2   ;Field     ;
                  Name=PrintDetails;
                  CaptionML=ENU=Print Details;
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Details" }

      { 15  ;2   ;Field     ;
                  Name=HeadingType;
                  CaptionML=ENU=Heading Type;
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  OptionCaptionML=ENU=Date Interval,Number of Days;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Heading Type" }

      { 13  ;2   ;Field     ;
                  Name=perCustomer;
                  CaptionML=ENU=New Page per Customer;
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."New Page Per Customer" }

      { 1000000000;2;Field  ;
                  CaptionML=ENU=Show Customer's Contact Information;
                  ToolTipML=ENU=Specifies if you want to have customer's contact information next to customer name.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Show Cust. Contact Info" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      TempCurrency@1000000001 : TEMPORARY Record 4;
      AgingCalculation@1000000007 : Codeunit 70219;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPostSectionAccountsReceivblBuffer_ColumnsHeading@5010(VAR AccountsReceivblBuffer@1000000000 : Record 70220);
    BEGIN
      WITH AccountsReceivblBuffer DO BEGIN
      END;// Autogenerated by ForNav;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE InitRequestPage@1000000001();
    VAR
      Blank@1000000000 : DateFormula;
    BEGIN
      WITH Args DO BEGIN
        IF "Ending Date" = 0D THEN
          "Ending Date" := WORKDATE;
        "No. of Columns" := 5;
        IF "Period Length" = Blank THEN
          EVALUATE("Period Length", '<1M>');
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'AgingBuffer': WITH AgingBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,Balance);
                ReportForNav.AddTotal(DataItemId,2,"Amount 1");
                ReportForNav.AddTotal(DataItemId,3,"Amount 2");
                ReportForNav.AddTotal(DataItemId,4,"Amount 3");
                ReportForNav.AddTotal(DataItemId,5,"Amount 4");
                ReportForNav.AddTotal(DataItemId,6,"Amount 5");
                ReportForNav.AddTotal(DataItemId,7,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,9,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,11,"Amount 5 (LCY)");
                ReportForNav.AddTotal(DataItemId,12,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,13,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,14,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,15,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,16,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,17,"Amount 5 (LCY)");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,14,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,15,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,16,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,17,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>+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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70221 ForNAV Aged Accounts Payables
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:41 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Splatn‚ pohled vky;
               DAN=Aldersfordelte tilgodehavender;
               DEU=Debitor - Saldenrckblick;
               ENU=Aged Accounts Payables;
               FIN=Myyntisaatavien tilanne;
               FRA=Comptabilit‚ client ƒg‚e;
               ISL=Aldursgreindar kr”fur;
               ITA=Scadenziario clienti;
               NLD=Vervallen vorderingen;
               NOR=Aldersford. saldoliste - kunde;
               RUS=Ž† Š•Œ÷¤ˆ…˜ ‡…„Œ‰‘†¡¡Œ¤• ‹Œ ¤÷Œˆ… „…ƒ¡Œ¤•Š;
               SVE=Kundfordringar - †lder;
               DES=Debitor - Saldenrckblick;
               ENG=Aged Accounts Receivable;
               ESM=Antigedad cobros;
               FRB=Comptabilit‚ client ƒg‚e;
               ITS=Scadenziario clienti;
               NLB=Vervallen vorderingen;
               DEA=Debitor - Saldenrckblick;
               ENA=Aged Accounts Receivable;
               ESN=Antigedad cobros;
               FRC=Comptes clients class‚s chronologiquement;
               ENC=Aged Accounts Receivable;
               FRS=Comptabilit‚ client ƒg‚e;
               ENZ=Aged Accounts Receivable];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   LoadWatermark;
                 END;

    OnPreReport=VAR
                  CaptionManagement@1000 : Codeunit 42;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70219;
               DataItemTableView=SORTING(Print Amount In Cust. Curr.);
               OnPreDataItem=BEGIN
                               Args.INSERT;
                               Args.CalcDates;
                             END;

               Temporary=Yes }

    { 6836;1   ;DataItem;Account             ;
               DataItemTable=Table23;
               OnAfterGetRecord=BEGIN
                                  AgingCalculation.GetAgingWithCurrency(Account, AgingBuffer, CurrencyTotalsBuffer, Args, TempCurrency);
                                  IF AgingBuffer.ISEMPTY THEN
                                    CurrReport.SKIP;
                                END;

               ReqFilterFields=No. }

    { 70220;2  ;DataItem;AgingBuffer         ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

    { 1000000000;1;DataItem;CurrencyTotalsBuffer;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Currency Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPage;
                 END;

    }
    CONTROLS
    {
      { 4   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=AgedAsOf;
                  CaptionML=ENU=Aged As Of;
                  ToolTipML=ENU=Specifies the date that you want the aging calculated for.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 3   ;2   ;Field     ;
                  Name=Agingby;
                  CaptionML=ENU=Aging by;
                  ToolTipML=ENU=Specifies if the aging will be calculated from the due date, the posting date, or the document date.;
                  OptionCaptionML=ENU=Due Date,Posting Date,Document Date;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Aging By" }

      { 7   ;2   ;Field     ;
                  Name=PeriodLength;
                  CaptionML=ENU=Period Length;
                  ToolTipML=ENU=Specifies the length of each period, for example, enter "1M" for one month.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 9   ;2   ;Field     ;
                  Name=AmountsinLCY;
                  CaptionML=ENU=Print Amounts in Customer's Currency;
                  ToolTipML=ENU=Specifies if you want the report in customer's currencies. Report totals calculated in LCY.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Amount In Cust. Curr." }

      { 11  ;2   ;Field     ;
                  Name=PrintDetails;
                  CaptionML=ENU=Print Details;
                  ToolTipML=ENU=Specifies if you want the report to show the detailed entries that add up the total balance for each customer.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Details" }

      { 15  ;2   ;Field     ;
                  Name=HeadingType;
                  CaptionML=ENU=Heading Type;
                  ToolTipML=ENU=Specifies if the column heading for the report periods will indicate a date interval or the number of days overdue.;
                  OptionCaptionML=ENU=Date Interval,Number of Days;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Heading Type" }

      { 13  ;2   ;Field     ;
                  Name=perCustomer;
                  CaptionML=ENU=New Page per Customer;
                  ToolTipML=ENU=Specifies if each customer's information is printed on a new page if you have chosen two or more customers to be included in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."New Page Per Customer" }

      { 1000000000;2;Field  ;
                  CaptionML=ENU=Show Customer's Contact Information;
                  ToolTipML=ENU=Specifies if you want to have customer's contact information next to customer name.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Show Cust. Contact Info" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
    { 747 ;AgedOverdueAmounts  ;CaptionML=ENU=Aged Overdue Amounts }
    { 742 ;AmnsInLCY           ;CaptionML=ENU=All Amounts in LCY. }
  }
  CODE
  {
    VAR
      TempCurrency@1000000001 : TEMPORARY Record 4;
      AgingCalculation@1000000007 : Codeunit 70219;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPostSectionAccountsReceivblBuffer_ColumnsHeading@5010(VAR AccountsReceivblBuffer@1000000000 : Record 70220);
    BEGIN
      WITH AccountsReceivblBuffer DO BEGIN
      END;// Autogenerated by ForNav;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    LOCAL PROCEDURE InitRequestPage@1000000001();
    VAR
      Blank@1000000000 : DateFormula;
    BEGIN
      WITH Args DO BEGIN
        IF "Ending Date" = 0D THEN
          "Ending Date" := WORKDATE;
        "No. of Columns" := 5;
        IF "Period Length" = Blank THEN
          EVALUATE("Period Length", '<1M>');
      END;
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'AgingBuffer': WITH AgingBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,Balance);
                ReportForNav.AddTotal(DataItemId,2,"Amount 1");
                ReportForNav.AddTotal(DataItemId,3,"Amount 2");
                ReportForNav.AddTotal(DataItemId,4,"Amount 3");
                ReportForNav.AddTotal(DataItemId,5,"Amount 4");
                ReportForNav.AddTotal(DataItemId,6,"Amount 5");
                ReportForNav.AddTotal(DataItemId,7,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,8,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,9,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,10,"Amount 4 (LCY)");
                ReportForNav.AddTotal(DataItemId,11,"Amount 5 (LCY)");
                ReportForNav.AddTotal(DataItemId,12,"Balance (LCY)");
                ReportForNav.AddTotal(DataItemId,13,"Amount 1 (LCY)");
                ReportForNav.AddTotal(DataItemId,14,"Amount 2 (LCY)");
                ReportForNav.AddTotal(DataItemId,15,"Amount 3 (LCY)");
                ReportForNav.AddTotal(DataItemId,16,"Amount (LCY)");
                ReportForNav.AddTotal(DataItemId,17,"Amount 5 (LCY)");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 Balance := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,7,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,8,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,9,GroupTotalFieldNo);
                 "Amount 4 (LCY)" := ReportForNav.RestoreTotal(DataItemId,10,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,11,GroupTotalFieldNo);
                 "Balance (LCY)" := ReportForNav.RestoreTotal(DataItemId,12,GroupTotalFieldNo);
                 "Amount 1 (LCY)" := ReportForNav.RestoreTotal(DataItemId,13,GroupTotalFieldNo);
                 "Amount 2 (LCY)" := ReportForNav.RestoreTotal(DataItemId,14,GroupTotalFieldNo);
                 "Amount 3 (LCY)" := ReportForNav.RestoreTotal(DataItemId,15,GroupTotalFieldNo);
                 "Amount (LCY)" := ReportForNav.RestoreTotal(DataItemId,16,GroupTotalFieldNo);
                 "Amount 5 (LCY)" := ReportForNav.RestoreTotal(DataItemId,17,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70248 ForNAV Cust./Item Statistics
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=[CSY=Statistika z kazn¡k/zboÎ¡;
               DAN=Kunde/Varestatistik;
               DEU=Debitor/Artikelstatistik;
               ENU=Customer/Item Statistics;
               FIN=Asiakas/Nimikkeen tilastot;
               FRA=Statistiques client/article;
               ISL=Vi÷skiptama÷ur/Birg÷aupplüsingar;
               ITA=Statistiche cliente/articolo;
               NLD=Klant/Artikelstatistiek;
               NOR=Kunde/Varestatistikk;
               SVE=Kunde/Artikelstatistik;
               ESN=Estad¡sticas cliente/producto];
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   LoadWatermark;
                 END;

    OnPreReport=BEGIN
                  CompanyInformation.GET;
                  FilterString := Customer.GETFILTERS;
                  FilterString2 := "Value Entry".GETFILTERS;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 6836;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnPreDataItem=BEGIN
                               ReportForNav.GetDataItem('Customer').NewPagePerRecord := OnlyOnePerPage;
                             END;

               ReqFilterFields=No.,Search Name,Customer Posting Group }

    { 1   ;1   ;Column  ;Profit              ;
               IncludeCaption=No;
               SourceExpr=Profit }

    { 1000000000;1;Column;OnlyOnePerPage     ;
               IncludeCaption=No;
               SourceExpr=OnlyOnePerPage }

    { 1000000001;1;Column;ShowCustContactInfo;
               IncludeCaption=No;
               SourceExpr=ShowCustContactInfo }

    { 8894;1   ;DataItem;                    ;
               DataItemTable=Table5802;
               DataItemTableView=SORTING(Source Type,Source No.,Item Ledger Entry Type,Item No.,Posting Date)
                                 WHERE(Source Type=CONST(Customer),
                                       Item Ledger Entry Type=CONST(Sale),
                                       Expected Cost=CONST(No));
               OnPreDataItem=BEGIN
                               CLEAR(ValueEntryTotalForItem);
                               ProfitTotalForItem := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF ValueEntryTotalForItem."Item No." <> "Item No." THEN BEGIN
                                    "CalculateProfit%";
                                    CLEAR(ValueEntryTotalForItem);
                                    ProfitTotalForItem := 0;
                                    IF NOT Item.GET("Item No.") THEN BEGIN
                                      Item.Description := Text000;
                                      Item."Base Unit of Measure" := '';
                                    END;
                                  END;
                                  Profit := "Sales Amount (Actual)" + "Cost Amount (Actual)";
                                  "Discount Amount" := -"Discount Amount";
                                  ValueEntryTotalForItem."Item No." := "Item No.";
                                  ValueEntryTotalForItem."Invoiced Quantity" += "Invoiced Quantity";
                                  ValueEntryTotalForItem."Sales Amount (Actual)" += "Sales Amount (Actual)";
                                  ValueEntryTotalForItem."Discount Amount" += "Discount Amount";
                                  ProfitTotalForItem += Profit;
                                END;

               ReqFilterFields=Item No.,Inventory Posting Group,Posting Date;
               DataItemLink=Source No.=FIELD(No.),
                            Global Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Code=FIELD(Global Dimension 2 Filter) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1000000000;2;Field  ;
                  Name=DisplayCustContacts;
                  CaptionML=ENU=Show Customer Contact Information;
                  ToolTipML=ENU=Specifies, if you want to have contact infomation near the customer name.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=ShowCustContactInfo }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=New Page per Account;
                  ToolTipML=ENU=Specifies if you want to print each account on a separate page. Each account will begin at the top of the following page. Otherwise, each account will follow the previous account on the current page.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=OnlyOnePerPage }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Item@1000000003 : Record 27;
      CompanyInformation@1000000002 : Record 79;
      ValueEntryTotalForItem@1000000001 : Record 5802;
      FilterString@1000 : Text;
      FilterString2@1001 : Text;
      Profit@1003 : Decimal;
      "Profit%"@1004 : Decimal;
      ProfitTotalForItem@1000000004 : Decimal;
      OnlyOnePerPage@1005 : Boolean;
      PrintToExcel@1000000000 : Boolean;
      Text000@1480002 : TextConst 'ENU=Invalid Item';
      Text001@1480013 : TextConst 'ENU=Data';
      Text002@1480012 : TextConst 'ENU=Customer/Item Statistics';
      Text003@1480011 : TextConst 'ENU=Company Name';
      Text004@1480010 : TextConst 'ENU=Report No.';
      Text005@1480009 : TextConst 'ENU=Report Name';
      Text006@1480008 : TextConst 'ENU=User ID';
      Text007@1480007 : TextConst 'ENU=Date / Time';
      Text008@1480006 : TextConst 'ENU=Customer Filters';
      Text009@1480005 : TextConst 'ENU=Value Entry Filters';
      Text010@1480004 : TextConst 'ENU=Contribution Margin';
      Text011@1480003 : TextConst 'ENU=Contribution Ratio';
      ShowCustContactInfo@1000000005 : Boolean;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    PROCEDURE "CalculateProfit%"@1();
    BEGIN
      IF ValueEntryTotalForItem."Sales Amount (Actual)" <> 0 THEN
        "Profit%" := ROUND(100 * ProfitTotalForItem / ValueEntryTotalForItem."Sales Amount (Actual)",0.1)
      ELSE
        "Profit%" := 0;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000000();
    VAR
      ForNAVSetup@1000000001 : Record 70000;
      OutStream@1000000000 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("List Report Watermark");
        IF NOT "List Report Watermark".HASVALUE THEN
          EXIT;
        "List Report Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Customer': WITH Customer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Value Entry"."Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,1,Profit);
                ReportForNav.AddTotal(DataItemId,2,"Value Entry"."Discount Amount");
              END;
           'Restore': BEGIN
                 "Value Entry"."Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 Profit := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Value Entry"."Discount Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
              END;
        END;  'ValueEntry': WITH "Value Entry" DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,1,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,2,"Discount Amount");
                ReportForNav.AddTotal(DataItemId,3,"Invoiced Quantity");
                ReportForNav.AddTotal(DataItemId,4,"Sales Amount (Actual)");
                ReportForNav.AddTotal(DataItemId,5,Profit);
                ReportForNav.AddTotal(DataItemId,6,"Discount Amount");
              END;
           'Restore': BEGIN
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Invoiced Quantity" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Sales Amount (Actual)" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
                 Profit := ReportForNav.RestoreTotal(DataItemId,5,GroupTotalFieldNo);
                 "Discount Amount" := ReportForNav.RestoreTotal(DataItemId,6,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70250 ForNAV Statement
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=Statement;
    OnInitReport=BEGIN
                   GLSetup.GET;
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000001;;DataItem;Args              ;
               DataItemTable=Table70250;
               DataItemTableView=SORTING(Start Date) }

    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  ProcessCustomer;
                                  UpdateAging;
                                END;

               ReqFilterFields=No.;
               CalcFields=Balance }

    { 6523;1   ;DataItem;CurrencyLoop        ;
               DataItemTable=Table4;
               DataItemTableView=SORTING(Code);
               PrintOnlyIfDetail=Yes;
               OnAfterGetRecord=BEGIN
                                  Customer.SETRANGE("Date Filter",0D, Args."Start Date" - 1);
                                  Customer.SETRANGE("Currency Filter",CurrencyLoop.Code);
                                  Customer.CALCFIELDS("Net Change");
                                END;

               OnPostDataItem=BEGIN
                                Customer.SETRANGE("Currency Filter");
                              END;

               Temporary=Yes }

    { 3   ;2   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Posting Date,Currency Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Customer No.", Customer."No.");
                               SETRANGE("Posting Date", Args."Start Date", Args."Ending Date");
                               SETRANGE("Currency Code",CurrencyLoop.Code);
                               SETRANGE("Date Filter", Args."Start Date", Args."Ending Date");
                             END;

               CalcFields=Remaining Amount,Original Amount }

    { 9065;2   ;DataItem;OverdueEntry        ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Customer No.,Open,Positive,Due Date);
               OnPreDataItem=BEGIN
                               SETRANGE("Customer No.", Customer."No.");
                               IF NOT Args."Include Aging Band" THEN
                                 SETRANGE("Due Date", 0D, Args."Ending Date"- 1);
                               SETRANGE("Currency Code", CurrencyLoop.Code);
                               IF (NOT Args."Print Entries Due") AND (NOT Args."Include Aging Band") THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF Args."Include Aging Band" THEN BEGIN
                                    IF ("Posting Date" > Args."Ending Date") AND ("Due Date" >= Args."Ending Date") THEN
                                      CurrReport.SKIP;
                                    IF Args."Date Choice" = Args."Date Choice"::"Due Date" THEN
                                      IF "Due Date" >= Args."Ending Date" THEN
                                        CurrReport.SKIP;
                                  END;

                                  CALCFIELDS("Remaining Amount");
                                  IF "Remaining Amount" = 0 THEN
                                    CurrReport.SKIP;

                                  IF "Due Date" >= Args."Ending Date" THEN
                                    CurrReport.SKIP;
                                END;

               CalcFields=Original Amount,Remaining Amount;
               DataItemLinkReference=Customer;
               DataItemLink=Customer No.=FIELD(No.) }

    { 1000000000;1;DataItem;AgingBuffer      ;
               DataItemTable=Table70220;
               DataItemTableView=SORTING(Entry No.);
               DataItemLink=Account No.=FIELD(No.);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   InitRequestPageDataInternal
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             PLK=Opcje;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1000000001;2;Field  ;
                  Name=DocumentDate;
                  CaptionML=ENU=Document Date;
                  SourceExpr=Args."Document Date" }

      { 1000000000;2;Field  ;
                  Name=StartDate;
                  CaptionML=ENU=Start Date;
                  SourceExpr=Args."Start Date" }

      { 17  ;2   ;Field     ;
                  Name=EndDate;
                  CaptionML=ENU=End Date;
                  ToolTipML=ENU=Specifies the date to which the report or batch job processes information.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Ending Date" }

      { 16  ;2   ;Field     ;
                  Name=ShowOverdueEntries;
                  CaptionML=ENU=Show Overdue Entries;
                  ToolTipML=ENU=Specifies if you want overdue entries to be shown separately for each currency.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Entries Due" }

      { 15  ;2   ;Group     ;
                  Name=Include;
                  CaptionML=ENU=Include;
                  GroupType=Group }

      { 14  ;3   ;Field     ;
                  Name=IncludeAllCustomerswithLE;
                  CaptionML=ENU=Include All Customers with Ledger Entries;
                  ToolTipML=ENU=Specifies if you want entries displayed for customers that have ledger entries at the end of the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print All Having Balance";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               IF NOT Args."Print All Having Entries" THEN
                                 Args."Print All Having Balance" := TRUE;
                             END;
                              }

      { 13  ;3   ;Field     ;
                  Name=IncludeAllCustomerswithBalance;
                  CaptionML=ENU=Include All Customers with a Balance;
                  ToolTipML=ENU=Specifies if you want entries displayed for customers that have a balance at the end of the selected period.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print All Having Entries";
                  MultiLine=Yes;
                  OnValidate=BEGIN
                               IF NOT Args."Print All Having Balance" THEN
                                 Args."Print All Having Entries" := TRUE;
                             END;
                              }

      { 12  ;3   ;Field     ;
                  Name=IncludeReversedEntries;
                  CaptionML=ENU=Include Reversed Entries;
                  ToolTipML=ENU=Specifies if you want to include reversed entries in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Reversed Entries" }

      { 11  ;3   ;Field     ;
                  Name=IncludeUnappliedEntries;
                  CaptionML=ENU=Include Unapplied Entries;
                  ToolTipML=ENU=Specifies if you want to include unapplied entries in the report.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Print Unapplied Entries" }

      { 10  ;2   ;Group     ;
                  CaptionML=ENU=Aging Band;
                  GroupType=Group }

      { 9   ;3   ;Field     ;
                  Name=IncludeAgingBand;
                  CaptionML=ENU=Include Aging Band;
                  ToolTipML=ENU=Specifies if you want an aging band to be included in the document. If you place a check mark here, you must also fill in the Aging Band Period Length and Aging Band by fields.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Include Aging Band" }

      { 8   ;3   ;Field     ;
                  Name=AgingBandPeriodLengt;
                  CaptionML=ENU=Aging Band Period Length;
                  ToolTipML=ENU=Specifies the length of each of the four periods in the aging band, for example, enter "1M" for one month. The most recent period will end on the last day of the period in the Date Filter field.;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Period Length" }

      { 7   ;3   ;Field     ;
                  Name=AgingBandby;
                  CaptionML=ENU=Aging Band by;
                  ToolTipML=ENU=Specifies if the aging band will be calculated from the due date or from the posting date.;
                  OptionCaptionML=ENU=Due Date,Posting Date;
                  ApplicationArea=#Basic,#Suite;
                  SourceExpr=Args."Date Choice" }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      GLSetup@1002 : Record 98;
      Language@1013 : Record 8;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      Language@1000000000 : Record 8;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."Use ForNAV Languages" THEN
        CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE ProcessCustomer@1();
    VAR
      Currency@1000 : Record 4;
    BEGIN
      CurrencyLoop.RESET;
      CurrencyLoop.DELETEALL;
      WITH Customer DO BEGIN
        CurrReport.LANGUAGE := Language.GetLanguageID("Language Code");
        IF NOT CurrReport.PREVIEW THEN BEGIN
          LOCKTABLE;
          FIND;
          "Last Statement No." := "Last Statement No." + 1;
          MODIFY;
          COMMIT;
        END ELSE
          "Last Statement No." := "Last Statement No." + 1;
        SETRANGE("Date Filter",0D, Args."Ending Date");
        CALCFIELDS("Net Change");
        IF ("Net Change" <> 0) OR Args."Print All Having Balance" THEN BEGIN
          CurrencyLoop.Code := '';
          CurrencyLoop.INSERT;
          COPYFILTER("Currency Filter", Currency.Code);
          IF Currency.FINDSET THEN
            REPEAT
              CurrencyLoop := Currency;
              CurrencyLoop.INSERT;
            UNTIL Currency.NEXT = 0;
        END;
      END;
    END;

    LOCAL PROCEDURE GetDate@3(PostingDate@1000 : Date;DueDate@1001 : Date) : Date;
    BEGIN
      IF Args."Date Choice" = Args."Date Choice"::"Posting Date" THEN
        EXIT(PostingDate);
      EXIT(DueDate);
    END;

    LOCAL PROCEDURE InitRequestPageDataInternal@1091();
    BEGIN
      WITH Args DO BEGIN
        IF (NOT "Print All Having Entries") AND (NOT "Print All Having Balance") THEN
          "Print All Having Balance" := TRUE;
        IF FORMAT("Period Length") = '' THEN
          EVALUATE("Period Length",'<1M+CM>');
        IF "Document Date" = 0D THEN
          "Document Date" := TODAY;
      END;
    END;

    LOCAL PROCEDURE UpdateAging@1000000001();
    VAR
      AgingArgs@1000000001 : Record 70219;
      CustomerAging@1000000000 : Codeunit 70220;
    BEGIN
      IF NOT Args."Include Aging Band" THEN
        EXIT;
      CASE Args."Date Choice" OF
        Args."Date Choice"::"Due Date":
          AgingArgs."Aging By" := AgingArgs."Aging By"::"Due Date";
        Args."Date Choice"::"Posting Date":
          AgingArgs."Aging By" := AgingArgs."Aging By"::"Posting Date";
      END;
      AgingArgs."Ending Date" := Args."Ending Date";
      AgingArgs."Period Length" := Args."Period Length";
      AgingArgs."No. of Columns" := 5;
      AgingArgs.CalcDates;
      CustomerAging.GetAging(Customer, AgingBuffer, AgingArgs);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000004();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
      "Document Watermark".CREATEOUTSTREAM(OutStream);
      END;
      ReportForNav.Watermark.Image.Load(OutStream);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'OverdueEntry': WITH OverdueEntry DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Remaining Amount");
                ReportForNav.AddTotal(DataItemId,1,"Remaining Amount");
              END;
           'Restore': BEGIN
                 "Remaining Amount" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Remaining Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'AgingBuffer': WITH AgingBuffer DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"Amount 1");
                ReportForNav.AddTotal(DataItemId,1,"Amount 2");
                ReportForNav.AddTotal(DataItemId,2,"Amount 3");
                ReportForNav.AddTotal(DataItemId,3,"Amount 4");
                ReportForNav.AddTotal(DataItemId,4,"Amount 5");
              END;
           'Restore': BEGIN
                 "Amount 1" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount 2" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "Amount 3" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "Amount 4" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
                 "Amount 5" := ReportForNav.RestoreTotal(DataItemId,4,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>6YkAAO1d627cOJb+v8C+g7YWmDiYmjKvunRS0/AlSRvr2EHspHt3sWioJMpRt1yqUamSuGcamKfZB9snWVKi7pSK5bqkA8SB4yqJIg/Px8s5Hw+p599/vo+MjyxZhvF8OoITMDLY3Iv9cH43Ha3S4C/26Pu//uu/PP8pTdy3bBEn6fLSfYhX6Q1LQjcKf2OJUX18X2ZEJmhCRW6NSyPjyr1n05HM6WWcXLkfR8ZZPE+TOLp9WPB75+zji8+LhC2Xk1qhk3cXta9obPQk+yiKGRelGlOjkGRsnK2idJUwfm3OVvyRaGy8Wc2i0PsP9nAb/8pEat/yXJvZCFgBYQRw+c/D5SJyH3K5hcAn742b1E3ZPZunI6NRk7KueAL4P0gAr/H17BfmpVfxdGQBRHmOL0MW+T+yGVfbx9Bj75JoOvqQpovvjo99tvw1jRd/cT/cfwxT8J0FiH18/jB370NvyUuGEBxfn7upOzJeu8ldOF9ORwg4Y4NXD4H8v5Hxxr1jP4Z++oHfhMWFH1h49yHlVxxLyMA1Ph3dsLuYGe8uxoa94HU5X4T8PiVFrd7NQ57oltfzw/I6OHkdRlF4z1KW8ErN3yQsT3XjJeGCp3t1ecPS1WLyiqVHT5/96d8/n4v/Tp6dxfcLd/5wMQ/i5N5NuX46SYLV3BM3DH7jkt25EW8QfiiuLI+eGn+vEhpGGBhHOQplwtvEnS+jKuez1TKN71kyuXTndyte9bPYZ09b+RhGwqVN5sZAZi1Rnv1eZVDPqpFRroP2k1Xy30fGSfTJfVhesiA98X/hsgrx3rvRinEw02TFRry/GcbzU3fuL7OP/MsFb29Qdp6T5G7Z6jN58xMNQyQUT3I05bf3blJ/rrh8684ifjH7Ixtm49b7kH3iLeT67e3F1asj3uKTVCRgT0fGhc97M5A/cCRlLEQ2jguhjzOp61VAsgoFRBrVuGKfRPN9w5K3zIsTX+rIeJOE8/R6Hj1cBOcsdcOouHHmRl7Wxbg6T93InXtMXWtoi4b+t5dhxJt08cRVPMkriNr1Kr+WcLxlwXRElHX4gbk+S2QNsirnV+qd7Ca8m7tiRJqOAKam7UAfYgADZ4YYpoT3fd+3qGMFjsccmwbIhGW1X/Ah+0Hopaj1Dct6ULOsvM+/nI5sPgrU5Oc1kDIvG1ebNaPKmt2yz+lp/Lmo1nnsrcRIKJqGqNJvjBeHbT78AYAIGVNn4vAfXt3L2Mu61csodvlwATHMblE4Nsz8o4OdnpGJF817cRQnHNLI9X6tq1EIdBJxXQoxpqPXoe9H7K2oOFdAnPyW3eNTTn5FpJ6O/u+f/9sUXLQP3nWzVlD1lkkjUUtVXFk36UPEOCJxEqYPudLMkfFuyfJKBG60ZPJ7KX91sSW4vHHcRqTRixo4obxISwen9ye3b9ndVVxiRGiGETDh2AQddDDik4lpZbDYhwMllzJc8tk5a82xCplyfO+m1oLI3g9ESAURzot0dCAq6tUEqR+dL9Bp1gCiiwAE+4EAqyAgskyog4EYUmv6FzaVQv+QCluLgj5Dag+aF4KpdZ8kuR02yZLo6R/tR/9EpX8qy8RK/b8JPTEF1iEor8Cu4oFQPGjOohlSFr8Bs8nGNKn9aDVfxnc5+pn/819xfH9x36P5hr0nHtNTPdlYq1SlVVNmpzVJn7kLocRSWZkaFe26r1FDsEjHxlLUZnoaR/4jWrgwdxuazy/kiq81Yimq8WfjyXfGE/6nZs0v09Lx6huIHpGPHmx7mtdNFbaWLFNrYhfu1YnvC0e4mjY4vAiJ+R0jW9GLMMjmfsgd5aLP2DuYRW7jhexP3BFOJc784mCPK2VXwNn1HLO7r5J4tVhOiif1ANzTrG+pALRlmVrT/obggZ1jlvfEAcjqXXUNYkUnezROaE+mga3CyZFlapkGRd3ag6kwxtRj6RoLbbMRtabcVyyVQhw9HUShkVBP/bqWgVrLjtKdBDJvtQXQ46hsoOYhN2VTJW/shGTXpLDLx7okiGyldgiUepd+PNrYkdfUfW6N7biV67rmTb1v7qgj3Rm9R+VKjxxKlxxpTd0Zqdaj7wHfXKp9x62+FEZT41V6PXXrzr896lZ611C610hron0x99cqO//Uo3IL5y19VyrnAnE3YwOd1x7QUjrWnUx7lK70p6F0qLHWrCmVXqcGpZohQirTFFWKtqh5OAdbA4yN1b8nNxsq/WwoHW2sNc2exYuHhsnZ4w6a6xeLShXmeQ66ZXzUmPtuUjXp7Bk9bSrmyB79KD1mKF1mrDUd1obDR5Datv0l2NP1Q/iGgzbeF5vddHufHytWI7q8d53zxuoJNvM4XsZx2lx7ya/UNXzKNV5on4WC4Hnj+vmiNxjn/7J0r90lf1IurlTrv27Ellzv94uI63JcZF9b0LEYYt4ssAl1gGkxiwWuZ/kBtnBgU5O5lud5M3cm1mY5+Oxifhqn3J5sLW4Nr/IUxZarPGIRb+NVHmzrdId8Rennmlv382kYRT+nsfTuzIpcyqg4ohxO9AaTTtM/45+zmlZtv7h08yH+dL1KFyueONOaoOKEW/R6FaXhZTgvdZd3k/8eXJh+8yGes6vYMP5tajx5Ynxv9FEQ5fhVPPFn44khiaaBbL8z5qsoGhuDQrz4+bUbRvoiyPSDEsg0svzB4n/gbo1ocxsooXxkUIYylZYWOp6UvjjdRwu51IJ102tJeHF6cqUvVJZ6UD9ZCq2Sb368eHkrwgY2wKh6ZlCIKlkuSSXH/0xqARvZmvlRGbdx9NGNnhp/l5EQ/Muz359OfonD+dET4x/GEyVL8a0nfuuJ33riwXuinuHnKA2/XUUsCONAb2WjqZOG/SEND9Q0PNRuDHQUlodZOe0XqRuF3l7skNzsUAW2PVONiuqEWqARuDVoSNcuR227HBuVr8fm3sNlLBYRtIPU3rj8qVTEXVWhYb0RXp3ItmahqlgvMhjdlgUI5mFfJhU0tTDt48RNHooir+cnAceZo5NHoRVBj4W0MtDMmFbrjFcsPfvgzttr8p1gsrZBTtT++2nsP9R9mqLO4npPVNnM5u3eZpbFIEbUms3MgASEmcxEvKtg6tuWy50T0PIrmjmX3oUkxyj3w7vNscfR6NRNHS3X6viV5jTiMIqFTLVr0WTlFJxFrayhwBY1loO9ka6nK/pHy1JxxYhp6i1R5ciJ9lwNi07OVgB7XIOwrUoEShb0UaoUcbn1bjjJZq6pmBNbkbdFnPDl2X+KNLXQ2Ooj4+pqPNXJWvmYCsM/hmD6zcbapNm0WfGy2UhinGg592WzaTHjPb2u148fbiENTa1fwuxLrK9JhQ3Tr8k21d0z+8lbGblwFker+7mMlQWPsYOomkLvBg8X6hgMIrZn1szzoW0FZEYIH/gh4X8QH+QpcAlxMDa9GbNRz3DfCRqG7aDhTHzNkZ6ituzZvNuq709v5dUGdwT62lxZbXUjeBt/UonVEQ23ReMPqgXLblTK/lHuoQATaloOn3YwkR9GxskqjV+K/RJVCL9SkDMWKZWnlLQ9XUqxRB5luFy8TOWqRLd1rO2kVXxhlU1VTzixTcskpgMIpg6BYhbq8Grdznv9kSX+ir3ggj+0nfR6MS3LNKdAO9Eo+eVuQMqADtUDAlXMyNr2cSPz3im7AWLRydtTtwLEYvn6Kt4GwyqXfgjFkLMdhPVSDo2gYnLcAkHV7NlAUM6itD2LqhBky8wl4CraCsIqmwpDMjFNB0KLYOwghBwRXbAlhvViDg3iNtxCF8TuxN0CUS5Xm23OQQXiim07jsosBsZQe2vwiiKUwHUjMBXI5Yk2hs7chmHoQtdexu5AJ1e0TbQeuuskvAvnbnRyH6/m6TYINnPaJ5Dtkg6PJ94pnu1l9w6ecgXe1DBr3rJ7N5xzU2F7QFtZDSBKtkW0U9ThId2tkdOOT+9AKmPVTQ0jR3Jk20BZ7udsQWgDQpANTIz1IOyJ3iyzPzxsu7Vs2lHp9ftDDsiQZfv8uMe/6nuo14Ee3C9XAXTJ/DuWZN3skUxyg4qubQsuu6mR99NxMRIbRb9VccgiXG2IRJZtyriKJ2Pp52Q7pseFIEaNZ8aP4ZSLK/lulpp+WlOJasFARTuXapf+pqmOo+xSz1XhyRAB7VvEpFbg2Q50fEIxsn08o8zi3ynvqx4JsDfzxM6wFiPRzb8W5IInkFALwR4WYICgaNdXnISgbG/aXEUvPTZMVWSCDNAVHUFhj6CbMhc9SquUt4ad6AimYZo1fP5KpFrAFa0CrpThQcMsBZhAYFMEKSaOCQABltU35te7zBAVMbhnbWj4LfVT7M1uL+YMOv9K9VB99agIgEo7GFnchxRm63rlDDj52+tGutWWhhnYcFS3VI7KtQYTrhQMsI2oCUzbInptZ8h/3l4/0mO12oGq/R7r1rppe61VqwEAmY4DxMYgDb30uKbDEaxrdKK2mCzzkRZSluFa/7MEQ/qgVjvgdK0Pui0mfX5oCQ2yuedi42zBej00a5zNfSBkb43QkEdZIiS9SqttvKz3KreFqNezrDCyKAUEEbFpZD1G69zHPYBkg61BGvIRS5Ckn2i3V7wUILWs3R6QgBZInby6A5xNuTXJ7dTeXtR4/gCIoK0R6Xf/8jRr16DWLHD0uoLrHh5YU81ud9ZVbbxN1IStDjfpbhBoehzd7QI1n8YEDDnQdBiwGXBskwXU9gj1XcqQL9ZebQsTK3AbkTODDo4sbmtvxtY7C6I55vSt/ZMisgaNqT0hiNvVIiiwHYADwaOiATbd3KIfxDG01+g2Tt08OvdIxFy24j3EjadP9KM+NEvpit1fznbxK1931fsHG9UYqd6YtNmYOTzKNcYRvZM41D0rU8q+I9m6c+baqWwzhSu27w7rVb24OjgB9D34/FgZMzl05FOXqd8xhdhiDMdtSpEDI3Avkotjf84Sxn2j7DK/8qe/reL0Wfux/KoixLVZlW3pyesFmwuOMkzDj2zMvbbiaMcig8tw/isHnona19pOM0F1XWQ6fXnx4vL8iH+SFKcDTPpIItJRB4h3A6OkWgbjonxufgMywzYEnmvbEFtuAF0CIAuQ63sWg7PAdF2/NUm3sq7P5ltP1Y468OvSnbHSDM6+QI09upuNF3Kwfn05Hb24ejeVtSzGkeLrRoODo9jn/JhBV2NwWGfxOXrB07KaA9R1gIOZRaBlWhx/07cpxT4I8Mz3Ay/wGEG+ZwemR9WNphM6vYMmQwrh0+zw0nXsND0cO+3Qhmj8yR7pDkRKOxqLkWlxAe6Nk7Yci1rUoRYklDpk7VLyQQhpR4PHKnWD9kVIZ6oxBVVPqA2U1GJDNYegox2NKK9SM3hfbLQpDtLBXD0AYWpb61vNQahoR4NbK3VD9sJGy95ELOhAjJR0WlMvh6Ois4DlA3LREGiwaCUc5j6JaNmRxShnmeK4iDWoHJ6FhmB7Pm0TGhoCjSW/EhxrrxR0jg4ilAtl0fV95gvwzxCQPRPQXxPdCQHdZrsPBOptYl3CU8I+yHQCm5u9ENqQBMQJiMk/WC6EDJi+DzGGDgC+hUUEQD/T2SxnayOYN2kdJkZ+heaGdKadb5UzMflGan4jNQ9NakKgPiNvX6wmBFrH5smvVntDqW3ZSiYTb70nt7tKu9m0tZnWVYfR74naVG0y7Kc2myZhN2U3zwb5ecINrbvTVRBovWZlaCN+k8mEYAwR/8XZKU9jWH9zTPWumXrhPa+cQcOvnMmwNXI6sck6nniewFlJOpbvpQHdXfxNfa7bhw9hO7atj4TMKjv8fhdimgA5eMYCQHyb2IENLOj5LrJt5rgBNj3LpGJGasyejYyrfZloi32ZsOcc/i71iA5EPRoLlojfMPZbLGT9jrrLKfsz2eXGewipAmat+FBsql/eQcTprTvbzQqFldNk33ri6vQ3s+5m9yrsHGA/yMM5jfP54oSreVmF2OvvEcgnAVSvIAG8WpbFjVaT8l6muc+jNoa19gmURezOP1I3ZbVBUCrncJtYYecs+0HeEO8US7x/LPHesew52H6HWOpuZ4Wd8+4HsSQ7xZLsH8tN3bFHYKk+2HeHWOruaoWdQ/UHsaQ7xZLuH0u6fywV5sJuseyndve2GUsVQzG4GWvolBLY8wKB9qJqjmVrSbV20G72as1F5l/0HbdbP0VN6rdmRTPqc6/BcwNKZgGiPrfEEAxcOHOI7VkO8UzHZqyzkF+Ta3BFVtuERmanylsbhLuzB8XpAE17sGcfwcHtQbTJChtqUOPDJLieyTc8+hzKpkO7Pf5A24DDGucfVMq3N1X+OhtNR/n7N8Lwbg8w0La4sMY2uUr5zqbKX2dU6Sh//1YT3u1pA9omEtbYZ1Yt7INNlb/OCtJR/v7NHLzbcwG+gE2zwQZz5dKaWJ3e/M2tsOdNA90ltQzVwQU1Xyyc2cgLXEJZ4HiQUds1KSYzx/J9y6cBtBAN6NCCWr2Ux1sw4tD/Tn5/IBtGMKFNG6YnpOvgNkzn6OLBwQQp/a3beDE29kVs/TGsnJ6ziL8Ec0U2mXuxmrnaCrGvwzQi6tn5S/BTnVOCBxFT81NbIfZ12FOqE4a/EAvVOZ54EDE1C7UVYl+HEaY63Per55o2Pvin2ar61rWrmjRT1MeS+p3n+SE6ZbL6pC0OvbyKs5eEg/LIl9r7uyvNNmaO7AzbON9Z3vdKgtajxRCWnTErS4TNEsvj/TM+LFLlUnQr0T9ELk5prskYlyI9h6as9fPjn9LEzaNYlpfuQ7xKb1gSuhG33JK//j8=</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70518 ForNAV Tax Purchase Templ.
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Tax Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>p4IAAO1d627bSJb+v8C+A1sLrB2sWq4LL8WONQ1f4m6jHdsbO+nGLBYGRRZtTihSQ1GJPbMN7NPMg82TbBVZpHgpSkVJdntmOwESkazr+U6dOvVV8fDw+8dpqH2hyTyIo/EAjsBAo5Ebe0F0Px4sUv9bMvj+D//6L4e/pInzgc7iJJ1fOE/xIr2hSeCEwV9ooi1/fioL0kdoZPDSarcG2qUzpeOBKOksTi6dLwPtJI7SJA5vn2bs2Sn98u5xltD5fFSpdPTxvHKJhlpHsi+8mmFRqzbWipYMtZNFmC4Syu5FdMGyhEPtejEJA/cn+nQbf6Y8tWe5DqEEAcvXqQ5Y+0+D+Sx0nvJ28wYffdJunUeWNXEfnDnVbul0Fo4GWq1PZa/xCLC/UAes71eTP1E3vYzHAwsYkAy0s4CG3s90wgT4JXDpxyQcDx7SdPbdwYFH55/TePat8zD9EqTgOwvo5OD0KXKmgTtnbYAQHFydOqkz0N47yX0QzVldgPUSGvZQQ/wX4s2/dmY0+SmIvPHggqYpTfite/pz4KUP4wFiqfMbP9Lg/iFldyxbZw1jgIwHRxzWoWbP0qHG+prc0HTMJTILWDpDL7r8MQpY4lsapQ/zK//ofRCGwZRmVV1F1wnNU924STBj6U7i6cyJns4jP06mTsqENPqBpvtv3v77vz2e8n+OKr9yebN6F7NWqsDX9rXrJIjSi/g+3n/zRvvr8qGmVbOeOKGbyXq+v8cT71XL+VVWsb+IXN62agX18nn131Qr+TinrLMznp56mdgbOTQtYQmTSEuTBX1bffJrs+CTRZLkYhtlDaBc9ikbk/P8+jYej/euT8/2nruKhH4J6NcNqxGJfCecU2WBM5gv6L0TMpvgBfzOXCb5XPBlwtvEiebhUpt+pI5Hk9GFE90vmHKfxB5t6kfZvBVFNRrS1VNJn6uK0V3KrwNmWjXt8NiJvHn2k12cp3QKhZ3M+9EwkLmF4WOfJ+V5mVmlX/kovqYMUzdO2Gjn0LCMpeaz4TyNF1GqnUduuOD2Xft0dDvMbw602zh1wiKlCYYmHGg/JPFiVnuA2egX9X5yknobiwe3ziRkt7P/IEKNB5+YOo0HN1cfbs8vf9i/jEdvuBn581kQMg0sqmG3h9fxnGsjz025jXtkRSQZLGwq4RKZBZQlhcwgnbPuIl7MnKZcCpeL6YQmhQgyG1S0obBCAyHthvArAHygftZfiejzHgvBZzI4jd3FlBnAUhaliTx23M8ncRiz5mSaNXMSyuV9E9xHDp+OxgPXRhbxdAO4kDoTSuhkQqDpEx9gw8Km41vEYIJklv6GZmNEXudRGMZf8/69S5I4mRcCyIbzVfSOzfJPXDzF/dzkn40HBLM5CgA4qEiByUH0fF67W5ePLpXPLX1Mj+PHQU2J704XNMfyhnkKrFZMslqRrg8Ne2SzP6y0i9jNMD4LY4fBBDHMHhEy1Ewr/1nMTjf0Pqbax/OhRmYpv5lQIejjkAm9CgJv0FHIJM7lNR68DzwvpB9475kU4uQv2TPmleR3eOrx4O//+7eyxVx72FjO1LPap1GRoiEiJqSb9Clk80EQJ0H6lAvLGGhsjsgbn9lEcV22e3mz0WDx4KCJxEEGhQwflFdpquCznAnublKm1E7inTizzFbdsWH2VCLG/KGhCVogMVfD4LelsNRByMSal9mWaWVGarZjlOVRkrLVlrJcbkgmN5wXQnroddaDizj+vJjN766dJw7ZLU2m81M6z0Yj60BV6ZkIs9GGEJToO2LStHCm6ZZhvpyudza8U/er/R51ZVeCzH6egYFlAOt5lXza2B5hoZ5LdFEGLTChABmYbYgBWEJsSwEeanMupPFxHHrrwW7BV7aqP3RFViXYIFTETQ6PLoPHEEWjvvCUFqs1zVQx6UBj5dSyARrrJ45am/tNIxBvJXZDJnZTFN1nPm+IXXgjTdmvEHo+tdt4Z4Og3gZV2VczqQGgOpHLATBlAFiiaKUJWwrAVcLuXcbrZP8M2l7WrCjxIr2asCXzeQ9hWzJhE1H0xrP8yWKexlOaSOx/l8x3ruyfaOTFSU9bX8+kBoDq7CwHgMgAsPOiUe9JOFuRzu+OgzC8S+Mjz+P8X80/RZm5x4i0naucHGMwmCaRw9DLs7qNZxfUTzOGMxVeFbtX87LyBDlmVTzyfvCpt9qN1RhK8yhBiFQn6p4Oli1dGQJRqdIU3mYDa0D3RBhiIHzrnUMt/OUVWIsUNw/x16tFOluwfBXysDJyV+AtIUer2PdDXdVP6LveBFLYBSOAlFyIypKzaUMz56BjlQkkq0wI+prP1uooH6Udw7ayKhVN1f5D2/tO22P/ieEpn/vUMqpB+VzUgZQ7gII8QHJn5DpwOW+1ehCLRB2uX20TQeBusQfFmDXIxutYPtqyMrMNrD/G8fR86txL3cEaR8uzqWFh9RezlGqAgmtASm5IZcRcZ/0RYkPy0QIN0DVgno9BkIu5utHAk6hJ+Zk4ASglBaBgBXAfh0Q4IYUvWHG9dUOKScbtrHEEd4+MMDW525D7fyt99UZCJbTwMzkYUMoRQEES4N4kgdR9JEvc9BybbvJGkAmQYIYkecHBtX6N1WtVhZ/LN5CyC1DQC7jXdoGUUOixZ2DA32C0qbMQ/XkH/FxeQJ2RODyQbPy0txqq2wxY7ilkw+0sjtP6Zll+R2WT7Nrx8oMoYJj/zVJ37WdVttQsCkzfcVyi+46B2BVyDWzojuV51DZ0C2Jk67pjNrbUipZdM1Wg59FxnDLT3touQwbov1OGrZ0YK3PpJ2cOky51lNU2Y1q6fUKjrPsV5S5uda5q3i/CNLgIohKFfBz813KTW21No2nfjLW9Pe17rSt9yR8VOZg3reXudMXFOMsyiST7e2qV7w33htreG40VFy3CcKitbP2no9sP9D6Yp/l29GWs3vR21qITvBcqVSm18PohjihLrN6wIkdFpiuKVWrEu7v3ThCqN0GkX9kCkUbUv7L6H5lTxq1DDyGUWVa2oUzVlsJ/jyoHWrITDfvluZb9L074RvurOB/CLt7++mb0pziI9ve0/2HKJ5sqfh9Fv4+i30dRr1Gk5kkRqSe1q1MX3NvcFfWJ6hO+nBiDtmTGN5e82HnqhIH7LPN/Pt3LDu29lVk0eUIl0LirsyVoSNXRRU1HFwvQuKejcByvuLrOHFl+Pq04pVU7TsdZjtZ5urwK+Wk6PFh1mq5YUmj8/BwvRsvP1xVZ2K3PTJSUtcmVHNzjj5fHynje8dn5u4tTcUqP9wI3HN/m2bmm16vLl+jHsfdUXRHwts75zZ4n5/AEEYs5+ZDqru6bnuNOmEc8mRjWxLIgZP7/BDrIJA03v1Jd6dSbQKKFHX59q5e41pEMmUa/f/kg7q4fzFVyVFIxq/pD/FXWpFaz9FqzWC55o7IHS7n/LE6Cg5FhWjZgSqeLH/Lm5JKioVRM0nYZ8nbwMqotvsv4jrJd0hVNuermaZctN3VbJ8QyAYTEAjZnstu2iNeRcfd9NgVOnIgZ6K+loakaxqxAZuGuspnwkxMu6P4e7yJzisZjbYX8MhHJbJ65hc2rFS6dtFoIiQlMby5WuxCqnxRThKqWqcAMjSADzUQYYMRQswzcCVktfwOP/hKWuALrBdkk9FuCFNy+3vQEJIJMixu6ugiZR3vuMewDP+AWvKX4BtF1ZNgm7JZio4h+ZNe2Uje2mcvbcDRJ/RYcgt83oKJe/+fCYZJJn9QRWeZYCcZx6ESf/0iTuKBLOtBZFvfCwKCdAtPk71vACCrfaB607wKGv2sU+++pM892F1XRaWRrQYSghTAkmO/FdSDSKOKFYdF3CkuTpW/BIgh7Q3Wm5v+cBnOXv0ty7abqwLQytkePZREdY2BD9dHTKnUrtGpzfPkKXu7ys8pHPzrzorLxOGtXf3x3O883jxi28BXHDQ3VeZ4rP2ux23PIncRzGaQmJEC3sQlsdUiXxb3wyNuGKmgj0zyP2EJGnE00FByHDJni/S1VWIr0BShwhGxiW5ZuIB1gzBdsqpCUr469KCDmbl2H5vnE6vNVi5pVDvXhQccKrSuTlIkQj7INFrYOXkwjIQC40ZtA8pV4+1W2bK240XtsPkU+RhD7wAC6oesTz3SIbxm+brGVueMB2+BvcjXfY6tVWK7HIdhiQW5iSW+Ul+W86jXrcu045tvt8/Eg3yPcbqFu6pLm7mC5rh0t0viMv5y9elbqtXo3VX2C+vH0y/iuS7Maolx/Plq66CcjAgyDWTGMLAh1yA+9tjYnOyxZncCWUAJ501rHfYsWr2MJ+hs5uT9QiurlqABT1UVovA6yXKN34a4Os5wwsEfYgETnDI+JLMzP+W6Gd6343xp4ubuxQ+BVqQuzD3WBNgO2g8YohzKxMAAQ84Nem0G7muR4aXCt34b1sFRZj/oQLiiI7cdvmxspEEZs/BLDYCN4U4Q7iZIcxfaxfQm6S8/05iHJNkGK4Alb4i0nU3Y4mFX5FUuVX6mrAF90XRWcx/Z60MHClMpgMOeRmBbeeOZezdG8Bo2Q8zg71AhVasfazI1rMCvdOtE8VqmuJZ2UUKEnpmlC08AmsTbVk3X80Eaa8sKUkSV3EaWnQXeoX6rUkrWZ31gSTc+hWW1KqlApg7C1KbEI2lilOvmp12B15E7lc6uKKtdlqXJddVXJ6aeqnmw5Q0lQFSGT+Emm/cp7W7V3avmxORq5TzzIFE/5Zq/CrlkjE0IIDET4DgM/AL+Zem3akF0btt66R+Q+7w7V7EUZvI5O5u+/VDiy7p7KOtSbF1SIYNPxcgzn7tqkX+V2T9KPmcyJ7XsAOB7xPUQh4TEFIfQ907Us06emBzDz8RukX63CJem3zSkcgiW9eb2kH9ElzX2tpB/ZmPTr0KzNOD5rpAPdNG1ALGja2MYbLxtfAcdHXg3HR7bn+LaGWc7x6SOTIISBrevQxsDcGO/XxPGRV8PxkT4cH94px1cMZWzpBGAbgo09bxWO7yU9Hvu3YfnsLVm+rUdwm+XbHca7Zfm2g/fVkHr25qReSZJtD3sHqSewJ0TnzJ5NjI23Z56B1NtOAV4Nh2fvhsPrVIFn4PBKtYDQtLITkf9/GTz7dTN49rYM3jPoVZvBKxTKwgYEtoH5mPjnY/Ds183g2aoM3mUMXgkxp48IsDEmgLCVJAJkY7X5h2XmMsbjn56ag+CZuLn6EhoCxXB3zI2NFtS7E4x1cYayiOZk56E5LSIN6qRXwtt1hHbq+crn+nAm5QHTlYdAe+AhDz2jrmLdS9zq0hYCfSNAWuHo5LGcIDLAehC4ERtqcihEKHRRff946EXGHpKXxI/pFnB73bmGjV4dbrsjsC13EdoRYiq3e9LR9mRiuUD3JsA1dcuggACE8cQ3Pc8zfeRaum9jMqEyOrqosKSjbTbaTB1Zm3PS2ZJ3V6+C62pK+Q+lkopv36ka4R2+eI+XQac6QuzpYK20X60VhtuSVF1WeI2RWBn0HTYprBy+tn3I9nk3sg8Uu4h4BPq67cIJW4P60ESO71BgWAhRD0JrYlp8Mm+fUW/ZBwSMLE6cLXmzV9lCqIW6F5dGJUyqbY1M07QMEa0OQdyOV4dGGGNoQzZV6brwLGRf91qlrdXvC1zG8phm1VCa1aQ9FFLiFmxhCWC5u3bz4MyoXMbZo/o2oCENr1GPV8pz5cXwAZuHaxCxFsvrmzShqftQrCSOonsexcGWbG/mEuFlFk03RB3VcBBbOEJqMeXbEXlNVa8U548tc6ihTMlsxE+XrV3cSdSs28yJZVV/Q6fwPZilMGVke82PUYsZ3xYmWTubVKRI8qGKFD+pUxNN+XWvT0e339aFtk6qK7L2kLckcGu3vGVUd/07IEoRWdvyttbKG2afSNxSX28WkyygS19fqcynLlhZEPduwcoo5NqXPhTDs7cEa6sJFur51MjP8q4VbOsNoKakV4kyk2N/+qUfXptV0gNc+aJYnZ+Qkbq1D4soxmVXco1BH2O2W00o54iqsepl2fqgIg+4qo6KjD+tfYGkI8T6RqjAKipFlNzOAdpzjmFyv3UeuyeSlYOnzNhD9L2m7TbPuGYZUjePhwetb0C2vAHhBQif0gl5mKfH44XvK32eszseWCv8V7NsWSAwC2Sf71kRCoyJc+okT9pP9EmE7oKD7EvFccJuy86GrY3lBZF8dd0M5lV2oBHPq7qhVu/k6N0ja1kqmPRvxhp4W4/m61F3ghxMLOhPoIuBYwCbTsjENTzTgrapQ4wd/sJabdFWb8jykCHa4pAhVAsRLy715pAsFmugvc7Ih2Ue1brjmyVr3RHWWa4K3cO0Iff6TkY9t/pYlUV/32LpphbWXVzibgnzw9ZSGa8nyKTCrSppb9nWMvcQba9V8dqloFoAdnGJ+szyK/V2J7q6sXZuyXo3FoAdoc7lIoTNJbSxaltHt1Ujd2+ij5tqYK+JuL2e6xXaAvLArCqxLbpm7GX9zRSHeT2SDz3nziEVQ3V5/iNeJC599zhLCnrr5IG6n8uw/eLwR/UgiPjseDHhguKP1D9dZqt2mYur2s5q56tdOsw/8934aLj4iCM/CB/n79V0OZDLOmu2NwsZGWcf4+HNbpF7jWyFXeERHYtssJ5N9l31opTDg2UvDg9+SRMndyHnF85TvEhvKGco2fhJ/vB/</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70519 ForNAV Sales Templ. Sales Tax
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template Sales Tax;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetSalesTaxDetails;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1   ;1   ;DataItem;SalesTaxBuffer      ;
               DataItemTable=Table70998;
               DataItemTableView=SORTING(Primary Key);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetSalesTaxDetails@1();
    VAR
      ForNAVGetSalesTaxDetails@1000 : Codeunit 70004;
    BEGIN
      SalesTaxBuffer.DELETEALL;
      ForNAVGetSalesTaxDetails.GetSalesTax(Header, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70526 ForNAV Template - Landscape
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Template - Landscape;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70527 ForNAV Template
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 2:54:09 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;                  ;
               DataItemTable=Table2000000026;
               MaxIteration=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Mo§nosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70528 ForNAV Purchase Template
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Purchase Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := TRUE;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table122;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table123;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70529 ForNAV Sales Template
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 8:51:42 AM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    CaptionML=ENU=ForNAV Sales Template;
    OnInitReport=BEGIN
                   ;ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                   CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
                   COMMIT;
                   ReportForNavOpenDesigner := ReportForNavAllowDesign;
                 END;

    OnPreReport=VAR
                  ForNAVSetup@1000000000 : Record 70000;
                BEGIN
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                  ReportForNav.GetDataItem('Header').Copies := NoOfCopies;
                  LoadWatermark;
                END;

    OnPostReport=BEGIN
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 2   ;    ;DataItem;Header              ;
               DataItemTable=Table112;
               DataItemTableView=SORTING(No.);
               MaxIteration=1;
               OnAfterGetRecord=BEGIN
                                  ReportForNav.PageNo := 1;
                                  ChangeLanguage("Language Code");
                                  GetVatAmountLines;
                                  GetVATClauses;
                                END;

               ReqFilterFields=No.,Posting Date;
               CalcFields=Amount Including VAT,Amount }

    { 1000000000;1;Column;HasDiscount        ;
               IncludeCaption=No;
               SourceExpr=ForNAVCheckDocumentDiscount.HasDiscount(Header) }

    { 3   ;1   ;DataItem;Line                ;
               DataItemTable=Table113;
               DataItemTableView=SORTING(Document No.,Line No.);
               DataItemLinkReference=Header;
               DataItemLink=Document No.=FIELD(No.) }

    { 1000000001;1;DataItem;VATAmountLine    ;
               DataItemTable=Table290;
               DataItemTableView=SORTING(VAT Identifier,VAT Calculation Type,Tax Group Code,Use Tax,Positive);
               OnPreDataItem=BEGIN
                               IF NOT PrintVATAmountLines THEN
                                 CurrReport.BREAK;
                             END;

               Temporary=Yes }

    { 1000000002;1;DataItem;VATClause        ;
               DataItemTable=Table560;
               DataItemTableView=SORTING(Code);
               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 2   ;2   ;Field     ;
                  CaptionML=[CSY=Pocet kopi¡;
                             DAN=Antal kopier;
                             DEU=Anzahl Kopien;
                             ENU=No. of Copies;
                             FIN=Kopioiden lukum„„r„;
                             FRA=Nombre de copies;
                             ISL=Fj”ldi afrita;
                             ITA=Nr. di copie;
                             NLD=Aantal exemplaren;
                             NOR=Antall eksemplarer;
                             SVE=Antal kopior;
                             DES=Anzahl Kopien;
                             ENG=No. of Copies;
                             ESM=N§ copias;
                             FRB=Nombre de copies;
                             ITS=Nr. di copie;
                             NLB=Aantal exemplaren;
                             DEA=Anzahl Kopien;
                             ENA=No. of Copies;
                             ESN=N§ copias;
                             FRC=Nombre de copies;
                             ENC=No. of Copies;
                             FRS=Nombre de copies;
                             ENZ=No. of Copies];
                  ToolTipML=ENU=Specifies how many copies of the document to print.;
                  SourceExpr=NoOfCopies }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ForNAVCheckDocumentDiscount@1000000000 : Codeunit 70000;
      NoOfCopies@1000 : Integer;
      ReportForNav@5000 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.3.0.0.1402, Version=3.0.0.1402, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE ChangeLanguage@1000000002(LanguageCode@1000000001 : Code[10]);
    VAR
      Language@1000000000 : Record 8;
    BEGIN
      CurrReport.LANGUAGE(Language.GetLanguageID(LanguageCode));
    END;

    LOCAL PROCEDURE GetVatAmountLines@1000000000();
    VAR
      ForNAVGetVatAmountLines@1000000000 : Codeunit 70001;
    BEGIN
      VATAmountLine.DELETEALL;
      ForNAVGetVatAmountLines.GetVatAmountLines(Header, VATAmountLine);
    END;

    LOCAL PROCEDURE GetVATClauses@1000000001();
    VAR
      ForNAVGetVatClause@1000000000 : Codeunit 70002;
    BEGIN
      VATClause.DELETEALL;
      ForNAVGetVatClause.GetVATClauses(VATAmountLine, VATClause, Header."Language Code");
    END;

    LOCAL PROCEDURE PrintVATAmountLines@1000000003() : Boolean;
    VAR
      ForNAVSetup@1000000000 : Record 70000;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        CASE "VAT Amount Specification" OF
          "VAT Amount Specification"::Always:
            EXIT(TRUE);
          "VAT Amount Specification"::"Multiple Lines":
            EXIT(VATAmountLine.COUNT > 1);
          "VAT Amount Specification"::Never:
            EXIT(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE LoadWatermark@1000000007();
    VAR
      ForNAVSetup@1000000002 : Record 70000;
      OutStream@1000000001 : OutStream;
    BEGIN
      WITH ForNAVSetup DO BEGIN
        GET;
        IF NOT PrintLogo(ForNAVSetup) THEN
          EXIT;
        CALCFIELDS("Document Watermark");
        IF NOT "Document Watermark".HASVALUE THEN
          EXIT;
        "Document Watermark".CREATEOUTSTREAM(OutStream);
        ReportForNav.Watermark.Image.Load(OutStream);
      END;
    END;

    PROCEDURE PrintLogo@1000000004(ForNAVSetup@1000000000 : Record 70000) : Boolean;
    BEGIN
      IF NOT ForNAVSetup."Use Preprinted Paper" THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'PDF' THEN
        EXIT(TRUE);
      IF ReportForNav.PrinterSettings.PrintTo = 'Preview' THEN
        EXIT(TRUE);
      EXIT(FALSE);
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout Code";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF ReportForNav.IsWindowsClient THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout Code");
      LayoutId := ReportLayoutSelection."Custom Report Layout Code";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout Code";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
      Filter@1000000005 : Text;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.pdf' THEN Filter := 'PDF (*.pdf)|*.pdf';
      IF STRLEN(ClientFileName) >= 4 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-3, 4)) = '.doc' THEN Filter := 'Microsoft Word (*.doc)|*.doc';
      IF STRLEN(ClientFileName) >= 5 THEN IF LOWERCASE(COPYSTR(ClientFileName, STRLEN(ClientFileName)-4, 5)) = '.xlsx' THEN Filter := 'Microsoft Excel (*.xlsx)|*.xlsx';
      DOWNLOADFROMSTREAM(ServerInStream,'Export','',Filter,ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      CurrReport.LANGUAGE := SYSTEM.GLOBALLANGUAGE;
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Header': WITH Header DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
                ReportForNav.AddTotal(DataItemId,1,"Amount Including VAT");
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Amount Including VAT" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;  'Line': WITH Line DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,Amount);
              END;
           'Restore': BEGIN
                 Amount := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
              END;
        END;  'VATAmountLine': WITH VATAmountLine DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,"VAT %");
                ReportForNav.AddTotal(DataItemId,1,"Line Amount");
                ReportForNav.AddTotal(DataItemId,2,"VAT Amount");
                ReportForNav.AddTotal(DataItemId,3,"VAT Base");
              END;
           'Restore': BEGIN
                 "VAT %" := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 "Line Amount" := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
                 "VAT Amount" := ReportForNav.RestoreTotal(DataItemId,2,GroupTotalFieldNo);
                 "VAT Base" := ReportForNav.RestoreTotal(DataItemId,3,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
      </Body>
      <Width>6.5in</Width>
      <Page />
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Codeunit 70000 ForNAV Check Document Discount
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE HasDiscount@1000000001(Rec@1000000000 : Variant) : Boolean;
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000003 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      EXIT(CheckLinesTableForDiscount(RecRef, FindDiscountFieldNoInLines(RecRef)));
    END;

    LOCAL PROCEDURE FindDiscountFieldNoInLines@1000000009(RecRef@1000000001 : RecordRef) : Integer;
    VAR
      Field@1000000000 : Record 2000000041;
      NoDiscountFieldErr@1000000002 : TextConst 'ENU=The connected line table does not contain a valid field for Line Discount.';
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE(FieldName, 'Line Discount %');
      IF NOT Field.FINDFIRST THEN
        ERROR(NoDiscountFieldErr);

      EXIT(Field."No.");
    END;

    LOCAL PROCEDURE CheckLinesTableForDiscount@1000000011(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) : Boolean;
    VAR
      RecRefLib@1000000004 : Codeunit 70090;
      LineRec@1000000003 : RecordRef;
      FldRef@1000000002 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');

      FldRef := LineRec.FIELD(FieldNo);
      FldRef.SETFILTER('<>0');
      EXIT(NOT LineRec.ISEMPTY);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70001 ForNAV Get Vat Amount Lines
{
  OBJECT-PROPERTIES
  {
    Date=12/12/17;
    Time=12:25:38 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetVatAmountLines@1000000000(Rec@1000000000 : Variant;VAR VATAmountLine@1000000001 : TEMPORARY Record 290);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(VATAmountLine);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateVATAmountLine(DocLineBuffer, VATAmountLine);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR VATAmountLine@1000000000 : Record 290);
    VAR
      CheckTemporary@1000000002 : Codeunit 70008;
    BEGIN
      CheckTemporary.IsTemporary(VATAmountLine, TRUE);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateVATAmountLine@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR VATAmountLine@1000000000 : Record 290);
    BEGIN
      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          VATAmountLine.INIT;
          VATAmountLine."VAT Identifier" := "VAT Identifier";
          VATAmountLine."VAT Calculation Type" := "VAT Calculation Type";
          VATAmountLine."Tax Group Code" := "Tax Group Code";
          VATAmountLine."VAT %" := "VAT %";
          VATAmountLine."VAT Base" := Amount;
          VATAmountLine."Amount Including VAT" := "Amount Including VAT";
          VATAmountLine."Line Amount" := "Line Amount";
          IF "Allow Invoice Disc." THEN
            VATAmountLine."Inv. Disc. Base Amount" := "Line Amount";
          VATAmountLine."Invoice Discount Amount" := "Inv. Discount Amount";
          VATAmountLine."VAT Clause Code" := "VAT Clause Code";
          IF ("VAT %" <> 0) OR ("VAT Clause Code" <> '') OR (Amount <> "Amount Including VAT") THEN
            VATAmountLine.InsertLine;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70002 ForNAV Get Vat Clause
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TryGetVATClause@1000000000 : Integer;

    PROCEDURE GetVATClauses@1000000000(VAR VATAmountLine@1000000001 : TEMPORARY Record 290;VAR VATClause@1000000000 : Record 560;LanguageCode@1000000002 : Code[10]);
    BEGIN
      WITH VATAmountLine DO
        IF FINDSET THEN REPEAT
          TryGetVATClauseText(VATClause, "VAT Clause Code", LanguageCode);
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE TryGetVATClauseText@1000000002(VAR VATClausePar@1000000000 : Record 560;VATClauseCode@1000000002 : Code[10];LanguageCode@1000000003 : Code[10]);
    VAR
      VATClause@1000000001 : Record 560;
    BEGIN
      IF NOT VATClause.GET(VATClauseCode) THEN
        EXIT;

      VATClause.TranslateDescription(LanguageCode);

      VATClausePar := VATClause;
      IF VATClausePar.INSERT THEN;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70003 ForNAV Update No. Printed
{
  OBJECT-PROPERTIES
  {
    Date=09/14/17;
    Time=12:08:51 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm,
                TableData 38=rm,
                TableData 110=rm,
                TableData 112=rm,
                TableData 114=rm,
                TableData 120=rm,
                TableData 122=rm,
                TableData 124=rm;
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE UpdateNoPrinted@1000000001(Rec@1000000000 : Variant;Preview@1000 : Boolean);
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      TestValidDociFace@1000000002 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      IF Preview THEN
        EXIT;

      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindAndUpdateField(RecRef);
    END;

    LOCAL PROCEDURE FindAndUpdateField@1000000003(VAR RecRef@1000000000 : RecordRef);
    VAR
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
      NoPrinted@1000000004 : Integer;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'No. Printed');
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := RecRef.FIELD(Field."No.");
      NoPrinted := FldRef.VALUE;
      NoPrinted +=1;
      FldRef.VALUE := NoPrinted;
      RecRef.MODIFY;
      COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70004 ForNAV Get Sales Tax Details
{
  OBJECT-PROPERTIES
  {
    Date=12/12/17;
    Time=12:25:24 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetSalesTax@1000000000(Rec@1000000000 : Variant;VAR SalesTaxBuffer@1000000001 : TEMPORARY Record 70998);
    VAR
      DocLineBuffer@1000000006 : TEMPORARY Record 70999;
      RecRefLib@1000000002 : Codeunit 70090;
      TestValidDociFace@1000000004 : Codeunit 70080;
      RecRef@1000000003 : RecordRef;
      LineRec@1000000005 : RecordRef;
    BEGIN
      ThrowErrorIfNotTemp(SalesTaxBuffer);
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      TestValidDociFace.ThrowErrorIfNotValid(RecRef);
      FindLinesRecRef(DocLineBuffer, RecRef, LineRec);
      CreateSalesTaxDetails(DocLineBuffer, SalesTaxBuffer);
    END;

    LOCAL PROCEDURE ThrowErrorIfNotTemp@1000000001(VAR SalesTaxBuffer@1000000000 : Record 70998);
    VAR
      CheckTemporary@1000000001 : Codeunit 70008;
    BEGIN
      CheckTemporary.IsTemporary(SalesTaxBuffer, TRUE);
    END;

    LOCAL PROCEDURE FindLinesRecRef@1000000003(VAR DocLineBuffer@1000000004 : Record 70999;VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000001 : RecordRef);
    VAR
      RecRefLib@1000000002 : Codeunit 70090;
      FldRef@1000000003 : FieldRef;
    BEGIN
      LineRec.OPEN(RecRef.NUMBER + 1);

      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'No.');
      RecRefLib.FindAndFilterieldNo(RecRef, LineRec, FldRef, 'Document Type');
      IF LineRec.FINDSET THEN REPEAT
        DocLineBuffer.CreateForRecRef(LineRec);
      UNTIL LineRec.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateSalesTaxDetails@1000000002(VAR DocLineBuffer@1000000001 : Record 70999;VAR SalesTaxBuffer@1000000000 : Record 70998);
    BEGIN
      SalesTaxBuffer.INIT;
      SalesTaxBuffer.INSERT;

      WITH DocLineBuffer DO
        IF FINDSET THEN REPEAT
          IF "VAT %" = 0 THEN
            SalesTaxBuffer."Exempt Amount" := SalesTaxBuffer."Exempt Amount" + Amount
          ELSE
            SalesTaxBuffer."Taxable Amount" := SalesTaxBuffer."Taxable Amount" + Amount;
          SalesTaxBuffer.MODIFY;
        UNTIL NEXT = 0;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70005 ForNAV Detect Localization
{
  OBJECT-PROPERTIES
  {
    Date=07/20/17;
    Time=[ 7:43:26 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CheckLocalizationBasedOnTables@1(VAR ForNAVSetup@1000 : Record 70000);
    VAR
      AllObjWithCaption@1001 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 10000);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::"North America";
          EXIT;
        END;
        SETRANGE("Object Type", "Object Type"::Table);
        SETRANGE("Object ID", 11000, 49999);
        IF NOT ISEMPTY THEN BEGIN
          ForNAVSetup.Localization := ForNAVSetup.Localization::Other;
          EXIT;
        END;

        ForNAVSetup.Localization := ForNAVSetup.Localization::"World Wide";

      END;
    END;

    PROCEDURE ValidateCurrentLocalization@2(ForNAVSetup@1000 : Record 70000) : Boolean;
    VAR
      ForNAVSetupSetLocalization@1001 : Record 70000;
    BEGIN
      CheckLocalizationBasedOnTables(ForNAVSetupSetLocalization);
      EXIT(ForNAVSetupSetLocalization.Localization = ForNAVSetup.Localization);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70006 ForNAV Read Watermarks
{
  OBJECT-PROPERTIES
  {
    Date=09/12/17;
    Time=11:59:17 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ReadFromFile@1(VAR ForNAVSetup@1004 : Record 70000;Which@1003 : Integer) : Boolean;
    VAR
      TempBlob@1002 : TEMPORARY Record 99008535;
      FileMgt@1001 : Codeunit 419;
      FileName@1000 : Text;
    BEGIN
      FileName := FileMgt.BLOBImport(TempBlob,'');

      WITH ForNAVSetup DO
        IF FileName <> '' THEN BEGIN
          CASE Which OF
            FIELDNO(Logo):
              BEGIN
                Logo := TempBlob.Blob;
                "Logo File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO("Document Watermark"):
              BEGIN
               "Document Watermark" := TempBlob.Blob;
                "Document Watermark File Name" := GetFileNameFromFile(FileName);
              END;
            FIELDNO("List Report Watermark"):
              BEGIN
                "List Report Watermark" := TempBlob.Blob;
                "List Report Watermark File N." := GetFileNameFromFile(FileName);
              END;
          END;
          EXIT(TRUE);
        END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetFileNameFromFile@3(Value@1000 : Text) : Text;
    VAR
      LastPos@1001 : Integer;
      i@1002 : Integer;
    BEGIN
      WHILE i < STRLEN(Value) DO BEGIN
        i := i + 1;
        IF Value[i] = '\' THEN
          LastPos := i;
      END;

      EXIT(COPYSTR(Value, LastPos + 1));
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70007 ForNAV Get No. of Copies
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=12:47:50 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetNoOfCopies@1000000001(Rec@1000000000 : Variant) : Integer;
    VAR
      RecRefLib@1000000003 : Codeunit 70090;
      TestValidDociFace@1000000002 : Codeunit 70080;
      RecRef@1000000001 : RecordRef;
    BEGIN
      RecRefLib.ConvertToRecRef(Rec, RecRef);
      IF NOT TestValidDociFace.CheckValid(RecRef) THEN
        EXIT(0);

      EXIT(FindNoOfCopiesFromBillToCustomerNo(RecRef));
    END;

    LOCAL PROCEDURE FindNoOfCopiesFromBillToCustomerNo@1000000003(VAR RecRef@1000000000 : RecordRef) : Integer;
    VAR
      Customer@1000000002 : Record 18;
      Field@1000000001 : Record 2000000041;
      FldRef@1000000003 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, 'Bill-to Customer No.');
      IF NOT Field.FINDFIRST THEN
        EXIT(0);

      FldRef := RecRef.FIELD(Field."No.");
      Customer.GET(FldRef.VALUE);
      EXIT(Customer."Invoice Copies");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70008 ForNAV Check Temporary
{
  OBJECT-PROPERTIES
  {
    Date=12/12/17;
    Time=[ 2:30:31 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE IsTemporary@1000000001(Rec@1000000001 : Variant;ThrowError@1000000000 : Boolean) : Boolean;
    VAR
      RecRef@1000000002 : RecordRef;
      RecordRefLibrary@1000000003 : Codeunit 70090;
      RecordShouldBeTempErr@1000000004 : TextConst 'ENU=The Record Variable (%1) must be temporary when callng this API.';
    BEGIN
      RecordRefLibrary.ConvertToRecRef(Rec, RecRef);
      IF RecRef.ISTEMPORARY THEN
        EXIT(FALSE);

      IF ThrowError THEN
        ERROR(RecordShouldBeTempErr, RecRef.NAME);

      EXIT(TRUE);
    END;

    BEGIN
    {
      We use this codeunit because ReportsForNAV is backwards compatible with NAV 2015. This version does not support ISTEMPORARY on record variables
    }
    END.
  }
}

OBJECT Codeunit 70009 ForNAV First Time Setup
{
  OBJECT-PROPERTIES
  {
    Date=09/12/17;
    Time=[ 1:17:24 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            IF CheckIfSetupExists THEN
              EXIT;

            AskForDefault;
            RunWizardIfSetupDoesNotExist;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE CheckIfSetupExists@2() : Boolean;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      EXIT(ForNAVSetup.GET);
    END;

    LOCAL PROCEDURE AskForDefault@3();
    VAR
      SetDefaultsQst@1000 : TextConst 'ENU=Do you want to setup ForNAV with default values?';
      ForNAVSetup@1001 : Record 70000;
    BEGIN
      IF NOT CONFIRM(SetDefaultsQst, TRUE) THEN
        EXIT;

      ForNAVSetup.InitSetup;
      ForNAVSetup.CreateWebService;
      ForNAVSetup.ReplaceReportSelection(TRUE);
      COMMIT;
    END;

    LOCAL PROCEDURE RunWizardIfSetupDoesNotExist@4();
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      PAGE.RUNMODAL(PAGE::"ForNAV Setup Wizard");

      IF ForNAVSetup.GET THEN
        COMMIT;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70019 ForNAV Notifications
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Codeunit,1,OnAfterFindPrinter,"",Skip,Skip)]
    LOCAL PROCEDURE OnFindPrinter@2(ReportID@1000 : Integer;VAR PrinterName@1001 : Text[250]);
    BEGIN
      ShowSetupNotification;
    END;

    LOCAL PROCEDURE ShowSetupNotification@1();
    VAR
      MyNotifications@1006 : Record 1518;
      ForNAVSetup@1001 : Record 70000;
      NotificationIDs@1004 : Codeunit 70022;
      MyNotification@1000 : Notification;
      ForNAVNotSetup@1002 : TextConst 'ENU=ForNAV is installed but not setup. Do you want to do this now?';
      Yes@1003 : TextConst 'ENU=Yes';
      NoAndDontAskAgain@1005 : TextConst 'ENU=No, and please don''t remind me again.';
    BEGIN
      IF ForNAVSetup.GET THEN
        EXIT;

      IF NOT MyNotifications.IsEnabled(NotificationIDs.SetupForNAV) THEN
        EXIT;

      MyNotification.ID := NotificationIDs.SetupForNAV;
      MyNotification.MESSAGE := ForNAVNotSetup;
      MyNotification.ADDACTION(Yes, CODEUNIT::"ForNAV Notification Actions", 'SetupForNAV');
      MyNotification.ADDACTION(NoAndDontAskAgain, CODEUNIT::"ForNAV Notification Actions", 'DisableSetup');
      MyNotification.SEND;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70020 ForNAV Notification Actions
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2(VAR MyNotification@1000 : Notification);
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"ForNAV First Time Setup");
    END;

    PROCEDURE DisableSetup@1(VAR MyNotification@1000 : Notification);
    VAR
      MyNotifications@1001 : Record 1518;
      NotificationID@1002 : GUID;
    BEGIN
      MyNotifications.LOCKTABLE;
      NotificationID := MyNotification.ID;
      IF MyNotifications.GET(USERID, NotificationID) THEN BEGIN
        MyNotifications.Enabled := FALSE;
        MyNotifications.MODIFY;
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70021 ForNAV Initialize Notification
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Page,1518,OnInitializingNotificationWithDefaultState,"",Skip,Skip)]
    LOCAL PROCEDURE OnInitializingNotificationWithDefaultState@2();
    VAR
      MyNotifications@1000 : Record 1518;
      SetupForNAVTxt@1001 : TextConst 'ENU=Ask to setup ForNAV.';
      SetupForNAVDescriptionTxt@1002 : TextConst 'ENU=If you have ForNAV installed but don''t want to use it, switch off receiving the notification.';
      NotificationIDs@1003 : Codeunit 70022;
    BEGIN
      MyNotifications.InsertDefaultWithTableNum(NotificationIDs.SetupForNAV,
        SetupForNAVTxt,
        SetupForNAVDescriptionTxt,
        DATABASE::"ForNAV Setup");
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70022 ForNAV Notification IDs
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE SetupForNAV@2() : Text;
    BEGIN
      EXIT('cf8edf36-45c2-44c9-8367-cac5748bd597');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70029 ForNAV Replace Report Sel.
{
  OBJECT-PROPERTIES
  {
    Date=07/20/17;
    Time=[ 8:16:47 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
            ReplaceSalesOrderConfirmation;
            ReplaceSalesInvoice;
            ReplaceSalesCreditMemo;
            ReplaceSalesShipment;
            ReplaceSalesQuote;
            ReplacePurchaseOrder;
            ReplacePurchaseInvoice;
            ReplacePurchaseQuote;
            ReplacePurchaseCreditMemo;
            //ReplaceReminder;
          END;

  }
  CODE
  {

    LOCAL PROCEDURE ReplaceSalesOrderConfirmation@1000000001();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Order Confirmation', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesInvoice@1000000000();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesCreditMemo@1000000002();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Credit Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesShipment@1000000009();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Shipment");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Shipment";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Shipment', '');
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceSalesQuote@1000000008();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"S.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"S.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Sales Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseOrder@1000000005();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Order");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Order";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Order', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseQuote@1000000010();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Quote");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Quote";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Quote', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseInvoice@1000000003();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Invoice");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Invoice";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Invoice', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplacePurchaseCreditMemo@1000000007();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::"P.Cr.Memo");
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::"P.Cr.Memo";
        Sequence := '1';
        "Report ID" := FindReportID('Purchase Cr. Memo', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE ReplaceReminder@1000000006();
    VAR
      ReportSelections@1000000000 : Record 77;
    BEGIN
      WITH ReportSelections DO BEGIN
        SETRANGE(Usage, Usage::Reminder);
        IF NOT ISEMPTY THEN
          DELETEALL;

        Usage := Usage::Reminder;
        Sequence := '1';
        "Report ID" := FindReportID('Reminder', GetPrefix);
        INSERT;
      END;
    END;

    LOCAL PROCEDURE FindReportID@1000000004(ReportName@1000000001 : Text;Prefix@1000 : Text) : Integer;
    VAR
      AllObjWithCaption@1000000000 : Record 2000000058;
    BEGIN
      WITH AllObjWithCaption DO BEGIN
        SETRANGE("Object Type", "Object Type"::Report);
        SETRANGE("Object Name", 'ForNAV ' + Prefix +ReportName);
        FINDFIRST;
        EXIT("Object ID");
      END;
    END;

    LOCAL PROCEDURE GetPrefix@1() : Text;
    VAR
      ForNAVSetup@1000 : Record 70000;
    BEGIN
      ForNAVSetup.GET;
      IF ForNAVSetup."VAT Amount Specification" = ForNAVSetup."VAT Amount Specification"::"N/A. (Sales Tax)" THEN
        EXIT('Tax ');

      EXIT('VAT ');
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70080 ForNAV Test Valid Doc iFace
{
  OBJECT-PROPERTIES
  {
    Date=12/12/17;
    Time=12:26:24 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ThrowErrorIfNotValid@1000000000(VAR RecRef@1000000000 : RecordRef);
    VAR
      NotValidTableErr@1000000002 : TextConst 'ENU=This table (%1) is not supported for this function.';
    BEGIN
      IF NOT CheckValid(RecRef) THEN
        ERROR(NotValidTableErr, RecRef.CAPTION);
    END;

    PROCEDURE CheckValid@1000000001(VAR RecRef@1000000000 : RecordRef) : Boolean;
    BEGIN
      CASE RecRef.NUMBER OF
        DATABASE::"Sales Header":
          EXIT(TRUE);
        DATABASE::"Sales Shipment Header":
          EXIT(TRUE);
        DATABASE::"Sales Invoice Header":
          EXIT(TRUE);
        DATABASE::"Sales Cr.Memo Header":
          EXIT(TRUE);
        DATABASE::"Purchase Header":
          EXIT(TRUE);
        DATABASE::"Purch. Rcpt. Header":
          EXIT(TRUE);
        DATABASE::"Purch. Inv. Header":
          EXIT(TRUE);
        DATABASE::"Purch. Cr. Memo Hdr.":
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70090 ForNAV RecordRef Library
{
  OBJECT-PROPERTIES
  {
    Date=05/01/17;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE ConvertToRecRef@1000000002(VAR Rec@1000000000 : Variant;RecRef@1000000001 : RecordRef);
    VAR
      WrongDataTypeErr@1000000002 : TextConst 'ENU=Runtime Error: Wrong Datatype. Please contact your ForNAV reseller.';
    BEGIN
      CASE TRUE OF
        Rec.ISRECORDREF:
          RecRef := Rec;
        Rec.ISRECORD:
          RecRef.GETTABLE(Rec);
        ELSE
          ERROR(WrongDataTypeErr);
      END;
    END;

    PROCEDURE FindAndFilterieldNo@1000000003(VAR RecRef@1000000000 : RecordRef;VAR LineRec@1000000004 : RecordRef;VAR FldRef@1000000001 : FieldRef;Value@1000000005 : Text);
    VAR
      Field@1000000003 : Record 2000000041;
      DocumentNoField@1000000002 : FieldRef;
    BEGIN
      Field.SETRANGE(TableNo, RecRef.NUMBER);
      Field.SETRANGE(FieldName, Value);
      IF NOT Field.FINDFIRST THEN
        EXIT;

      DocumentNoField := RecRef.FIELD(Field."No.");

      Field.RESET;
      Field.SETRANGE(TableNo, RecRef.NUMBER + 1);
      Field.SETRANGE("No.", Field."No.");
      IF NOT Field.FINDFIRST THEN
        EXIT;

      FldRef := LineRec.FIELD(Field."No.");
      FldRef.SETRANGE(DocumentNoField.VALUE);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70206 ForNAV Trial Balance
{
  OBJECT-PROPERTIES
  {
    Date=09/05/17;
    Time=[ 5:00:00 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      SingleQuote@1000 : Char;
      Char127@1001 : Char;
      Text000@1020000 : TextConst 'ENU=The StringPrintLength function in CodeUnit 70206 only works for font sizes from 7 through 10.';

    PROCEDURE InitGlobals@1();
    BEGIN
      SingleQuote := 39;
      Char127 := 127;
    END;

    PROCEDURE StringPrintLength@2(PrintString@1001 : Text[250];PointSize@1002 : Integer) Length@1000 : Integer;
    VAR
      i@1003 : Integer;
      OneCharLen@1004 : Integer;
    BEGIN
      InitGlobals;
      Length := 0;
      FOR i := 1 TO STRLEN(PrintString) DO BEGIN
        CASE PointSize OF
          7:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 46;
              'i','j','l':
                OneCharLen := 55;
              '|':
                OneCharLen := 61;
              '!':
                OneCharLen := 63;
              ' ',',','.','/','\',':',';','I','[',']','f','t':
                OneCharLen := 68;
              '`','r','{','}','(',')','-':
                OneCharLen := 83;
              '"':
                OneCharLen := 87;
              '*':
                OneCharLen := 95;
              '^':
                OneCharLen := 115;
              'y':
                OneCharLen := 116;
              'v','x':
                OneCharLen := 121;
              'J','c','k','s','z':
                OneCharLen := 123;
              '+','<','>','=','~':
                OneCharLen := 145;
              'F','T','Z':
                OneCharLen := 151;
              'Y':
                OneCharLen := 159;
              '&','A','B','E','K','P','S','V','X':
                OneCharLen := 164;
              'C','D','H','w':
                OneCharLen := 174;
              'N','R','U':
                OneCharLen := 178;
              Char127:
                OneCharLen := 185;
              'G':
                OneCharLen := 190;
              'Q':
                OneCharLen := 192;
              '%','M','O','m':
                OneCharLen := 200;
              'W':
                OneCharLen := 238;
              '@':
                OneCharLen := 250;
              ELSE
                OneCharLen := 138;
            END;
          8:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 54;
              'i','j','l':
                OneCharLen := 64;
              '|','!':
                OneCharLen := 72;
              ' ',',','.','/','\',':',';','I','[',']','f','t':
                OneCharLen := 78;
              '`','r','{','}','(',')','-':
                OneCharLen := 94;
              '"':
                OneCharLen := 100;
              '*':
                OneCharLen := 110;
              '^':
                OneCharLen := 130;
              'y':
                OneCharLen := 138;
              'x':
                OneCharLen := 140;
              'J','c','k','s','v','z':
                OneCharLen := 144;
              '+','<','>','=','~':
                OneCharLen := 166;
              'F','T','Z':
                OneCharLen := 172;
              'Y':
                OneCharLen := 186;
              '&','A','B','E','K','P','S','V','X':
                OneCharLen := 190;
              'C','D','H','N','R','U','w':
                OneCharLen := 204;
              Char127:
                OneCharLen := 212;
              'G','O','Q':
                OneCharLen := 220;
              'M','m':
                OneCharLen := 236;
              '%':
                OneCharLen := 250;
              'W':
                OneCharLen := 270;
              '@':
                OneCharLen := 288;
              ELSE
                OneCharLen := 158;
            END;
          9:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 62;
              'i','j','l':
                OneCharLen := 70;
              '|':
                OneCharLen := 78;
              '!':
                OneCharLen := 82;
              ' ',',','.','/','\',':',';','I','[',']','f','t':
                OneCharLen := 88;
              '`','r','{','}','(',')','-':
                OneCharLen := 106;
              '"':
                OneCharLen := 112;
              '*':
                OneCharLen := 124;
              '^':
                OneCharLen := 144;
              'y':
                OneCharLen := 156;
              'x':
                OneCharLen := 158;
              'J','c','k','s','v','z':
                OneCharLen := 160;
              '+','<','>','=','~':
                OneCharLen := 186;
              'F','T','Z':
                OneCharLen := 196;
              'X':
                OneCharLen := 210;
              'Y':
                OneCharLen := 212;
              '&','A','B','E','K','P','S','V':
                OneCharLen := 212;
              'w':
                OneCharLen := 224;
              'C','D','H','N','R','U':
                OneCharLen := 230;
              Char127:
                OneCharLen := 240;
              'G','O','Q':
                OneCharLen := 250;
              'M','m':
                OneCharLen := 266;
              '%':
                OneCharLen := 282;
              'W':
                OneCharLen := 302;
              '@':
                OneCharLen := 322;
              ELSE
                OneCharLen := 176;
            END;
          10:
            CASE PrintString[i] OF
              SingleQuote:
                OneCharLen := 68;
              'i','j','l':
                OneCharLen := 78;
              '|':
                OneCharLen := 88;
              '!',',','.',':',';':
                OneCharLen := 96;
              ' ','/','\','I','[',']','f','t':
                OneCharLen := 98;
              '`','r','{','}','(',')','-':
                OneCharLen := 116;
              '"':
                OneCharLen := 126;
              '*':
                OneCharLen := 138;
              '^':
                OneCharLen := 166;
              'y':
                OneCharLen := 174;
              'J','c','k','s','v','x','z':
                OneCharLen := 176;
              '+','<','>','=','~':
                OneCharLen := 206;
              'F','T','Z':
                OneCharLen := 214;
              '&','A','B','E','K','P','S','V','X','Y':
                OneCharLen := 236;
              'C','D','H','N','R','U','w':
                OneCharLen := 254;
              Char127:
                OneCharLen := 266;
              'G','O','Q':
                OneCharLen := 274;
              'M','m':
                OneCharLen := 292;
              '%':
                OneCharLen := 314;
              'W':
                OneCharLen := 332;
              '@':
                OneCharLen := 358;
              ELSE
                OneCharLen := 196;
            END;
          ELSE
            ERROR(Text000);
        END;
        Length := Length + OneCharLen;
      END;
      EXIT((Length + 80) DIV 100);
    END;

    PROCEDURE SplitPrintLine@3(VAR PrintString@1000 : Text[250];VAR PrintString2@1001 : Text[250];SpaceOnPrintLine@1002 : Integer;PointSize@1003 : Integer);
    VAR
      OneWord@1004 : Text[250];
      s@1005 : Integer;
      e@1006 : Integer;
    BEGIN
      PrintString2 := '';
      WHILE StringPrintLength(PrintString,PointSize) > SpaceOnPrintLine DO BEGIN
        IF PrintString2 = '' THEN BEGIN
          s := 1;
          WHILE (s < STRLEN(PrintString)) AND (PrintString[s] = ' ') DO BEGIN
            PrintString2 := PrintString2 + ' ';
            s := s + 1;
          END;
        END ELSE BEGIN
          s := 1;
          WHILE (s < STRLEN(PrintString)) AND (PrintString[s] = ' ') DO
            s := s + 1;
        END;
        IF PrintString[s] = ' ' THEN
          EXIT;
        OneWord := '';
        e := s;
        WHILE (e < STRLEN(PrintString)) AND (PrintString[e] <> ' ') DO BEGIN
          OneWord := OneWord + COPYSTR(PrintString,e,1);
          e := e + 1;
        END;
        IF PrintString[e] <> ' ' THEN
          EXIT;
        IF StringPrintLength(PrintString2 + OneWord,PointSize) > SpaceOnPrintLine THEN
          EXIT;
        PrintString2 := PrintString2 + OneWord + ' ';
        WHILE (e < STRLEN(PrintString)) AND (PrintString[e] = ' ') DO
          e := e + 1;
        PrintString := DELSTR(PrintString,s,e - s);
      END;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

      This codeunit is based on 10025 Paragraph Handling.
    }
    END.
  }
}

OBJECT Codeunit 70219 ForNAV Aging Calculation
{
  OBJECT-PROPERTIES
  {
    Date=12/06/17;
    Time=10:17:26 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetAging@1000000001(Rec@1000000000 : Variant;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CustomerAging@1000000002 : Codeunit 70220;
      VendorAging@1000000004 : Codeunit 70221;
    BEGIN
      CASE GetAccountType(Rec) OF
        AgingBuffer."Account Type"::Customer:
          CustomerAging.GetAging(Rec, AgingBuffer, Args);
        AgingBuffer."Account Type"::Vendor:
          VendorAging.GetAging(Rec, AgingBuffer, Args);
      END;
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(Rec@1000000000 : Variant;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    VAR
      CustomerAging@1000000005 : Codeunit 70220;
      VendorAging@1000000006 : Codeunit 70221;
    BEGIN
      CASE GetAccountType(Rec) OF
        AgingBuffer."Account Type"::Customer:
          CustomerAging.GetAgingWithCurrency(Rec, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
        AgingBuffer."Account Type"::Vendor:
          VendorAging.GetAgingWithCurrency(Rec, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      END;
    END;

    LOCAL PROCEDURE GetAccountType@1000000000(Rec@1000000001 : Variant) : Integer;
    VAR
      AgingBuffer@1000000004 : Record 70220;
      RecordRefLibrary@1000000002 : Codeunit 70090;
      UnsupportedTableErr@1000000000 : TextConst 'ENU=Unsupported Table';
      RecRef@1000000003 : RecordRef;
    BEGIN
      RecordRefLibrary.ConvertToRecRef(Rec, RecRef);
      CASE RecRef.NUMBER OF
        DATABASE::Customer:
          EXIT(AgingBuffer."Account Type"::Customer);
        DATABASE::Vendor:
          EXIT(AgingBuffer."Account Type"::Vendor);
        ELSE
          ERROR(UnsupportedTableErr);;
      END;
    END;

    PROCEDURE UpdateCurrencyTotals@7(VAR AgingBuffer@1000000002 : Record 70220;VAR CurrAgingBuffer@1000000001 : Record 70220;VAR TempCurrency@1000000000 : TEMPORARY Record 4);
    VAR
      i@1000 : Integer;
    BEGIN
      CurrAgingBuffer.RESET;
      CurrAgingBuffer.SETRANGE("Currency Code", AgingBuffer."Currency Code");
      IF NOT TempCurrency.GET(AgingBuffer."Currency Code") THEN BEGIN
        TempCurrency.Code := AgingBuffer."Currency Code";
        TempCurrency.INSERT;
        CurrAgingBuffer."Entry No." :=  TempCurrency.COUNT;
        CurrAgingBuffer."Currency Code" := AgingBuffer."Currency Code";
        CurrAgingBuffer.Amount := AgingBuffer.Amount;
        CurrAgingBuffer.Balance := AgingBuffer.Balance;
        CurrAgingBuffer."Amount 1" := AgingBuffer."Amount 1";
        CurrAgingBuffer."Amount 2" := AgingBuffer."Amount 2";
        CurrAgingBuffer."Amount 3" := AgingBuffer."Amount 3";
        CurrAgingBuffer."Amount 4" := AgingBuffer."Amount 4";
        CurrAgingBuffer."Amount 5" := AgingBuffer."Amount 5";
        CurrAgingBuffer.INSERT;
      END ELSE BEGIN
        CurrAgingBuffer.SETRANGE("Currency Code", AgingBuffer."Currency Code");
        CurrAgingBuffer.FINDFIRST;
        CurrAgingBuffer.Amount += AgingBuffer.Amount;
        CurrAgingBuffer.Balance += AgingBuffer.Balance;
        CurrAgingBuffer."Amount 1" += AgingBuffer."Amount 1";
        CurrAgingBuffer."Amount 2" += AgingBuffer."Amount 2";
        CurrAgingBuffer."Amount 3" += AgingBuffer."Amount 3";
        CurrAgingBuffer."Amount 4" += AgingBuffer."Amount 4";
        CurrAgingBuffer."Amount 5" += AgingBuffer."Amount 5";
        CurrAgingBuffer.MODIFY;
        CurrAgingBuffer.RESET;
      END;
    END;

    PROCEDURE GetCurrencyCode@1000000009(Value@1000000000 : Code[10]) : Code[10];
    VAR
      GLSetup@1000000001 : Record 98;
    BEGIN
      IF Value <> '' THEN
        EXIT(Value);

      GLSetup.GET;
      EXIT(GLSetup."LCY Code");
    END;

    PROCEDURE MoveValuesToPeriod@1000000006(VAR AgingBuffer@1000000000 : Record 70220;PeriodIndex@1000000001 : Integer);
    VAR
      Fld@1000000004 : Record 2000000041;
      RecRef@1000000002 : RecordRef;
      FldRef@1000000003 : FieldRef;
    BEGIN
      RecRef.GETTABLE(AgingBuffer);
      Fld.SETRANGE(TableNo, RecRef.NUMBER);
      Fld.SETRANGE(FieldName, 'Amount ' + FORMAT(PeriodIndex));
      Fld.FINDFIRST;
      FldRef := RecRef.FIELD(Fld."No.");

      FldRef.VALUE := AgingBuffer.Balance;

      Fld.SETRANGE(FieldName, 'Amount ' + FORMAT(PeriodIndex) + ' (LCY)');
      Fld.FINDFIRST;
      FldRef := RecRef.FIELD(Fld."No.");

      FldRef.VALUE := AgingBuffer."Balance (LCY)";

      RecRef.SETTABLE(AgingBuffer);
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70220 ForNAV Customer Aging
{
  OBJECT-PROPERTIES
  {
    Date=12/06/17;
    Time=10:15:05 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempCustLedgEntry@1000000003 : TEMPORARY Record 21;

    PROCEDURE GetAging@1000000001(VAR Cust@1000000000 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CurrAgingBuffer@1000000004 : TEMPORARY Record 70220;
      TempCurrency@1000000002 : TEMPORARY Record 4;
    BEGIN
      GetAgingWithCurrency(Cust, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(VAR Cust@1000000000 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    BEGIN
      ClearData(AgingBuffer);
      GetBasedOnDetailedEntry(Cust, Args);
      GetBasedOnOpenEntry(Cust, Args);
      CreateAgingBuffer(Cust, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      AgingBuffer.SetCaptions(Args);
    END;

    LOCAL PROCEDURE GetBasedOnDetailedEntry@1000000002(VAR Cust@1000000002 : Record 18;VAR Args@1000000003 : Record 70219);
    VAR
      DetailedCustLedgEntry@1000000000 : Record 379;
      CustLedgEntry@1000000001 : Record 21;
    BEGIN
      WITH DetailedCustLedgEntry DO BEGIN
        SETCURRENTKEY("Customer No.", "Posting Date", "Entry Type", "Currency Code");
        SETRANGE("Customer No.", Cust."No.");
        SETRANGE("Entry Type", DetailedCustLedgEntry."Entry Type"::Application);
        SETRANGE("Posting Date", 0D, Args."Ending Date");
        SETFILTER("Posting Date", '%1..', Args."Ending Date" + 1);

        IF FINDSET THEN REPEAT
          IF CustLedgEntry.GET("Cust. Ledger Entry No.") THEN
            IF CustLedgEntry.Open THEN BEGIN
              CustLedgEntry.SETRANGE("Date Filter",0D, Args."Ending Date");
              CustLedgEntry.CALCFIELDS("Remaining Amount");
              IF CustLedgEntry."Remaining Amount" <> 0 THEN
                InsertTemp(CustLedgEntry);
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetBasedOnOpenEntry@1000000003(VAR Cust@1000000000 : Record 18;VAR Args@1000000002 : Record 70219);
    VAR
      CustLedgEntry@1000000001 : Record 21;
    BEGIN
      WITH CustLedgEntry DO BEGIN
        SETCURRENTKEY("Customer No.", Open, Positive, "Due Date", "Currency Code");
        SETRANGE("Customer No.", Cust."No.");
        SETRANGE(Open, TRUE);

        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
          SETRANGE("Posting Date", 0D, Args."Ending Date");
          SETRANGE("Date Filter", 0D, Args."Ending Date");
        END;

        IF FINDSET THEN REPEAT
        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
           CALCFIELDS("Remaining Amt. (LCY)");
           IF "Remaining Amt. (LCY)" <> 0 THEN
             InsertTemp(CustLedgEntry);
         END ELSE
           InsertTemp(CustLedgEntry);
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateAgingBuffer@1000000015(VAR Cust@1000000002 : Record 18;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000000 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000006 : TEMPORARY Record 4);
    VAR
      DetailedCustLedgEntry@1000000004 : Record 379;
      AgingCalculation@1000000007 : Codeunit 70219;
      PeriodIndex@1000000005 : Integer;
    BEGIN
      WITH TempCustLedgEntry DO
        IF FINDSET THEN REPEAT
          AgingBuffer.INIT;
          AgingBuffer."Entry No." := "Entry No.";
          AgingBuffer."Account No." := "Customer No.";
          AgingBuffer."Credit Limit (LCY)" := Cust."Credit Limit (LCY)";
          IF Args."Print Amount In Cust. Curr." THEN
            AgingBuffer."Currency Code" := AgingCalculation.GetCurrencyCode("Currency Code");
          AgingBuffer."Document No." := "Document No.";
          AgingBuffer."External Document No." := "External Document No.";
          AgingBuffer."Document Type" := "Document Type";
          AgingBuffer."Document Date" := "Document Date";
          AgingBuffer."Posting Date" := "Posting Date";
          AgingBuffer."Due Date" := "Due Date";

          DetailedCustLedgEntry.SETRANGE("Cust. Ledger Entry No.",TempCustLedgEntry."Entry No.");
          IF DetailedCustLedgEntry.FINDSET THEN REPEAT
            IF (DetailedCustLedgEntry."Entry Type" = DetailedCustLedgEntry."Entry Type"::"Initial Entry") AND
               (TempCustLedgEntry."Posting Date" > Args."Ending Date") AND (Args."Aging By" <> Args."Aging By"::"Posting Date")
            THEN BEGIN
              IF TempCustLedgEntry."Document Date" <= Args."Ending Date" THEN
                DetailedCustLedgEntry."Posting Date" :=  TempCustLedgEntry."Document Date"
              ELSE
                IF (TempCustLedgEntry."Due Date" <= Args."Ending Date") AND (Args."Aging By" = Args."Aging By"::"Due Date") THEN
                  DetailedCustLedgEntry."Posting Date" := TempCustLedgEntry."Due Date";
            END;
            IF (DetailedCustLedgEntry."Posting Date" <= Args."Ending Date") OR
               (TempCustLedgEntry.Open AND (Args."Aging By" = Args."Aging By"::"Due Date") AND (TempCustLedgEntry."Due Date" > Args."Ending Date") AND (TempCustLedgEntry."Posting Date" <= Args."Ending Date"))
            THEN BEGIN
              IF DetailedCustLedgEntry."Entry Type" IN
                 [DetailedCustLedgEntry."Entry Type"::"Initial Entry",
                  DetailedCustLedgEntry."Entry Type"::"Unrealized Loss",
                  DetailedCustLedgEntry."Entry Type"::"Unrealized Gain",
                  DetailedCustLedgEntry."Entry Type"::"Realized Loss",
                  DetailedCustLedgEntry."Entry Type"::"Realized Gain",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                  DetailedCustLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
              THEN BEGIN
                IF Args."Print Amount In Cust. Curr." THEN
                  AgingBuffer.Amount += DetailedCustLedgEntry.Amount
                ELSE
                  AgingBuffer.Amount += DetailedCustLedgEntry."Amount (LCY)";
                AgingBuffer."Amount (LCY)" += DetailedCustLedgEntry."Amount (LCY)";
              END;

              IF DetailedCustLedgEntry."Posting Date" <= Args."Ending Date" THEN BEGIN
                IF Args."Print Amount In Cust. Curr." THEN
                  AgingBuffer.Balance += DetailedCustLedgEntry.Amount
                ELSE
                  AgingBuffer.Balance += DetailedCustLedgEntry."Amount (LCY)";
                AgingBuffer."Balance (LCY)" += DetailedCustLedgEntry."Amount (LCY)";

              END;
            END;
          UNTIL DetailedCustLedgEntry.NEXT = 0;

          IF AgingBuffer.Balance <> 0 THEN BEGIN
            CASE Args."Aging By" OF
             Args."Aging By"::"Due Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Due Date");
             Args."Aging By"::"Posting Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Posting Date");
             Args."Aging By"::"Document Date":
               BEGIN
                 IF AgingBuffer."Document Date" > Args."Ending Date" THEN BEGIN
                   AgingBuffer.Balance := 0;
                   AgingBuffer."Balance (LCY)" := 0;
                   AgingBuffer."Document Date" := AgingBuffer."Posting Date";
                 END;
                 PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Document Date");
               END;
            END;

            AgingCalculation.MoveValuesToPeriod(AgingBuffer, PeriodIndex);

            AgingBuffer.INSERT;
            IF Args."Print Amount In Cust. Curr." THEN
              AgingCalculation.UpdateCurrencyTotals(AgingBuffer, CurrAgingBuffer, TempCurrency);
         END;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE InsertTemp@1000000004(VAR CustLedgEntry@1000000000 : Record 21);
    BEGIN
      WITH TempCustLedgEntry DO BEGIN
        IF GET(CustLedgEntry."Entry No.") THEN
          EXIT;

        TempCustLedgEntry := CustLedgEntry;

        INSERT;
      END;
    END;

    LOCAL PROCEDURE ClearData@1000000000(VAR AgingBuffer@1000000001 : Record 70220);
    BEGIN
      AgingBuffer.RESET;
      AgingBuffer.DELETEALL;
      TempCustLedgEntry.RESET;
      TempCustLedgEntry.DELETEALL;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Codeunit 70221 ForNAV Vendor Aging
{
  OBJECT-PROPERTIES
  {
    Date=12/06/17;
    Time=10:16:32 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempVendorLedgerEntry@1000000003 : TEMPORARY Record 25;

    PROCEDURE GetAging@1000000001(VAR Vend@1000000000 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR Args@1000000003 : Record 70219);
    VAR
      CurrAgingBuffer@1000000004 : TEMPORARY Record 70220;
      TempCurrency@1000000002 : TEMPORARY Record 4;
    BEGIN
      GetAgingWithCurrency(Vend, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
    END;

    PROCEDURE GetAgingWithCurrency@1000000005(VAR Vend@1000000000 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000002 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000004 : TEMPORARY Record 4);
    BEGIN
      ClearData(AgingBuffer);
      GetBasedOnDetailedEntry(Vend, Args);
      GetBasedOnOpenEntry(Vend, Args);
      CreateAgingBuffer(Vend, AgingBuffer, CurrAgingBuffer, Args, TempCurrency);
      AgingBuffer.SetCaptions(Args);
    END;

    LOCAL PROCEDURE GetBasedOnDetailedEntry@1000000002(VAR Vend@1000000002 : Record 23;VAR Args@1000000003 : Record 70219);
    VAR
      DetailedVendorLedgEntry@1000000000 : Record 380;
      VendorLedgerEntry@1000000001 : Record 25;
    BEGIN
      WITH DetailedVendorLedgEntry DO BEGIN
        SETCURRENTKEY("Vendor No.", "Posting Date", "Entry Type", "Currency Code");
        SETRANGE("Vendor No.", Vend."No.");
        SETRANGE("Entry Type", DetailedVendorLedgEntry."Entry Type"::Application);
        SETRANGE("Posting Date", 0D, Args."Ending Date");
        SETFILTER("Posting Date", '%1..', Args."Ending Date" + 1);

        IF FINDSET THEN REPEAT
          IF VendorLedgerEntry.GET("Vendor Ledger Entry No.") THEN
            IF VendorLedgerEntry.Open THEN BEGIN
              VendorLedgerEntry.SETRANGE("Date Filter",0D, Args."Ending Date");
              VendorLedgerEntry.CALCFIELDS("Remaining Amount");
              IF VendorLedgerEntry."Remaining Amount" <> 0 THEN
                InsertTemp(VendorLedgerEntry);
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetBasedOnOpenEntry@1000000003(VAR Vend@1000000000 : Record 23;VAR Args@1000000002 : Record 70219);
    VAR
      VendorLedgerEntry@1000000001 : Record 25;
    BEGIN
      WITH VendorLedgerEntry DO BEGIN
        SETCURRENTKEY("Vendor No.", Open, Positive, "Due Date", "Currency Code");
        SETRANGE("Vendor No.", Vend."No.");
        SETRANGE(Open, TRUE);

        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
          SETRANGE("Posting Date", 0D, Args."Ending Date");
          SETRANGE("Date Filter", 0D, Args."Ending Date");
        END;

        IF FINDSET THEN REPEAT
        IF Args."Aging By" = Args."Aging By"::"Posting Date" THEN BEGIN
           CALCFIELDS("Remaining Amt. (LCY)");
           IF "Remaining Amt. (LCY)" <> 0 THEN
             InsertTemp(VendorLedgerEntry);
         END ELSE
           InsertTemp(VendorLedgerEntry);
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateAgingBuffer@1000000015(VAR Vend@1000000002 : Record 23;VAR AgingBuffer@1000000001 : Record 70220;VAR CurrAgingBuffer@1000000000 : Record 70220;VAR Args@1000000003 : Record 70219;VAR TempCurrency@1000000006 : TEMPORARY Record 4);
    VAR
      DetailedVendorLedgEntry@1000000004 : Record 380;
      AgingCalculation@1000000007 : Codeunit 70219;
      PeriodIndex@1000000005 : Integer;
    BEGIN
      WITH TempVendorLedgerEntry DO
        IF FINDSET THEN REPEAT
          AgingBuffer.INIT;
          AgingBuffer."Entry No." := "Entry No.";
          AgingBuffer."Account No." := "Vendor No.";
      //    AgingBuffer."Customer Credit Limit (LCY)" := Vend."Credit Limit (LCY)";
          IF Args."Print Amount In Cust. Curr." THEN
            AgingBuffer."Currency Code" := AgingCalculation.GetCurrencyCode("Currency Code");
          AgingBuffer."Document No." := "Document No.";
          AgingBuffer."External Document No." := "External Document No.";
          AgingBuffer."Document Type" := "Document Type";
          AgingBuffer."Document Date" := "Document Date";
          AgingBuffer."Posting Date" := "Posting Date";
          AgingBuffer."Due Date" := "Due Date";

          DetailedVendorLedgEntry.SETRANGE("Vendor Ledger Entry No.",TempVendorLedgerEntry."Entry No.");
          IF DetailedVendorLedgEntry.FINDSET THEN REPEAT
            IF (DetailedVendorLedgEntry."Entry Type" = DetailedVendorLedgEntry."Entry Type"::"Initial Entry") AND
               (TempVendorLedgerEntry."Posting Date" > Args."Ending Date") AND (Args."Aging By" <> Args."Aging By"::"Posting Date")
            THEN BEGIN
              IF TempVendorLedgerEntry."Document Date" <= Args."Ending Date" THEN
                DetailedVendorLedgEntry."Posting Date" :=  TempVendorLedgerEntry."Document Date"
              ELSE
                IF (TempVendorLedgerEntry."Due Date" <= Args."Ending Date") AND (Args."Aging By" = Args."Aging By"::"Due Date") THEN
                  DetailedVendorLedgEntry."Posting Date" := TempVendorLedgerEntry."Due Date";
            END;
            IF (DetailedVendorLedgEntry."Posting Date" <= Args."Ending Date") OR
               (TempVendorLedgerEntry.Open AND (Args."Aging By" = Args."Aging By"::"Due Date") AND (TempVendorLedgerEntry."Due Date" > Args."Ending Date") AND (TempVendorLedgerEntry."Posting Date" <= Args."Ending Date"))
            THEN BEGIN
              IF DetailedVendorLedgEntry."Entry Type" IN
                 [DetailedVendorLedgEntry."Entry Type"::"Initial Entry",
                  DetailedVendorLedgEntry."Entry Type"::"Unrealized Loss",
                  DetailedVendorLedgEntry."Entry Type"::"Unrealized Gain",
                  DetailedVendorLedgEntry."Entry Type"::"Realized Loss",
                  DetailedVendorLedgEntry."Entry Type"::"Realized Gain",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount (VAT Adjustment)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Tolerance (VAT Adjustment)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Excl.)",
                  DetailedVendorLedgEntry."Entry Type"::"Payment Discount Tolerance (VAT Adjustment)"]
              THEN BEGIN
                IF Args."Print Amount In Cust. Curr." THEN
                  AgingBuffer.Amount += DetailedVendorLedgEntry.Amount
                ELSE
                  AgingBuffer.Amount += DetailedVendorLedgEntry."Amount (LCY)";
                AgingBuffer."Amount (LCY)" += DetailedVendorLedgEntry."Amount (LCY)";
              END;

              IF DetailedVendorLedgEntry."Posting Date" <= Args."Ending Date" THEN BEGIN
                IF Args."Print Amount In Cust. Curr." THEN
                  AgingBuffer.Balance += DetailedVendorLedgEntry.Amount
                ELSE
                  AgingBuffer.Balance += DetailedVendorLedgEntry."Amount (LCY)";
                AgingBuffer."Balance (LCY)" += DetailedVendorLedgEntry."Amount (LCY)";

              END;
            END;
          UNTIL DetailedVendorLedgEntry.NEXT = 0;

          IF AgingBuffer.Balance <> 0 THEN BEGIN
            CASE Args."Aging By" OF
             Args."Aging By"::"Due Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Due Date");
             Args."Aging By"::"Posting Date":
               PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Posting Date");
             Args."Aging By"::"Document Date":
               BEGIN
                 IF AgingBuffer."Document Date" > Args."Ending Date" THEN BEGIN
                   AgingBuffer.Balance := 0;
                   AgingBuffer."Balance (LCY)" := 0;
                   AgingBuffer."Document Date" := AgingBuffer."Posting Date";
                 END;
                 PeriodIndex := Args.GetPeriodIndex(AgingBuffer."Document Date");
               END;
            END;

            AgingCalculation.MoveValuesToPeriod(AgingBuffer, PeriodIndex);

            AgingBuffer.INSERT;
            IF Args."Print Amount In Cust. Curr." THEN
              AgingCalculation.UpdateCurrencyTotals(AgingBuffer, CurrAgingBuffer, TempCurrency);
         END;
        UNTIL NEXT = 0;
    END;

    LOCAL PROCEDURE InsertTemp@1000000004(VAR VendorLedgerEntry@1000000000 : Record 25);
    BEGIN
      WITH TempVendorLedgerEntry DO BEGIN
        IF GET(VendorLedgerEntry."Entry No.") THEN
          EXIT;

        TempVendorLedgerEntry := VendorLedgerEntry;

        INSERT;
      END;
    END;

    LOCAL PROCEDURE ClearData@1000000000(VAR AgingBuffer@1000000001 : Record 70220);
    BEGIN
      AgingBuffer.RESET;
      AgingBuffer.DELETEALL;
      TempVendorLedgerEntry.RESET;
      TempVendorLedgerEntry.DELETEALL;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT MenuSuite 1060 ForNAV
{
  OBJECT-PROPERTIES
  {
    Date=11/29/17;
    Time=11:25:33 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{7FD6154D-F047-4A31-B857-0DA1E0BA97D8}] ;NextNodeID=[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] }
    { MenuItem       ;[{E55ED739-BBB9-4063-AF58-225E99C5FE72}] ;Name=Document Sending Profiles;
                                                                CaptionML=[ENU=Document Sending Profiles;
                                                                           NLD=Verzendprofielen van documenten];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=359;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{379BBC3B-5EBB-4617-8419-8D76352F8337}] ;Name=Electronic Document Formats;
                                                                CaptionML=[ENU=Electronic Document Formats;
                                                                           NLD=Elektronische documentindelingen];
                                                                ApplicationArea=#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8A3934DD-BE0A-4851-B8E0-50A64106B98A}] ;Name=Data Exchange Types;
                                                                CaptionML=[ENU=Data Exchange Types;
                                                                           NLD=Typen gegevensuitwisseling];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0D3D0EB4-59D7-4D3E-95AC-49CD269C6C04}] ;Name=Data Migration Settings;
                                                                AccessByPermission=TableData 1806=R;
                                                                CaptionML=[ENU=Data Migration Settings;
                                                                           NLD=Instellingen van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1807;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{00646221-3EEF-4883-8640-FECFD9BEC705}] ;Name=Report Configuration;
                                                                AccessByPermission=TableData 2000000196=IMD;
                                                                CaptionML=[ENU=Report Settings;
                                                                           NLD=Rapportinstellingen];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1560;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A1E3A413-B0C4-4D20-8B1F-AFF7DFFDB43C}] ;Name=Setup and Help Resources;
                                                                CaptionML=[ENU=Setup and Help Resources;
                                                                           NLD=Instellings- en Help-resources];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1822;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    {                ;[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}] ;NextNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}] }
    { Menu           ;[{0691571E-EDD6-473D-A139-81B1E9B887F2}] ;Name=ForNAV;
                                                                CaptionML=ENU=ForNAV;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=15;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{E849D80C-A6A0-4A75-9313-4A9691856383}] }
    { MenuItem       ;[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] ;Name=ForNAV Setup;
                                                                CaptionML=ENU=ForNAV Setup;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C331F6D8-9B94-4792-89D9-CEDBB101436C}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{E849D80C-A6A0-4A75-9313-4A9691856383}] ;Name=Application Setup;
                                                                CaptionML=ENU=Application Setup;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                FirstChild=[{CC9EF159-165D-4DCB-8A3B-05D408AB94F8}] }
    { MenuItem       ;[{E6D918CF-B1F7-4171-A3E9-3C6E9B592EB1}] ;Name=Transformation Rules;
                                                                CaptionML=ENU=Transformation Rules;
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1237;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C331F6D8-9B94-4792-89D9-CEDBB101436C}] ;Name=ForNAV Legal Cond. Translation;
                                                                CaptionML=ENU=ForNAV Legal Cond. Translation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{E849D80C-A6A0-4A75-9313-4A9691856383}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}] ;Name=Document Reports;
                                                                CaptionML=ENU=Document Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                FirstChild=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] }
    { MenuItem       ;[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] ;Name=Sales Order Confirmation;
                                                                CaptionML=ENU=Sales Order Confirmation;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D30D76B6-37A6-4333-B5F6-F6688007A102}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{596FD082-176B-47D1-B4BA-5DABB301A6C3}] ;Name=Sales;
                                                                CaptionML=ENU=Sales;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                FirstChild=[{62E72610-35DE-4B65-A0A8-4A4464FD467C}] }
    { MenuItem       ;[{D30D76B6-37A6-4333-B5F6-F6688007A102}] ;Name=Sales Invoice;
                                                                CaptionML=ENU=Sales Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70001;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D689D68B-B7E6-44FA-A12E-412B7F969A7A}] ;Name=Sales Credit Memo;
                                                                CaptionML=ENU=Sales Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70002;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{1D3B52D4-9A4A-45D3-A4EA-4EBB5B792BBA}] ;Name=Sales Shipment;
                                                                CaptionML=ENU=Sales Shipment;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70003;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{BB66C103-03B0-4D34-BAA5-44DE7EB35EB2}] ;Name=Sales Quote;
                                                                CaptionML=ENU=Sales Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70004;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{420A2BFA-3FD3-4AD3-914D-DACF3DC2A358}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}] ;Name=Purchase;
                                                                CaptionML=ENU=Purchase;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{F70AFFC2-22D2-4BE9-978C-0CE7BF384C2F}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] }
    { MenuItem       ;[{3C3B5DC6-21F5-4E37-8C08-8E5938133520}] ;Name=Purchase Order;
                                                                CaptionML=ENU=Purchase Order;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70100;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{59F08D28-DEAC-4A3B-96E2-A6D597DDE1F6}] ;Name=Purchase Invoice;
                                                                CaptionML=ENU=Purchase Invoice;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70101;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{4CC18C18-81F4-4235-ADCD-5168C7501B6E}] ;Name=Purchase Credit Memo;
                                                                CaptionML=ENU=Purchase Credit Memo;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70102;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F10C4BA6-49D1-41DC-834C-A7F72C44B7C5}] ;Name=Purchase Quote;
                                                                CaptionML=ENU=Purchase Quote;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70104;
                                                                ParentNodeID=[{4ECA5D9B-6E0A-46E8-BB54-57C0FEC90523}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}] ;Name=Reports;
                                                                CaptionML=ENU=Reports;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                ParentNodeID=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] }
    { MenuItem       ;[{BA687EE2-5570-4962-B8FF-C27DE3ABC6F3}] ;Name=ForNAV Trial Balance;
                                                                CaptionML=ENU=ForNAV Trial Balance;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70206;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{80F41632-02B7-4B65-9469-B637CEA37A37}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{80F41632-02B7-4B65-9469-B637CEA37A37}] ;Name=ForNAV Customer/Item Statistics;
                                                                CaptionML=ENU=ForNAV Customer/Item Statistics;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70248;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{8EBA2FA7-A319-4BFA-8379-B9A253503879}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{8EBA2FA7-A319-4BFA-8379-B9A253503879}] ;Name=ForNav Salesperson-Commission;
                                                                CaptionML=ENU=ForNav Salesperson-Commission;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70215;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3E0EA722-316D-4835-B87E-31E12BE27FF9}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{3E0EA722-316D-4835-B87E-31E12BE27FF9}] ;Name=ForNAV Aged Accounts Receivable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Receivable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70220;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F84E0725-FFC0-482E-A802-8C3F918E698E}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F84E0725-FFC0-482E-A802-8C3F918E698E}] ;Name=ForNAV Aged Accounts Payable;
                                                                CaptionML=ENU=ForNAV Aged Accounts Payable;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70221;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{41CABE99-FB5D-4D56-853C-5D1F4736CD42}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{41CABE99-FB5D-4D56-853C-5D1F4736CD42}] ;Name=Debitor - top 10-liste;
                                                                CaptionML=[CSY=ForNAV NejlepÊ¡ch 10 z kazn¡ku;
                                                                           DAN=ForNAV Debitor - top 10-liste;
                                                                           DEU=ForNAV Top 10 Liste (Debitoren);
                                                                           ENU=ForNAV Customer Top 10 List;
                                                                           FIN=ForNAV Asiakkaat - 10 p„„asiakasta;
                                                                           FRA=ForNAV Clients - PalmarŠs;
                                                                           ISL=ForNAV Vi÷skiptama÷ur - 10 efstu;
                                                                           ITA=ForNAV Lista primi 10 clienti;
                                                                           NLD=ForNAV Klanten - Top 10;
                                                                           NOR=ForNAV Kunde - ti p† topp-liste;
                                                                           RUS=à‰Š†¡• - ‹†÷ƒ…˜ „†¤˜•ˆ…;
                                                                           SVE=ForNAV Kunder, 10 i topp;
                                                                           DES=ForNAV Top 10 Liste (Debitoren);
                                                                           ENG=ForNAV Customer Top 10 List;
                                                                           FRB=ForNAV Clients - PalmarŠs;
                                                                           ITS=ForNAV Lista primi 10 clienti;
                                                                           NLB=ForNAV Klanten - Top 10;
                                                                           DEA=ForNAV Top 10 Liste (Debitoren);
                                                                           ENA=ForNAV Customer Top 10 List;
                                                                           ESN=ForNAV Los 10 mejores clientes;
                                                                           FRS=ForNAV Clients - PalmarŠs;
                                                                           ENZ=ForNAV Customer Top 10 List];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70201;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{45294869-9463-4CF8-B506-43F3CEDF442B}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{45294869-9463-4CF8-B506-43F3CEDF442B}] ;Name=Kreditor - top 10-liste;
                                                                CaptionML=[CSY=ForNAV Dodavatel - nejlepÊ¡ch 10;
                                                                           DAN=ForNAV Kreditor - top 10-liste;
                                                                           DEU=ForNAV H„ndler Top-10-Liste;
                                                                           ENU=ForNAV Vendor Top 10 List;
                                                                           FIN=ForNAV 10 p„„toimittajaa;
                                                                           FRA=ForNAV PalmarŠs fournisseurs;
                                                                           ISL=ForNAV 10 efstu l nardrottnar;
                                                                           ITA=ForNAV Lista primi 10 fornitori;
                                                                           NLD=ForNAV Lijst top 10 leveranciers;
                                                                           NOR=ForNAV Leverandûr - topp 10-liste;
                                                                           RUS=çŒ¤•…ƒ—ŠˆŠ - ‹†÷ƒ…˜ „†¤˜•ˆ…;
                                                                           SVE=ForNAV 10 i topp leverant”rer;
                                                                           DES=ForNAV H„ndler Top-10-Liste;
                                                                           ENG=ForNAV Vendor Top 10 List;
                                                                           FRB=ForNAV PalmarŠs fournisseurs;
                                                                           ITS=ForNAV Lista primi 10 fornitori;
                                                                           NLB=ForNAV Lijst top 10 leveranciers;
                                                                           DEA=ForNAV H„ndler Top-10-Liste;
                                                                           ENA=ForNAV Vendor Top 10 List;
                                                                           ESN=ForNAV Listado 10 mejores proveedores;
                                                                           FRS=ForNAV PalmarŠs fournisseurs;
                                                                           ENZ=ForNAV Vendor Top 10 List];
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70202;
                                                                ParentNodeID=[{18FE127A-54F8-4D99-9251-F9F5B7D230B6}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{6FBB60D4-3684-4106-BEFF-237518F7236E}] ;Name=Data Migration Overview;
                                                                CaptionML=[ENU=Data Migration Overview;
                                                                           NLD=Overzicht van gegevensmigratie];
                                                                ApplicationArea=#Basic,#Suite;
                                                                RunObjectType=Page;
                                                                RunObjectID=1799;
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{420A2BFA-3FD3-4AD3-914D-DACF3DC2A358}] ;Name=Customer Statement;
                                                                CaptionML=ENU=Customer Statement;
                                                                ApplicationArea=;
                                                                MemberOfMenu=[{0691571E-EDD6-473D-A139-81B1E9B887F2}];
                                                                RunObjectType=Report;
                                                                RunObjectID=70250;
                                                                ParentNodeID=[{596FD082-176B-47D1-B4BA-5DABB301A6C3}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
  }
}
OBJECT Page 70000 ForNAV Setup
{
  OBJECT-PROPERTIES
  {
    Date=12/20/17;
    Time=[ 5:44:41 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70000;
    PageType=Card;
    OnOpenPage=BEGIN
                 InitSetup;
               END;

    OnAfterGetRecord=BEGIN
                       WrongLocalization := NOT ValidateCurrentLocalization;
                     END;

    ActionList=ACTIONS
    {
      { 1       ;    ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 11      ;1   ;ActionGroup;
                      Name=Watermark }
      { 10      ;2   ;Action    ;
                      Name=DownloadWatermark;
                      CaptionML=ENU=Download Watermarks;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DownloadWatermarks;
                               END;
                                }
      { 8       ;1   ;ActionGroup;
                      Name=Delete Visuals }
      { 14      ;2   ;Action    ;
                      Name=DeleteDocWatermark;
                      CaptionML=ENU=Document Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION("Document Watermark")) THEN
                                   EXIT;

                                 "Document Watermark File Name" := 'Click to import...';
                                 CLEAR("Document Watermark");
                                 MODIFY;
                               END;
                                }
      { 15      ;2   ;Action    ;
                      Name=DeleteListWatermark;
                      CaptionML=ENU=List Watermark;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION("List Report Watermark")) THEN
                                   EXIT;

                                 "List Report Watermark File N." := 'Click to import...';
                                 CLEAR("List Report Watermark");
                                 MODIFY;
                               END;
                                }
      { 16      ;2   ;Action    ;
                      Name=DeleteLogo;
                      CaptionML=ENU=Logo;
                      Image=Delete;
                      OnAction=VAR
                                 AreYouSureQst@1000 : TextConst 'ENU=Are you sure you want to clear %1?';
                               BEGIN
                                 IF NOT CONFIRM(AreYouSureQst, FALSE, FIELDCAPTION(Logo)) THEN
                                   EXIT;

                                 "Logo File Name" := 'Click to import...';
                                 CLEAR(Logo);
                                 MODIFY;
                               END;
                                }
      { 12      ;1   ;ActionGroup;
                      Name=System }
      { 2       ;2   ;Action    ;
                      Name=ReplaceReports;
                      CaptionML=ENU=Replace Reportselection;
                      Image=SwitchCompanies;
                      OnAction=BEGIN
                                 ReplaceReportSelection(FALSE);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Name=CheckLocalization;
                      CaptionML=ENU=Check Localization;
                      Image=MapSetup;
                      OnAction=BEGIN
                                 CheckLocalizationBasedOnTables;
                                 MODIFY;
                               END;
                                }
      { 9       ;2   ;Action    ;
                      Name=CreateWebservice;
                      CaptionML=ENU=Create ForNAV Webservice;
                      Image=ServiceSetup;
                      OnAction=BEGIN
                                 CreateWebService;
                               END;
                                }
      { 13      ;1   ;ActionGroup;
                      Name=Template }
      { 1000000014;2 ;Action    ;
                      Name=DesignTemplatePortrait;
                      CaptionML=ENU=Design General Template (Portrait);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UnitOfMeasure;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplatePortrait;
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=DesignTemplateLandscape;
                      CaptionML=ENU=Design General Template (Landscape);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=VATPostingSetup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignTemplateLandscape;
                               END;
                                }
      { 4       ;2   ;Action    ;
                      Name=DesignSalesTemplate;
                      CaptionML=ENU=Design Sales Template;
                      ToolTipML=ENU=Use this option to change the sales template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Design;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignSalesTemplate;
                               END;
                                }
      { 1000000009;2 ;Action    ;
                      Name=DesignPurchaseTemplate;
                      CaptionML=ENU=Design Purchase Template;
                      ToolTipML=ENU=Use this option to change the purchase template, for example when you want to move the address or change the font.;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DesignCodeBehind;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 DesignPurchaseTemplate;
                               END;
                                }
      { 1000000011;  ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 1000000013;1 ;Action    ;
                      Name=Translations;
                      CaptionML=ENU=Translations;
                      ToolTipML=ENU=View or edit translated legal conditions. Translated legal conditions are automatically inserted on documents according to the language code.;
                      RunObject=Page 70001;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Translations;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 6   ;2   ;Field     ;
                SourceExpr=Localization;
                Style=Unfavorable;
                StyleExpr=WrongLocalization }

    { 1000000010;2;Field  ;
                SourceExpr="Use ForNAV Languages" }

    { 1000000012;2;Field  ;
                SourceExpr="Use Preprinted Paper" }

    { 1000000002;1;Group  ;
                Name=VAT/Sales Tax;
                GroupType=Group }

    { 1000000003;2;Field  ;
                SourceExpr="VAT Amount Specification" }

    { 1000000004;1;Group  ;
                Name=Document Texts;
                GroupType=Group }

    { 5   ;2   ;Field     ;
                SourceExpr="Payment Note";
                MultiLine=Yes }

    { 1000000005;2;Field  ;
                SourceExpr="Legal Conditions";
                MultiLine=Yes }

    { 17  ;1   ;Group     ;
                Name=Visuals;
                GroupType=Group }

    { 18  ;2   ;Field     ;
                CaptionML=ENU=Logo;
                SourceExpr="Logo File Name";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS(Logo);
                              IF "Logo File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := Logo;
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Logo File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO(Logo));
                              MODIFY;
                            END;
                             }

    { 19  ;2   ;Field     ;
                CaptionML=ENU=Document Watermark;
                SourceExpr="Document Watermark File Name";
                Editable=FALSE;
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS("Document Watermark");
                              IF "Document Watermark File Name" <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := "Document Watermark";
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "Document Watermark File Name", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                              MODIFY;
                            END;
                             }

    { 20  ;2   ;Field     ;
                CaptionML=ENU=List Report Watermark;
                SourceExpr="List Report Watermark File N.";
                OnDrillDown=VAR
                              TempBlob@1001 : Record 99008535;
                              FileManagement@1000 : Codeunit 419;
                            BEGIN
                              CALCFIELDS("List Report Watermark");
                              IF "List Report Watermark File N." <> 'Click to import...' THEN BEGIN
                                TempBlob.Blob := "List Report Watermark";
                                HYPERLINK(FileManagement.BLOBExport(TempBlob, "List Report Watermark File N.", FALSE));
                              END ELSE
                                ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                              MODIFY;
                            END;
                             }

    { 1000000006;0;Container;
                ContainerType=FactBoxArea }

    { 1000000007;1;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000008;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      WrongLocalization@1000 : Boolean INDATASET;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70001 ForNAV Legal Cond. Translation
{
  OBJECT-PROPERTIES
  {
    Date=07/14/17;
    Time=10:56:09 AM;
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    SourceTable=Table70001;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Language Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Legal Conditions" }

  }
  CODE
  {

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

OBJECT Page 70005 ForNAV Setup Wizard
{
  OBJECT-PROPERTIES
  {
    Date=09/12/17;
    Time=[ 1:48:49 PM];
    Modified=Yes;
    Version List=SHIP;
  }
  PROPERTIES
  {
    SourceTable=Table70000;
    PageType=NavigatePage;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             LoadTopBanners;
           END;

    OnOpenPage=BEGIN
                 INIT;
                 IF ForNAVSetup.GET THEN BEGIN
                   TRANSFERFIELDS(ForNAVSetup);
                   WrongLocalization := NOT ValidateCurrentLocalization;
                 END ELSE BEGIN
                   CheckLocalizationBasedOnTables;
                   "Legal Conditions" := LegalConditionsTxt;
                   "Payment Note" := PaymentNoteTxt;
                   "VAT Amount Specification" := "VAT Amount Specification"::"Multiple Lines";
                   VALIDATE(Localization);
                 END;
                 INSERT;

                 Step := Step::Start;
                 EnableControls;
               END;

    ActionList=ACTIONS
    {
      { 19      ;    ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 18      ;1   ;Action    ;
                      Name=ActionBack;
                      CaptionML=ENU=Back;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=BackActionEnabled;
                      InFooterBar=Yes;
                      Image=PreviousRecord;
                      OnAction=BEGIN
                                 NextStep(TRUE);
                               END;
                                }
      { 16      ;1   ;Action    ;
                      Name=ActionNext;
                      CaptionML=ENU=Next;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=NextActionEnabled;
                      InFooterBar=Yes;
                      Image=NextRecord;
                      OnAction=BEGIN
                                 NextStep(FALSE);
                               END;
                                }
      { 8       ;1   ;Action    ;
                      Name=ActionFinish;
                      CaptionML=ENU=Finish;
                      ApplicationArea=#Basic,#Suite;
                      Enabled=FinishActionEnabled;
                      InFooterBar=Yes;
                      Image=Approve;
                      OnAction=BEGIN
                                 FinishAction;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 5   ;0   ;Container ;
                ContainerType=ContentArea }

    { 4   ;1   ;Group     ;
                Visible=TopBannerVisible AND NOT FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 3   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryStandard.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 2   ;1   ;Group     ;
                Visible=TopBannerVisible AND FinalStepVisible;
                Editable=FALSE;
                GroupType=Group }

    { 1   ;2   ;Field     ;
                ApplicationArea=#Basic,#Suite;
                SourceExpr=MediaRepositoryDone.Image;
                Editable=FALSE;
                ShowCaption=No }

    { 11  ;1   ;Group     ;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 10  ;2   ;Group     ;
                CaptionML=ENU=Welcome to ForNAV Setup;
                Visible=FirstStepVisible;
                GroupType=Group }

    { 9   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU="The ForNAV report package contains several documents that are optimized to work with our designer. " }

    { 7   ;2   ;Group     ;
                CaptionML=ENU=Let's go!;
                GroupType=Group }

    { 6   ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=Choose Next so you can set up the ForNAV report package. }

    { 15  ;1   ;Group     ;
                Visible=FinalStepVisible;
                GroupType=Group }

    { 13  ;2   ;Group     ;
                CaptionML=ENU=That's it!;
                GroupType=Group }

    { 12  ;3   ;Group     ;
                GroupType=Group;
                InstructionalTextML=ENU=To enable the ForNAV report package choose Finish. }

    { 24  ;1   ;Group     ;
                Visible=Step1Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your localization... }

    { 25  ;2   ;Field     ;
                SourceExpr=Localization;
                OnValidate=BEGIN
                             WrongLocalization := NOT ValidateCurrentLocalization;
                           END;
                            }

    { 27  ;2   ;Group     ;
                Visible=WrongLocalization;
                GroupType=Group;
                InstructionalTextML=ENU=WARNING! This is not the localization we detected! }

    { 21  ;1   ;Group     ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Select your VAT printing preferences and legal clause. }

    { 22  ;2   ;Field     ;
                SourceExpr="VAT Amount Specification" }

    { 14  ;2   ;Field     ;
                SourceExpr="Payment Note" }

    { 23  ;2   ;Field     ;
                SourceExpr="Legal Conditions" }

    { 17  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want to replace the current report selections with the ForNAV reports? }

    { 20  ;2   ;Field     ;
                Name=ReplaceReports;
                CaptionML=ENU=Replace Reports;
                SourceExpr=ReplaceReports }

    { 30  ;1   ;Group     ;
                Visible=Step3Visible;
                GroupType=Group;
                InstructionalTextML=ENU=Do you want to create the fields webservice? }

    { 29  ;2   ;Field     ;
                SourceExpr=CreateTheWebService }

    { 1000000001;1;Group  ;
                Visible=Step2Visible;
                GroupType=Group;
                InstructionalTextML=ENU=A watermark can make your reports look nicer. Do you want to import one? }

    { 1000000000;2;Field  ;
                Name=ImportWatermark;
                SourceExpr=WatermarkTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("Document Watermark"));
                            END;

                ShowCaption=No }

    { 28  ;2   ;Field     ;
                Name=ImportWatermarkList;
                SourceExpr=WatermarkListTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO("List Report Watermark"));
                            END;

                ShowCaption=No }

    { 26  ;2   ;Field     ;
                Name=ImportCompanyLogo;
                SourceExpr=CompanyLogoTxt;
                Editable=FALSE;
                OnDrillDown=BEGIN
                              ImportWatermarkFromClientFile(FIELDNO(Logo));
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      MediaRepositoryStandard@1001 : Record 9400;
      MediaRepositoryDone@1000 : Record 9400;
      ForNAVSetup@1005 : Record 70000;
      TopBannerVisible@1003 : Boolean;
      FinalStepVisible@1002 : Boolean;
      FirstStepVisible@1004 : Boolean;
      FinishActionEnabled@1007 : Boolean;
      BackActionEnabled@1008 : Boolean;
      NextActionEnabled@1009 : Boolean;
      Step1Visible@1011 : Boolean;
      Step2Visible@1010 : Boolean;
      Step3Visible@1013 : Boolean;
      ReplaceReports@1012 : Boolean;
      CreateTheWebService@1019 : Boolean;
      WrongLocalization@1014 : Boolean INDATASET;
      Step@1006 : 'Start,Step1,Step2,Step3,Finish';
      WatermarkTxt@1000000000 : TextConst 'ENU=Click to import a watermark for document reports';
      WatermarkListTxt@1018 : TextConst 'ENU=Click to import a watermark for list reports';
      CompanyLogoTxt@1017 : TextConst 'ENU=Click to import a company logo';
      PaymentNoteTxt@1015 : TextConst 'ENU=- You can print a payment note here -';
      LegalConditionsTxt@1016 : TextConst 'ENU=- You can print your legal conditions here -';

    LOCAL PROCEDURE LoadTopBanners@40();
    BEGIN
      IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND
         MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))
      THEN
        TopBannerVisible := MediaRepositoryDone.Image.HASVALUE;
    END;

    LOCAL PROCEDURE EnableControls@2();
    BEGIN
      ResetControls;

      CASE Step OF
        Step::Start:
          ShowStartStep;
        Step::Step1:
          ShowStep1;
        Step::Step2:
          ShowStep2;
        Step::Step3:
          ShowStep3;
        Step::Finish:
          ShowFinishStep;
      END;
    END;

    LOCAL PROCEDURE ShowStartStep@24();
    BEGIN
      FirstStepVisible := TRUE;
      FinishActionEnabled := FALSE;
      BackActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ShowStep1@33();
    BEGIN
      Step1Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep2@34();
    BEGIN
      Step2Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowStep3@4();
    BEGIN
      Step3Visible := TRUE;
    END;

    LOCAL PROCEDURE ShowFinishStep@35();
    BEGIN
      FinalStepVisible := TRUE;
      NextActionEnabled := FALSE;
    END;

    LOCAL PROCEDURE ResetControls@1();
    BEGIN
      FinishActionEnabled := 1=1;
      BackActionEnabled := TRUE;
      NextActionEnabled := TRUE;

      FirstStepVisible := FALSE;
      Step1Visible := FALSE;
      Step2Visible := FALSE;
      Step3Visible := FALSE;
      FinalStepVisible := FALSE;
    END;

    LOCAL PROCEDURE NextStep@41(Backwards@1000 : Boolean);
    BEGIN
      IF Backwards THEN
        Step := Step - 1
      ELSE
        Step := Step + 1;

      EnableControls;
    END;

    LOCAL PROCEDURE FinishAction@12();
    BEGIN
      StoreForNAVSetup;
      CurrPage.CLOSE;
    END;

    LOCAL PROCEDURE StoreForNAVSetup@3();
    BEGIN
      IF NOT ForNAVSetup.GET THEN BEGIN
        ForNAVSetup.INIT;
        ForNAVSetup.INSERT;
      END;

      ForNAVSetup.TRANSFERFIELDS(Rec,FALSE);
      IF NOT ForNAVSetup.Logo.HASVALUE THEN
        ForNAVSetup.GetCompanyLogo;

      ForNAVSetup.MODIFY;
      IF ReplaceReports THEN
        ForNAVSetup.ReplaceReportSelection(TRUE);
      IF CreateTheWebService THEN
        CreateWebService;
    END;

    BEGIN
    {
      Copyright (c) 2017 ForNAV ApS - All Rights Reserved
      The intellectual work and technical concepts contained in this file are proprietary to ForNAV.
      Unauthorized reverse engineering, distribution or copying of this file, parts hereof, or derived work, via any medium is strictly prohibited without written permission from ForNAV ApS.
      This source code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    }
    END.
  }
}

